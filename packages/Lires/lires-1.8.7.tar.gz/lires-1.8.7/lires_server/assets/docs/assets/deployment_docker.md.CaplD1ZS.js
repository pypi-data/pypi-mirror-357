import{_ as s,c as i,o as a,a3 as e}from"./chunks/framework.CviQUOu7.js";const g=JSON.parse('{"title":"Docker Deployment","description":"","frontmatter":{},"headers":[],"relativePath":"deployment/docker.md","filePath":"deployment/docker.md","lastUpdated":1716128692000}'),t={name:"deployment/docker.md"},n=e(`<h1 id="docker-deployment" tabindex="-1">Docker Deployment <a class="header-anchor" href="#docker-deployment" aria-label="Permalink to &quot;Docker Deployment&quot;">​</a></h1><p>Running Lires with docker provide another level of isolation and security.</p><h2 id="basic-usage" tabindex="-1">Basic usage <a class="header-anchor" href="#basic-usage" aria-label="Permalink to &quot;Basic usage&quot;">​</a></h2><h3 id="start" tabindex="-1">Start <a class="header-anchor" href="#start" aria-label="Permalink to &quot;Start&quot;">​</a></h3><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># build the image</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> build</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> docker/Dockerfile</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -t</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> lires:runtime</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> .</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># run the container, map the port 8080 to the host machine port 80</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -d</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 80:8080</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -v</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/path/to/dat</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">a</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">:/root/.Lires</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --name</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> lrs</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> lires:runtime</span></span></code></pre></div><p>Now you can access the web interface at <code>http://localhost</code>.</p><h3 id="management" tabindex="-1">Management <a class="header-anchor" href="#management" aria-label="Permalink to &quot;Management&quot;">​</a></h3><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># user management</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> exec</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -it</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> lrs</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> lrs-user</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ...</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># check the logs</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> exec</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -it</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> lrs</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> lrs-log</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ...</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># or check output by docker logs</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> logs</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> lrs</span></span></code></pre></div><h2 id="change-the-configuration" tabindex="-1">Change the configuration <a class="header-anchor" href="#change-the-configuration" aria-label="Permalink to &quot;Change the configuration&quot;">​</a></h2><p>The docker image essentially runs the <a href="./gettingStarted.html#cluster-startup"><code>lrs-cluster</code></a> command with the configuration file <code>/root/.Lires/container-cluster.yaml</code>. Which should be mounted to the host machine for easy access and modification.</p><div class="info custom-block"><p class="custom-block-title">INFO</p><p>Although you may change the <a href="./enviromentVariables.html">environment variables</a> with <code>docker run -e ...</code>, it is recommended to modify them in the cluster configuration file, to make sure it will not be overwritten by the values set with the configuration file.</p></div><h2 id="limit-the-resources" tabindex="-1">Limit the resources <a class="header-anchor" href="#limit-the-resources" aria-label="Permalink to &quot;Limit the resources&quot;">​</a></h2><p>An advantage of running the app with docker is that you can limit the resources of the container.</p><p>To limit the memory and cpu usage, you can use the <code>--memory</code> and <code>--cpus</code> flags.</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --memory</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 4g</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --cpus</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ...</span></span></code></pre></div><p>To limit the disk usage, you can use the docker volume driver, for example, first create a volume with limited size, then mount it to the container.</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># create a volume with 10G size</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> volume</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> create</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --driver</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> local</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --opt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> type=btrfs</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --opt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> o=size=10G</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> lrs-data</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># run the container with the volume</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -v</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> lrs-data:/root/.Lires</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ...</span></span></code></pre></div><p>For more information, see <a href="https://docs.docker.com/reference/cli/docker/volume/create/#driver-specific-options" target="_blank" rel="noreferrer">docker - driver specific options</a>.</p>`,18),h=[n];function l(p,r,k,o,d,c){return a(),i("div",null,h)}const u=s(t,[["render",l]]);export{g as __pageData,u as default};
