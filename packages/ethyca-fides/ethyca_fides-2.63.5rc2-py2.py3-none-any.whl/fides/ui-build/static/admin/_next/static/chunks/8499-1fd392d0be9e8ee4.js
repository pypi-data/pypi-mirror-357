"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8499],{95492:function(e,s,t){t.d(s,{l:function(){return i}});var n=t(24246);let i=(0,t(4454).IUT)({displayName:"TrashCanSolidIcon",viewBox:"0 0 12 15",path:(0,n.jsx)("path",{d:"M8.37857 1.18083C8.23393 0.892838 7.93661 0.710938 7.6125 0.710938H4.3875C4.06339 0.710938 3.76607 0.892838 3.62143 1.18083L3.42857 1.56094H0.857143C0.383036 1.56094 -1.19209e-07 1.94158 -1.19209e-07 2.41094C-1.19209e-07 2.8803 0.383036 3.26094 0.857143 3.26094H11.1429C11.6162 3.26094 12 2.8803 12 2.41094C12 1.94158 11.6162 1.56094 11.1429 1.56094H8.57143L8.37857 1.18083ZM11.167 4.11094H0.857143V12.6109C0.857143 13.5486 1.62589 14.3109 2.57143 14.3109H9.45268C10.3754 14.3109 11.167 13.5486 11.167 12.6109V4.11094ZM9.02411 6.23594V12.1859C9.02411 12.4197 8.80714 12.6109 8.59554 12.6109C8.33571 12.6109 8.16696 12.4197 8.16696 12.1859V6.23594C8.16696 6.00219 8.33571 5.81094 8.59554 5.81094C8.80714 5.81094 9.02411 6.00219 9.02411 6.23594ZM6.45268 6.23594V12.1859C6.45268 12.4197 6.23571 12.6109 6.02411 12.6109C5.76429 12.6109 5.57143 12.4197 5.57143 12.1859V6.23594C5.57143 6.00219 5.76429 5.81094 6.02411 5.81094C6.23571 5.81094 6.45268 6.00219 6.45268 6.23594ZM3.85714 6.23594V12.1859C3.85714 12.4197 3.66429 12.6109 3.42857 12.6109C3.19286 12.6109 3 12.4197 3 12.1859V6.23594C3 6.00219 3.19286 5.81094 3.42857 5.81094C3.66429 5.81094 3.85714 6.00219 3.85714 6.23594Z",fill:"currentColor"})})},45938:function(e,s,t){t.d(s,{Gt:function(){return m},eB:function(){return f},oI:function(){return u}});var n=t(24246),i=t(34090),a=t(27378),l=t(16134),r=t(38602),d=t(58452);let o=(0,a.createRef)(),c=(0,a.createRef)(),u=()=>{let e=(0,l.T)(),s=(0,l.C)(r.DB),t=(0,a.useCallback)(()=>{c.current=void 0,o.current=void 0},[]),n=(0,a.useCallback)(()=>{e((0,r.Mr)()),c.current&&(c.current(!0),t())},[e,t]),i=(0,a.useCallback)(()=>{e((0,r.Mr)()),c.current&&(c.current(!1),t())},[e,t]);return{attemptAction:(0,a.useCallback)(()=>s?(e((0,r.h7)()),o.current||(o.current=new Promise(e=>{c.current=e})),o.current):Promise.resolve(!0),[s,e]),onConfirm:n,onClose:i}},m=e=>{let{id:s,name:t}=e,{dirty:n}=(0,i.u6)(),d=(0,l.T)();return(0,a.useEffect)(()=>(d((0,r.Zu)({id:s,name:t})),()=>{d((0,r.dz)({id:s}))}),[d,s,t]),(0,a.useEffect)(()=>{d((0,r.$p)({id:s,isDirty:n}))},[n,d,s]),null},f=()=>{let{onConfirm:e,onClose:s}=u(),t=(0,l.C)(r.uv);return(0,n.jsx)(d.Z,{isOpen:t,onClose:s,onConfirm:e,isCentered:!0,title:"Unsaved Changes",message:"You have unsaved changes"})}},84720:function(e,s,t){t.d(s,{q:function(){return p}});var n=t(24246),i=t(4454),a=t(27378),l=t(812),r=t(45938),d=t(14048),o=t(95492),c=t(34090);let u=e=>{let{systems:s,dataFlows:t,onDataFlowSystemChange:a}=e,{setFieldValue:l}=(0,c.u6)(),r=t.map(e=>e.fides_key),d=e=>{let s=t.filter(s=>s.fides_key!==e.fides_key);l("dataFlowSystems",s),a(s)};return(0,n.jsxs)(i.iA_,{size:"sm","data-testid":"assign-systems-delete-table",children:[(0,n.jsx)(i.hrZ,{children:(0,n.jsxs)(i.Tr,{children:[(0,n.jsx)(i.Th,{children:"System"}),(0,n.jsx)(i.Th,{})]})}),(0,n.jsx)(i.p3B,{children:s.filter(e=>r.includes(e.fides_key)).map(e=>(0,n.jsxs)(i.Tr,{_hover:{bg:"gray.50"},"data-testid":"row-".concat(e.fides_key),children:[(0,n.jsx)(i.Td,{children:(0,n.jsx)(i.xvT,{fontSize:"xs",lineHeight:4,fontWeight:"medium",children:e.name})}),(0,n.jsx)(i.Td,{textAlign:"end",children:(0,n.jsx)(i.wpx,{"aria-label":"Unassign data flow from system",icon:(0,n.jsx)(o.l,{}),onClick:()=>d(e),"data-testid":"unassign-btn"})})]},e.fides_key))})]})};var m=t(26917),f=e=>{let{allSystems:s,dataFlowSystems:t,onChange:a,flowType:l}=e,{setFieldValue:r}=(0,c.u6)(),d=e=>{if(t.find(s=>s.fides_key===e.fides_key)){let s=t.filter(s=>s.fides_key!==e.fides_key);r("dataFlowSystems",s),a(s)}else{let s=[...t,{fides_key:e.fides_key,type:"system"}];r("dataFlowSystems",s),a(s)}};return(0,n.jsx)(i.xuv,{overflowY:"auto",maxHeight:"300px",children:(0,n.jsxs)(i.iA_,{size:"sm","data-testid":"assign-systems-table",maxHeight:"50vh",overflowY:"scroll",children:[(0,n.jsx)(i.hrZ,{position:"sticky",top:0,background:"white",zIndex:1,children:(0,n.jsxs)(i.Tr,{children:[(0,n.jsx)(i.Th,{children:"System"}),(0,n.jsxs)(i.Th,{textAlign:"right",children:["Set as ",l]})]})}),(0,n.jsx)(i.p3B,{children:s.map(e=>{let s=!!t.find(s=>s.fides_key===e.fides_key);return(0,n.jsxs)(i.Tr,{_hover:{bg:"gray.50"},"data-testid":"row-".concat(e.fides_key),children:[(0,n.jsx)(i.Td,{children:(0,n.jsx)(i.xvT,{fontSize:"xs",lineHeight:4,fontWeight:"medium",children:e.name})}),(0,n.jsx)(i.Td,{textAlign:"right",children:(0,n.jsx)(i.rAg,{checked:s,onChange:()=>d(e),"data-testid":"assign-switch"})})]},e.fides_key)})})]})})};let h=(e,s)=>{var t,n;return(null===(t=e.name)||void 0===t?void 0:t.toLocaleLowerCase().includes(s.toLocaleLowerCase()))||(null===(n=e.description)||void 0===n?void 0:n.toLocaleLowerCase().includes(s.toLocaleLowerCase()))};var x=e=>{let{currentSystem:s,systems:t,isOpen:l,onClose:r,dataFlowSystems:d,onDataFlowSystemChange:o,flowType:u}=e,{setFieldValue:x}=(0,c.u6)(),[y,g]=(0,a.useState)(""),[C,j]=(0,a.useState)(d),p=async()=>{o(C),r()},k=0===t.length,w=(0,a.useMemo)(()=>t?t.filter(e=>e.fides_key!==s.fides_key).filter(e=>h(e,y)):[],[t,s.fides_key,y]),v=(0,a.useMemo)(()=>{let e=new Set(C.map(e=>e.fides_key));return w.every(s=>e.has(s.fides_key))},[w,C]);return(0,n.jsxs)(i.u_l,{isOpen:l,onClose:r,size:"2xl",isCentered:!0,children:[(0,n.jsx)(i.ZAr,{}),(0,n.jsxs)(i.hzk,{p:8,"data-testid":"confirmation-modal",children:[(0,n.jsxs)(i.xBx,{fontWeight:"medium",display:"flex",justifyContent:"space-between",alignItems:"center",children:[(0,n.jsxs)(i.xvT,{fontSize:"2xl",lineHeight:8,fontWeight:"semibold",children:["Configure ",u.toLocaleLowerCase()," systems"]}),(0,n.jsxs)(i.j8w,{color:"success",children:["Assigned to ",C.length," systems"]})]}),(0,n.jsx)(i.fef,{"data-testid":"assign-systems-modal-body",children:k?(0,n.jsx)(i.xvT,{children:"No systems found"}):(0,n.jsxs)(i.Kqy,{spacing:4,children:[(0,n.jsxs)(i.kCb,{justifyContent:"space-between",children:[(0,n.jsx)(i.xvT,{fontSize:"sm",flexGrow:1,fontWeight:"medium",children:"Add or remove destination systems from your data map"}),(0,n.jsx)(i.xuv,{children:(0,n.jsxs)(i.NIc,{display:"flex",alignItems:"center",children:[(0,n.jsx)(i.lXp,{fontSize:"sm",htmlFor:"assign-all-systems",mb:"0",children:"Assign all systems"}),(0,n.jsx)(i.rAg,{size:"small",id:"assign-all-systems",checked:v,onChange:e=>{if(e&&t){let e=w.map(e=>({fides_key:e.fides_key,type:"system"}));x("dataFlowSystems",e),j(e)}else j([])},"data-testid":"assign-all-systems-toggle"})]})})]}),(0,n.jsx)(m.Z,{value:y,onChange:g,placeholder:"Search for systems","data-testid":"system-search",withIcon:!0}),(0,n.jsx)(f,{flowType:u,allSystems:w,dataFlowSystems:C,onChange:j})]})}),(0,n.jsxs)(i.mzw,{justifyContent:"flex-start",children:[(0,n.jsx)(i.wpx,{onClick:r,className:"mr-2","data-testid":"cancel-btn",children:"Cancel"}),!k&&(0,n.jsx)(i.wpx,{type:"primary",onClick:p,"data-testid":"confirm-btn",children:"Confirm"})]})]})]})},y=t(46628),g=t(1315);let C={dataFlowSystems:[]},j=e=>{let{system:s,isIngress:t,isSystemTab:o}=e,m=(0,i.pmc)(),f=t?"Source":"Destination",h="".concat(f,"s"),j=(0,i.qY0)(),[p]=(0,g.qQ)(),{data:k=[]}=(0,g.K3)(),w=(0,a.useMemo)(()=>{let e=t?s.ingress:s.egress;e||(e=[]);let n=k?k.map(e=>e.fides_key):[];return e.filter(e=>n.includes(e.fides_key))},[t,s,k]),[v,b]=(0,a.useState)(w);(0,a.useEffect)(()=>{b(w)},[w]);let _=async(e,n)=>{let{dataFlowSystems:i}=e,{resetForm:a}=n,r={...s,ingress:t?i:s.ingress,egress:t?s.egress:i},d=await p(r);(0,l.D4)(d)?m((0,y.Vo)("Failed to update data flows")):m((0,y.t5)("".concat(h," updated"))),a({values:{dataFlowSystems:i}})};return(0,n.jsxs)(i.Qdk,{children:[(0,n.jsx)(i.KFZ,{height:"68px",paddingLeft:o?6:2,"data-testid":"data-flow-button-".concat(f),children:(0,n.jsxs)(i.kCb,{alignItems:"center",justifyContent:"start",flex:1,textAlign:"left",children:[(0,n.jsx)(i.xvT,{fontSize:"sm",lineHeight:5,fontWeight:"semibold",mr:2,children:h}),(0,n.jsx)(i.Vp9,{ml:2,backgroundColor:"primary.400",borderRadius:"6px",color:"white",children:v.length}),(0,n.jsx)(i.LZC,{}),(0,n.jsx)(i.XEm,{})]})}),(0,n.jsx)(i.Hk3,{backgroundColor:"gray.50",padding:6,"data-testid":"data-flow-panel-".concat(f),children:(0,n.jsx)(i.Kqy,{borderRadius:"md",backgroundColor:"gray.50","aria-selected":"true",spacing:4,"data-testid":"selected",children:(0,n.jsx)(c.J9,{initialValues:C,onSubmit:_,children:e=>{let{isSubmitting:t,dirty:a,resetForm:l}=e;return(0,n.jsxs)(c.l0,{children:[(0,n.jsx)(r.Gt,{id:"".concat(s.fides_key,":").concat(f),name:"".concat(f," Data Flow")}),(0,n.jsx)(i.wpx,{onClick:j.onOpen,type:"primary",size:"small",icon:(0,n.jsx)(d.A5,{}),iconPosition:"end",className:"mb-4","data-testid":"assign-systems-btn",children:"Configure ".concat(h.toLocaleLowerCase())}),(0,n.jsx)(u,{systems:k,dataFlows:v,onDataFlowSystemChange:b}),(0,n.jsxs)("div",{className:"mt-6 flex gap-2",children:[(0,n.jsx)(i.wpx,{disabled:!a&&v===w,onClick:()=>{b(w),l({values:{dataFlowSystems:w}})},"data-testid":"cancel-btn",children:"Cancel"}),(0,n.jsx)(i.wpx,{type:"primary",htmlType:"submit",loading:t,disabled:!a&&v===w,"data-testid":"save-btn",children:"Save"})]}),j.isOpen?(0,n.jsx)(x,{currentSystem:s,systems:k,isOpen:j.isOpen,onClose:j.onClose,dataFlowSystems:v,onDataFlowSystemChange:b,flowType:f}):null]})}})})})]})},p=e=>{let{system:s,isSystemTab:t}=e;return(0,n.jsxs)(i.UQy,{allowToggle:!0,"data-testid":"data-flow-accordion",children:[(0,n.jsx)(j,{system:s,isIngress:!0,isSystemTab:t}),(0,n.jsx)(j,{system:s,isSystemTab:t})]})}},52368:function(e,s,t){t.d(s,{f:function(){return d}});var n=t(16134),i=t(30002),a=t(28079),l=t(41966),r=t(57072);let d=e=>{let{includeDatasets:s,includeDisabled:t}=e,{isLoading:d}=(0,r.MO)(),{isLoading:o}=(0,i.te)(),{isLoading:c}=(0,a.fd)(),{isLoading:u}=(0,l.LH)({onlyUnlinkedDatasets:!1},{skip:!s}),m=(0,n.C)(r.qb),f=(0,n.C)(r.Bd),h=(0,n.C)(i.ZL),x=(0,n.C)(i.H7),y=(0,n.C)(a.U3),g=(0,n.C)(a.jp),C=(0,n.C)(l.Q4);return{allDataCategories:t?m:f,allDataSubjects:t?h:x,allDataUses:t?y:g,allDatasets:s?C:void 0,isLoading:d||o||c||u}}},31883:function(e,s,t){t.d(s,{Bw:function(){return n.Bw},D4:function(){return n.D4}});var n=t(19043)}}]);