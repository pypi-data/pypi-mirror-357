import{r as f,j as s}from"./@radix-Cdvw4jJ8.js";import{R as g,u as b,a as y,b as v}from"./ButtonGroup-DFWWFGUE.js";import{y as N,E as P,r as c,P as S,z as i,C as p,T as k,q as C,s as R,t as T,v as u,w as x,G as w,B as E,x as _,g as h}from"./index-BFqbGSck.js";import{S as B}from"./pipeline-CSUlkd50.js";import{f as D,L as l,a as j}from"./@react-router-DeDfXbUF.js";import{S as A}from"./refresh-BcTM09NW.js";import{u as F}from"./all-pipeline-runs-query-DCdax7I5.js";import{S as I,P as z}from"./SearchField-DY6-UbRT.js";import{S as G}from"./terminal-XFL_4QN-.js";import{D as H}from"./DisplayDate-8RESqe5H.js";import{g as L,E as U}from"./ExecutionStatus-CWreILP0.js";import"./trash-DP6Tpp_E.js";import"./AlertDialogDropdownItem-CZW4QyWn.js";import"./DeleteAlertDialog-VIOMDLmx.js";import"./zod-XdS2h1ws.js";import"./index.esm-DhJo3mA6.js";import"./bulk-delete-C_kpIB9A.js";import"./@tanstack-5gTMR7G2.js";import"./delete-run-CCR9md_s.js";import"./@reactflow-8OCk19Fi.js";import"./chevron-right-double-Dgp_gEsp.js";import"./index-DWpiv-Ft.js";import"./check-circle-C4tYvbtw.js";import"./help-Co6aedki.js";function q(e){const{setBreadcrumbs:t}=N();f.useEffect(()=>{e&&t([P,{label:e,href:c.projects.pipelines.namespace(e)}])},[t,e])}function $({namespace:e}){return s.jsx(S,{children:s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(B,{className:"h-5 w-5 fill-neutral-400"}),s.jsx("h1",{className:"text-display-xs font-semibold",children:decodeURIComponent(e)})]})})}const d=1,O=i.object({page:i.coerce.number().min(d).optional().default(d).catch(d),name:i.string().optional(),operator:i.enum(["and","or"]).optional()});function J(){const[e]=D(),{page:t,name:a,operator:r}=O.parse({page:e.get("page")||void 0,name:e.get("name")||void 0});return{page:t,name:a,logical_operator:r}}function K(){return[{id:"select",meta:{width:"1%"},header:({table:e})=>s.jsx(p,{id:"check-all",checked:e.getIsAllRowsSelected(),onCheckedChange:t=>e.toggleAllRowsSelected(t==="indeterminate"?!0:t)}),cell:({row:e})=>s.jsx(p,{id:`check-${e.id}`,checked:e.getIsSelected(),onCheckedChange:e.getToggleSelectedHandler()})},{id:"run",header:"Run",accessorFn:e=>{var t;return{name:e.name,id:e.id,status:(t=e.body)==null?void 0:t.status}},cell:({getValue:e})=>{const{name:t,status:a,id:r}=e();return s.jsxs("div",{className:"group/copybutton flex items-center gap-2",children:[s.jsx(G,{className:`h-5 w-5 shrink-0 ${L(a)}`}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(l,{to:c.projects.runs.detail(r),className:"flex items-center gap-1",children:s.jsx("h2",{className:"text-text-md font-semibold",children:t})}),s.jsx(k,{children:s.jsxs(C,{children:[s.jsx(R,{className:"hover:text-theme-text-brand hover:underline",children:s.jsx(U,{status:a})}),s.jsx(T,{className:"z-20 capitalize",children:a})]})}),s.jsx(u,{copyText:t})]}),s.jsxs(l,{to:c.projects.runs.detail(r),className:"flex items-center gap-1",children:[s.jsx("p",{className:"text-text-xs text-theme-text-secondary",children:r.split("-")[0]}),s.jsx(u,{copyText:r})]})]})]})}},{id:"stack",header:"Stack",accessorFn:e=>{var t,a,r,n;return{name:(a=(t=e.body)==null?void 0:t.stack)==null?void 0:a.name,id:(n=(r=e.body)==null?void 0:r.stack)==null?void 0:n.id}},cell:({getValue:e})=>{const{name:t,id:a}=e();return!t||!a?null:s.jsx(l,{to:c.stacks.overview,children:s.jsx(x,{rounded:!1,className:"inline-block",color:"turquoise",emphasis:"subtle",children:t})})}},{id:"repository",header:"Repository",accessorFn:e=>{var t,a,r,n,o,m;return{name:(r=(a=(t=e.body)==null?void 0:t.code_reference)==null?void 0:a.body)==null?void 0:r.code_repository.name,id:(m=(o=(n=e.body)==null?void 0:n.code_reference)==null?void 0:o.body)==null?void 0:m.code_repository.id}},cell:({getValue:e})=>{const{name:t,id:a}=e();return!t||!a?null:s.jsx("div",{children:s.jsx(x,{rounded:!1,className:"inline-block",color:"grey",emphasis:"subtle",children:t})})}},{id:"created",header:"Created at",accessorFn:e=>{var t;return(t=e.body)==null?void 0:t.created},cell:({getValue:e})=>s.jsx("p",{className:"text-text-sm text-theme-text-secondary",children:s.jsx(H,{dateString:e()})})},{id:"author",header:"Author",accessorFn:e=>{var t;return{author:(t=e.resources)==null?void 0:t.user}},cell:({getValue:e})=>{const{author:t}=e();return s.jsx(w,{username:t.name})}},{id:"admin_actions",header:"",meta:{width:"5%"},cell:({row:e})=>s.jsx(g,{id:e.original.id})}]}function M(){const{namespace:e}=j(),t=J(),a=K(),{selectedRowCount:r}=b(),{data:n,refetch:o}=F({params:{pipeline_name:decodeURIComponent(e),...t,sort_by:"desc:updated"}},{throwOnError:!0});return s.jsxs("div",{className:"flex flex-col gap-5 p-5",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[r?s.jsx(y,{}):s.jsx(I,{searchParams:t}),s.jsxs(E,{intent:"primary",emphasis:"subtle",size:"md",onClick:()=>o(),children:[s.jsx(A,{className:"h-5 w-5 fill-theme-text-brand"}),"Refresh"]})]}),s.jsxs("div",{className:"flex flex-col items-center gap-5",children:[s.jsx("div",{className:"w-full",children:n?s.jsx(_,{columns:a,data:n.items}):s.jsx(h,{className:"h-[500px] w-full"})}),n?n.total_pages>1&&s.jsx(z,{searchParams:t,paginate:n}):s.jsx(h,{className:"h-[36px] w-[300px]"})]})]})}function ge(){const{namespace:e}=j();return q(e),s.jsx("div",{children:s.jsxs(v,{children:[s.jsx($,{namespace:e}),s.jsx(M,{})]})})}export{ge as default};
