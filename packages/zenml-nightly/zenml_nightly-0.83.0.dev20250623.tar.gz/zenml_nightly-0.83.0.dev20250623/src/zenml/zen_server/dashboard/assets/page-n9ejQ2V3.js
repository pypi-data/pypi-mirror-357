import{r as v,j as s}from"./@radix-Cdvw4jJ8.js";import{o as q,f as B,i as V,F as Z,j as G,as as J,au as Y,av as K,aw as Q,B as D,ab as X,a$ as ee,r as te,a as re,d as ne,g as oe,h as se,b0 as ae,aB as ie,b as _}from"./index-BFqbGSck.js";import{c as ce}from"./@tanstack-5gTMR7G2.js";import{S as ue}from"./clock-B_mTG8PH.js";import{C as I}from"./CodeSnippet-D2HkkAGr.js";import{I as le}from"./Infobox-CGxFvqzi.js";import{T as pe}from"./Tick-BPrWnNlN.js";import{E as me}from"./react-error-boundary.esm-7_MuhCay.js";import{L as de}from"./@react-router-DeDfXbUF.js";import"./@reactflow-8OCk19Fi.js";import"./info-QkbQz4QU.js";import"./check-B9QMTa3f.js";async function fe({params:t}){const n=q(t).toString(),o=V(G.apiToken+(n?`?${n}`:"")),r=await B(o,{credentials:"include",headers:{"Content-Type":"application/json"}});if(!r.ok){const e=await r.json().then(a=>Array.isArray(a.detail)?a.detail[1]:a.detail).catch(()=>"Error while creating API Token");throw new Z({status:r.status,statusText:r.statusText,message:e})}return r.json()}function he(t){return ce({mutationFn:async n=>fe(n),...t})}class x extends Error{}x.prototype.name="InvalidTokenError";function ye(t){return decodeURIComponent(atob(t).replace(/(.)/g,(n,o)=>{let r=o.charCodeAt(0).toString(16).toUpperCase();return r.length<2&&(r="0"+r),"%"+r}))}function ve(t){let n=t.replace(/-/g,"+").replace(/_/g,"/");switch(n.length%4){case 0:break;case 2:n+="==";break;case 3:n+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return ye(n)}catch{return atob(n)}}function Te(t,n){if(typeof t!="string")throw new x("Invalid token specified: must be a string");n||(n={});const o=n.header===!0?0:1,r=t.split(".")[o];if(typeof r!="string")throw new x(`Invalid token specified: missing part #${o+1}`);let e;try{e=ve(r)}catch(a){throw new x(`Invalid token specified: invalid base64 for part #${o+1} (${a.message})`)}try{return JSON.parse(e)}catch(a){throw new x(`Invalid token specified: invalid json for part #${o+1} (${a.message})`)}}var b={exports:{}},S,N;function xe(){if(N)return S;N=1;var t="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return S=t,S}var j,E;function ge(){if(E)return j;E=1;var t=xe();function n(){}function o(){}return o.resetWarningCache=n,j=function(){function r(i,c,l,d,h,p){if(p!==t){var f=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw f.name="Invariant Violation",f}}r.isRequired=r;function e(){return r}var a={array:r,bigint:r,bool:r,func:r,number:r,object:r,string:r,symbol:r,any:r,arrayOf:e,element:r,elementType:r,instanceOf:e,node:r,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:o,resetWarningCache:n};return a.PropTypes=a,a},j}var A;function be(){return A||(A=1,b.exports=ge()()),b.exports}var u=be();function R(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function Se(t,n){for(var o=0;o<n.length;o++){var r=n[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function M(t,n,o){return n&&Se(t.prototype,n),t}function $(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),n&&w(t,n)}function g(t){return g=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)},g(t)}function w(t,n){return w=Object.setPrototypeOf||function(r,e){return r.__proto__=e,r},w(t,n)}function je(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function we(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Pe(t,n){return n&&(typeof n=="object"||typeof n=="function")?n:we(t)}function z(t){var n=je();return function(){var r=g(t),e;if(n){var a=g(this).constructor;e=Reflect.construct(r,arguments,a)}else e=r.apply(this,arguments);return Pe(this,e)}}function ke(t){return De(t)||Ce(t)||Oe(t)||_e()}function De(t){if(Array.isArray(t))return P(t)}function Ce(t){if(typeof Symbol<"u"&&Symbol.iterator in Object(t))return Array.from(t)}function Oe(t,n){if(t){if(typeof t=="string")return P(t,n);var o=Object.prototype.toString.call(t).slice(8,-1);if(o==="Object"&&t.constructor&&(o=t.constructor.name),o==="Map"||o==="Set")return Array.from(t);if(o==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return P(t,n)}}function P(t,n){(n==null||n>t.length)&&(n=t.length);for(var o=0,r=new Array(n);o<n;o++)r[o]=t[o];return r}function _e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function T(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:2,o=String(t);if(n===0)return o;var r=o.match(/(.*?)([0-9]+)(.*)/),e=r?r[1]:"",a=r?r[3]:"",i=r?r[2]:o,c=i.length>=n?i:(ke(Array(n)).map(function(){return"0"}).join("")+i).slice(n*-1);return"".concat(e).concat(c).concat(a)}var U={daysInHours:!1,zeroPadTime:2};function Ie(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=n.now,r=o===void 0?Date.now:o,e=n.precision,a=e===void 0?0:e,i=n.controlled,c=n.offsetTime,l=c===void 0?0:c,d=n.overtime,h;typeof t=="string"?h=new Date(t).getTime():t instanceof Date?h=t.getTime():h=t,i||(h+=l);var p=i?h:h-r(),f=Math.min(20,Math.max(0,a)),m=Math.round(parseFloat(((d?p:Math.max(0,p))/1e3).toFixed(f))*1e3),y=Math.abs(m)/1e3;return{total:m,days:Math.floor(y/(3600*24)),hours:Math.floor(y/3600%24),minutes:Math.floor(y/60%60),seconds:Math.floor(y%60),milliseconds:Number((y%1*1e3).toFixed()),completed:m<=0}}function Ne(t,n){var o=t.days,r=t.hours,e=t.minutes,a=t.seconds,i=Object.assign(Object.assign({},U),n),c=i.daysInHours,l=i.zeroPadTime,d=i.zeroPadDays,h=d===void 0?l:d,p=Math.min(2,l),f=c?T(r+o*24,l):T(r,p);return{days:c?"":T(o,h),hours:f,minutes:T(e,p),seconds:T(a,p)}}var F=function(t){$(o,t);var n=z(o);function o(){var r;return R(this,o),r=n.apply(this,arguments),r.state={count:r.props.count||3},r.startCountdown=function(){r.interval=window.setInterval(function(){var e=r.state.count-1;e===0?(r.stopCountdown(),r.props.onComplete&&r.props.onComplete()):r.setState(function(a){return{count:a.count-1}})},1e3)},r.stopCountdown=function(){clearInterval(r.interval)},r.addTime=function(e){r.stopCountdown(),r.setState(function(a){return{count:a.count+e}},r.startCountdown)},r}return M(o,[{key:"componentDidMount",value:function(){this.startCountdown()}},{key:"componentWillUnmount",value:function(){clearInterval(this.interval)}},{key:"render",value:function(){return this.props.children?v.cloneElement(this.props.children,{count:this.state.count}):null}}]),o}(v.Component);F.propTypes={count:u.number,children:u.element,onComplete:u.func};var C=function(t){$(o,t);var n=z(o);function o(r){var e;if(R(this,o),e=n.call(this,r),e.mounted=!1,e.initialTimestamp=e.calcOffsetStartTimestamp(),e.offsetStartTimestamp=e.props.autoStart?0:e.initialTimestamp,e.offsetTime=0,e.legacyMode=!1,e.legacyCountdownRef=null,e.tick=function(){var i=e.calcTimeDelta(),c=i.completed&&!e.props.overtime?void 0:e.props.onTick;e.setTimeDeltaState(i,void 0,c)},e.setLegacyCountdownRef=function(i){e.legacyCountdownRef=i},e.start=function(){if(!e.isStarted()){var i=e.offsetStartTimestamp;e.offsetStartTimestamp=0,e.offsetTime+=i?e.calcOffsetStartTimestamp()-i:0;var c=e.calcTimeDelta();e.setTimeDeltaState(c,"STARTED",e.props.onStart),!e.props.controlled&&(!c.completed||e.props.overtime)&&(e.clearTimer(),e.interval=window.setInterval(e.tick,e.props.intervalDelay))}},e.pause=function(){e.isPaused()||(e.clearTimer(),e.offsetStartTimestamp=e.calcOffsetStartTimestamp(),e.setTimeDeltaState(e.state.timeDelta,"PAUSED",e.props.onPause))},e.stop=function(){e.isStopped()||(e.clearTimer(),e.offsetStartTimestamp=e.calcOffsetStartTimestamp(),e.offsetTime=e.offsetStartTimestamp-e.initialTimestamp,e.setTimeDeltaState(e.calcTimeDelta(),"STOPPED",e.props.onStop))},e.isStarted=function(){return e.isStatus("STARTED")},e.isPaused=function(){return e.isStatus("PAUSED")},e.isStopped=function(){return e.isStatus("STOPPED")},e.isCompleted=function(){return e.isStatus("COMPLETED")},r.date){var a=e.calcTimeDelta();e.state={timeDelta:a,status:a.completed?"COMPLETED":"STOPPED"}}else e.legacyMode=!0;return e}return M(o,[{key:"componentDidMount",value:function(){this.legacyMode||(this.mounted=!0,this.props.onMount&&this.props.onMount(this.calcTimeDelta()),this.props.autoStart&&this.start())}},{key:"componentDidUpdate",value:function(e){this.legacyMode||this.props.date!==e.date&&(this.initialTimestamp=this.calcOffsetStartTimestamp(),this.offsetStartTimestamp=this.initialTimestamp,this.offsetTime=0,this.setTimeDeltaState(this.calcTimeDelta()))}},{key:"componentWillUnmount",value:function(){this.legacyMode||(this.mounted=!1,this.clearTimer())}},{key:"calcTimeDelta",value:function(){var e=this.props,a=e.date,i=e.now,c=e.precision,l=e.controlled,d=e.overtime;return Ie(a,{now:i,precision:c,controlled:l,offsetTime:this.offsetTime,overtime:d})}},{key:"calcOffsetStartTimestamp",value:function(){return Date.now()}},{key:"addTime",value:function(e){this.legacyCountdownRef.addTime(e)}},{key:"clearTimer",value:function(){window.clearInterval(this.interval)}},{key:"isStatus",value:function(e){return this.state.status===e}},{key:"setTimeDeltaState",value:function(e,a,i){var c=this;if(this.mounted){var l=e.completed&&!this.state.timeDelta.completed,d=e.completed&&a==="STARTED";l&&!this.props.overtime&&this.clearTimer();var h=function(){i&&i(c.state.timeDelta),c.props.onComplete&&(l||d)&&c.props.onComplete(e,d)};return this.setState(function(p){var f=a||p.status;return e.completed&&!c.props.overtime?f="COMPLETED":!a&&f==="COMPLETED"&&(f="STOPPED"),{timeDelta:e,status:f}},h)}}},{key:"getApi",value:function(){return this.api=this.api||{start:this.start,pause:this.pause,stop:this.stop,isStarted:this.isStarted,isPaused:this.isPaused,isStopped:this.isStopped,isCompleted:this.isCompleted}}},{key:"getRenderProps",value:function(){var e=this.props,a=e.daysInHours,i=e.zeroPadTime,c=e.zeroPadDays,l=this.state.timeDelta;return Object.assign(Object.assign({},l),{api:this.getApi(),props:this.props,formatted:Ne(l,{daysInHours:a,zeroPadTime:i,zeroPadDays:c})})}},{key:"render",value:function(){if(this.legacyMode){var e=this.props,a=e.count,i=e.children,c=e.onComplete;return v.createElement(F,{ref:this.setLegacyCountdownRef,count:a,onComplete:c},i)}var l=this.props,d=l.className,h=l.overtime,p=l.children,f=l.renderer,m=this.getRenderProps();if(f)return f(m);if(p&&this.state.timeDelta.completed&&!h)return v.cloneElement(p,{countdown:m});var y=m.formatted,O=y.days,H=y.hours,L=y.minutes,W=y.seconds;return v.createElement("span",{className:d},m.total<0?"-":"",O,O?":":"",H,":",L,":",W)}}]),o}(v.Component);C.defaultProps=Object.assign(Object.assign({},U),{controlled:!1,intervalDelay:1e3,precision:0,autoStart:!0});C.propTypes={date:u.oneOfType([u.instanceOf(Date),u.string,u.number]),daysInHours:u.bool,zeroPadTime:u.number,zeroPadDays:u.number,controlled:u.bool,intervalDelay:u.number,precision:u.number,autoStart:u.bool,overtime:u.bool,className:u.string,children:u.element,renderer:u.func,now:u.func,onMount:u.func,onStart:u.func,onPause:u.func,onStop:u.func,onTick:u.func,onComplete:u.func};function Ee({token:t,open:n,setOpen:o}){return s.jsx(J,{open:n,onOpenChange:o,children:s.jsxs(Y,{className:"max-w-[700px]",children:[s.jsx(K,{children:s.jsx(Q,{children:"API Token Created Successfully"})}),s.jsxs("div",{className:"space-y-3 overflow-hidden px-7 py-5",children:[s.jsx(Ae,{}),s.jsx(Re,{}),s.jsx(Me,{token:t}),s.jsx(me,{fallbackRender:()=>null,children:s.jsx(ze,{token:t})}),s.jsx("div",{role:"separator","aria-hidden":"true",className:"h-[1px] bg-theme-border-moderate"}),s.jsx(Ue,{token:t}),s.jsx(Fe,{}),s.jsx("div",{role:"separator","aria-hidden":"true",className:"h-[1px] bg-theme-border-moderate"}),s.jsx(He,{})]})]})})}function Ae(){return s.jsxs("section",{children:[s.jsx("p",{className:"font-semibold",children:"Here is your new API Token"}),s.jsx("p",{className:"text-theme-text-secondary",children:"This token provides temporary access to your ZenML Server"})]})}function Re(){return s.jsx(le,{children:"Important: This token expires in 1 hour and cannot be retrieved later. Please, copy it now."})}function Me({token:t}){const[n,o]=v.useState(!1);function r(e){navigator.clipboard&&(navigator.clipboard.writeText(e),o(!0),setTimeout(()=>{o(!1)},2e3))}return s.jsxs("section",{className:"flex items-center gap-5 py-5",children:[s.jsx("code",{className:"block overflow-x-auto whitespace-nowrap font-sans text-display-xs",children:t}),n?s.jsxs("div",{className:"flex h-7 items-center",children:[s.jsx(pe,{className:"h-5 w-5 shrink-0 fill-theme-text-tertiary"}),s.jsx("p",{className:"sr-only",children:"copied successfully"})]}):s.jsxs(D,{onClick:()=>r(t),size:"md",intent:"secondary",className:"flex items-center gap-1",emphasis:"subtle",children:[s.jsx(X,{className:"size-4 shrink-0 fill-inherit"}),"Copy"]})]})}const $e=({days:t,hours:n,minutes:o,seconds:r,completed:e})=>{if(e)return s.jsx("span",{className:"font-semibold text-theme-text-error",children:"Expired"});const a=c=>String(c).padStart(2,"0"),i=[];return t>0&&i.push(`${t}`),(t>0||n>0)&&i.push(`${a(n)}`),(t>0||n>0||o>0)&&i.push(`${a(o)}`),i.push(`${a(r)}`),s.jsx("span",{className:"font-semibold",children:i.join(":")})};function ze({token:t}){if(!t)return null;const n=Te(t);return n.exp?s.jsxs("div",{className:"flex flex-wrap items-center justify-center gap-3 rounded-sm border border-theme-border-moderate bg-theme-surface-tertiary py-1 text-center",children:[s.jsx(ue,{className:"size-5 shrink-0 fill-theme-text-secondary"}),s.jsxs("div",{children:["Expires in:"," ",s.jsx(C,{daysInHours:!0,renderer:$e,zeroPadTime:2,date:new Date(n.exp*1e3)})]})]}):null}function Ue({token:t}){const n=`${window.location.origin}/api/v1/current-user`;return s.jsxs("section",{className:"space-y-1",children:[s.jsx("div",{className:"font-semibold",children:"Using your API Token"}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("p",{className:"text-theme-text-secondary",children:"To use the API token to run queries against the Server API, you can run the following commands:"}),s.jsx(I,{code:Le(t,n)}),s.jsx(I,{code:We(t,n)})]})]})}function Fe(){const t=`${window.location.origin}/docs`;return s.jsxs("section",{className:"space-y-2",children:[s.jsx("p",{className:"font-semibold",children:"API Documentation"}),s.jsx("p",{className:"text-theme-text-secondary",children:"Access our OpenAPI dashboard for comprehensive documentation on all available REST API endpoints:"}),s.jsx(D,{asChild:!0,size:"md",intent:"secondary",className:"flex w-fit items-center gap-1",emphasis:"subtle",children:s.jsxs("a",{target:"_blank",rel:"noopener noreferrer",href:t,children:[s.jsx("span",{children:"Open the documentation"}),s.jsx(ee,{className:"size-5 shrink-0 fill-inherit"})]})})]})}function He(){return s.jsxs("p",{children:["For long-term programmatic access, consider"," ",s.jsx(de,{className:"link text-theme-text-brand",to:te.settings.service_accounts.overview,children:"setting up a service account instead."})]})}function Le(t,n){return`curl -H "Authorization: Bearer ${t}" "${encodeURI(n)}"`}function We(t,n){return`wget -qO- --header="Authorization: Bearer ${t}" "${encodeURI(n)}"`}const k=v.forwardRef(({className:t,onClick:n,...o},r)=>{const{toast:e}=re(),[a,i]=v.useState(""),[c,l]=v.useState(!1),d=ne(),{mutate:h,isPending:p}=he({onError:m=>{ie(m)&&e({title:"Error",emphasis:"subtle",rounded:!0,status:"error",description:m.message}),console.log(m)},onSuccess:m=>{i(m),l(!0)}});function f(m){l(m),m||i("")}return d.isPending?s.jsx(oe,{className:"h-7 w-10"}):d.isError?null:s.jsxs(s.Fragment,{children:[s.jsxs(D,{disabled:p||ae(d.data.auth_scheme||"other"),ref:r,...o,onClick:()=>h({params:{token_type:"generic"}}),className:se(t),children:[p&&s.jsx("div",{role:"alert","aria-busy":"true",className:"full h-[20px] w-[20px] animate-spin rounded-rounded border-2 border-theme-text-negative border-b-theme-text-brand"}),"Create new token"]}),s.jsx(Ee,{open:c,setOpen:f,token:a})]})});k.displayName="CreateTokenButton";function rt(){return s.jsxs(_,{className:"flex flex-col gap-5 p-5",children:[s.jsx("h1",{className:"text-text-xl font-semibold",children:"API Tokens"}),s.jsx("div",{className:"flex items-center justify-end",children:s.jsx(k,{size:"sm"})}),s.jsxs(_,{className:"flex w-full flex-col items-center justify-center space-y-5 p-9 text-center",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("h2",{className:"text-display-xs font-semibold",children:"Create a new API Token"}),s.jsx("p",{className:"text-text-xl text-theme-text-secondary",children:"Generate a temporary access key for quick, secure automation tasks in your Tenant. An API Token is temporary (max. 1 hour) and won't be stored anywhere."})]}),s.jsx(k,{size:"md"})]})]})}export{rt as default};
