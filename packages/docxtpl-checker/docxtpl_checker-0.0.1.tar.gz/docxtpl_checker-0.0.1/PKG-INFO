Metadata-Version: 2.4
Name: docxtpl-checker
Version: 0.0.1
Summary: A comprehensive validation tool for python-docx-template (docxtpl) Word templates
Home-page: https://github.com/VicBioDev/docxtpl_checker
Author: Docxtpl Template Checker
Author-email: vic.wangyifan@gmail.com
Project-URL: Bug Reports, https://github.com/VicBioDev/docxtpl_checker/issues
Project-URL: Source, https://github.com/VicBioDev/docxtpl_checker
Project-URL: Documentation, https://github.com/VicBioDev/docxtpl_checker#readme
Keywords: docxtpl jinja2 template validation word document docx
Classifier: Development Status :: 5 - Production/Stable
Classifier: Intended Audience :: Developers
Classifier: License :: OSI Approved :: MIT License
Classifier: Operating System :: OS Independent
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.6
Classifier: Programming Language :: Python :: 3.7
Classifier: Programming Language :: Python :: 3.8
Classifier: Programming Language :: Python :: 3.9
Classifier: Programming Language :: Python :: 3.10
Classifier: Programming Language :: Python :: 3.11
Classifier: Topic :: Software Development :: Quality Assurance
Classifier: Topic :: Text Processing :: Markup
Classifier: Topic :: Office/Business :: Office Suites
Requires-Python: >=3.6
Description-Content-Type: text/markdown
License-File: LICENSE
Requires-Dist: jinja2>=2.10
Dynamic: author
Dynamic: author-email
Dynamic: classifier
Dynamic: description
Dynamic: description-content-type
Dynamic: home-page
Dynamic: keywords
Dynamic: license-file
Dynamic: project-url
Dynamic: requires-dist
Dynamic: requires-python
Dynamic: summary

# Docxtpl Template Checker

[![Python](https://img.shields.io/badge/python-3.6+-blue.svg)](https://python.org)
[![License](https://img.shields.io/badge/license-MIT-green.svg)](LICENSE)

A comprehensive validation tool for [python-docx-template](https://github.com/elapouya/python-docx-template) (docxtpl) Word templates. This tool helps you find and fix syntax errors in your Jinja2 templates embedded in Word documents, ensuring your templates work correctly before processing.

## âœ¨ Features

- ğŸ” **Comprehensive Syntax Validation**: Detects Jinja2 and docxtpl-specific syntax errors
- ğŸ“‹ **Detailed Error Reports**: Generates markdown reports with precise error locations and context
- ğŸŒ **Multi-language Support**: Full localization in English and Chinese (ä¸­æ–‡)
- ğŸ“ **Context-aware Error Location**: Shows exact line numbers and surrounding context
- ğŸ·ï¸ **Docxtpl-specific Validation**: Understands `{%p %}`, `{%tr %}`, `{%tc %}`, `{%r %}` prefix tags
- ğŸ¯ **Smart Error Detection**: Identifies unmatched tags, bracket/quote issues, and common mistakes
- ğŸ“Š **Multiple Output Formats**: Terminal summary and detailed markdown reports
- ğŸ› ï¸ **Command-line Interface**: Easy integration into CI/CD pipelines

## ğŸ“¦ Installation

### Prerequisites

- Python 3.6 or higher
- `jinja2` library

### Install Dependencies

```bash
pip install jinja2
```

### Download

```bash
git clone https://github.com/YOUR_USERNAME/docxtpl_checker.git
cd docxtpl_checker
```

## ğŸš€ Quick Start

### Basic Usage

```bash
# Validate a docxtpl template
python docxtpl_checker.py template.docx

# Generate Chinese report
python docxtpl_checker.py template.docx --language zh --report éªŒè¯æŠ¥å‘Š.md

# Enable verbose logging
python docxtpl_checker.py template.docx --verbose
```

### Example Output

```
Validation Results:
  Errors: 1
  Warnings: 0
  Info: 2

âŒ Validation failed with 1 errors

Detailed report saved to: docxtpl_validation_report.md
```

## ğŸ“š Usage Guide

### Command Line Options

```
usage: docxtpl_checker.py [-h] [--report REPORT] [--verbose] [--language {en,zh}] template

positional arguments:
  template              docxtpl template file path (.docx)

options:
  -h, --help            show this help message and exit
  --report REPORT, -r REPORT
                        Validation report output path (default: docxtpl_validation_report.md)
  --verbose, -v         Enable verbose logging
  --language {en,zh}, -l {en,zh}
                        Output language: en (English) or zh (Chinese) (default: en)
```

### Examples

```bash
# Basic validation
python docxtpl_checker.py my_template.docx

# Custom report location
python docxtpl_checker.py my_template.docx --report reports/validation.md

# Chinese interface and report
python docxtpl_checker.py my_template.docx -l zh -r ä¸­æ–‡æŠ¥å‘Š.md

# Verbose output for debugging
python docxtpl_checker.py my_template.docx --verbose
```

## ğŸ” What It Validates

### Jinja2 Syntax
- Variable tags: `{{ variable }}`
- Statement tags: `{% if condition %}`, `{% for item in items %}`
- Comment tags: `{# comment #}`
- Bracket and quote matching
- Control structure pairing

### Docxtpl-specific Features
- Paragraph control: `{% p if condition %}...{% p endif %}`
- Table row control: `{% tr for item in items %}...{% tr endfor %}`
- Table cell control: `{% tc if condition %}...{% tc endif %}`
- Run control: `{% r if condition %}...{% r endif %}`
- Image filters: `{{ image_var|image }}`
- Subdocument inclusion: `{{ subdoc(template_var) }}`

### Common Issues Detected
- âœ… Unmatched opening/closing tags
- âœ… Missing docxtpl prefix in end tags
- âœ… Bracket and parentheses mismatches
- âœ… Unbalanced quotes
- âœ… Syntax errors in expressions
- âœ… Incorrect filter usage
- âœ… Split tags caused by Word formatting

## ğŸ“– Report Features

The tool generates detailed markdown reports with:

- **ğŸ“Š Summary**: Overview of errors, warnings, and suggestions
- **ğŸ¯ Precise Locations**: Exact line numbers and document sections
- **ğŸ“ Context Display**: Shows surrounding lines for easy error location
- **ğŸ’¡ Helpful Suggestions**: Specific recommendations for fixing issues
- **ğŸ·ï¸ Categorized Issues**: Organized by error types and severity
- **ğŸ“‹ Best Practices**: Includes docxtpl template guidelines

### Sample Report Section

```markdown
## Errors ğŸ”´

### Docxtpl Structure

#### 1. {%p if%} tag mismatch: found {%endif%} instead of {%p endif%}

**Location:** Document (Line 9)

**ğŸ“ Context:**
```
    7: {% p if false %}
    8: {{ name2 }}
>>> 9: {% end if %}
    10: {% p endif %}
    11: {% tr for i in range(10) %}
```

**ğŸ’¡ Suggestion:** Change {%endif%} to {%p endif%} to match the docxtpl prefix pattern
```

## ğŸŒ Supported Languages

### English (Default)
```bash
python docxtpl_checker.py template.docx --language en
```

### Chinese (ä¸­æ–‡)
```bash
python docxtpl_checker.py template.docx --language zh
```

All error messages, categories, and suggestions are fully localized.

## ğŸ—ï¸ Project Structure

```
docxtpl_checker/
â”œâ”€â”€ docxtpl_checker.py          # Main validation script
â”œâ”€â”€ examples/                   # Sample template files
â”‚   â”œâ”€â”€ correct.docx           # Valid template example
â”‚   â”œâ”€â”€ wrong_paragraph.docx   # Template with paragraph errors
â”‚   â””â”€â”€ wrong_tablerow.docx    # Template with table row errors
â”œâ”€â”€ deprecated/                 # Previous versions and experiments
â”œâ”€â”€ index.rst                  # Docxtpl syntax documentation
â”œâ”€â”€ README.md                  # This file
â”œâ”€â”€ requirements.txt           # Python dependencies
â”œâ”€â”€ .gitignore                # Git ignore patterns
â””â”€â”€ LICENSE                   # MIT license
```

## ğŸ› ï¸ Development

### Running Tests

Test with the provided example files:

```bash
# Test correct template
python docxtpl_checker.py examples/correct.docx

# Test problematic templates
python docxtpl_checker.py examples/wrong_paragraph.docx
python docxtpl_checker.py examples/wrong_tablerow.docx

# Test Chinese localization
python docxtpl_checker.py examples/wrong_paragraph.docx --language zh
```

### Adding New Validations

The tool is designed to be extensible. Key methods for adding validations:

- `validate_single_block()`: Add new block-level validations
- `check_template_structure()`: Add new structure-level validations
- `check_docxtpl_specific()`: Add docxtpl-specific validations

## ğŸ“‹ Requirements

- Python 3.6+
- jinja2

See `requirements.txt` for specific versions.

## ğŸ¤ Contributing

Contributions are welcome! Please feel free to submit issues, feature requests, or pull requests.

### Areas for Contribution
- Additional validation rules
- More language translations
- Performance improvements
- Additional output formats
- Integration with other tools

## ğŸ“„ License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.

## ğŸ™ Acknowledgments

- [python-docx-template (docxtpl)](https://github.com/elapouya/python-docx-template) - The amazing library this tool validates
- [Jinja2](https://jinja.palletsprojects.com/) - The template engine used by docxtpl
- [python-docx](https://github.com/python-openxml/python-docx) - For Word document processing

## ğŸ“ Support

If you encounter any issues or have questions:

1. Check the [examples/](examples/) directory for sample usage
2. Review the generated validation reports for detailed error information
3. Create an issue on GitHub with your template and error details

---

**Happy templating!** ğŸ‰
