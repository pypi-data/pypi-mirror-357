import{r as t,h as i,g as e}from"./p-abc8c9af.js";var n,s,o,c;function r(t){const{limetype:i,id:e}=this.context;if(t[i])return t[i].find(t=>t.id===e)}function l(t){return t.session}function u(t,i){return(e,n)=>{const s=function(t,i,e,n){let s=h.find(i=>i.component===t);return s||(s={properties:[],component:t},h.push(s)),s.properties.push({options:e,name:i,service:{name:n.name,method:n.method||"subscribe"}}),s}(e,n,t,i);1===s.properties.length&&function(t,i){const e=t.componentWillLoad,n=t.componentDidUnload,s=[];t.componentWillLoad=function(...t){if(i.forEach(t=>{a.apply(this,[s,t])}),e)return e.apply(this,t)},t.componentDidUnload=function(...t){n&&n.apply(this,t),f.apply(this,[s])}}(e,s.properties)}}!function(t){t.Translate="translate",t.Http="http",t.Route="route",t.Notification="notifications",t.Query="query",t.CommandBus="commandBus",t.Dialog="dialog",t.EventDispatcher="eventDispatcher",t.LimetypesState="state.limetypes",t.LimeobjectsState="state.limeobjects",t.ApplicationState="state.application",t.ConfigsState="state.configs",t.FiltersState="state.filters",t.DeviceState="state.device",t.TaskState="state.tasks"}(n||(n={})),function(t){t.AND="AND",t.OR="OR",t.EQUALS="=",t.NOT="!",t.GREATER=">",t.LESS="<",t.IN="IN",t.BEGINS="=?",t.LIKE="?",t.LESS_OR_EQUAL="<=",t.GREATER_OR_EQUAL=">="}(s||(s={})),function(t){t.Received="command.received",t.Handled="command.handled",t.Failed="command.failed"}(o||(o={})),function(t){t.Pending="PENDING",t.Started="STARTED",t.Retry="RETRY",t.Success="SUCCESS",t.Failure="FAILURE"}(c||(c={}));const h=[];function a(t,i){let e=t.find(t=>t.instance===this);e||(e={instance:this,unsubscribes:[]},t.push(e));const n=m.apply(this,[i.options,i.name,i.service.name,i.service.method]);e.unsubscribes.push(n)}function f(t=[]){t.find(t=>t.instance===this).unsubscribes.forEach(t=>t());for(let i=t.length-1;i>=0;i--)t[i].instance===this&&t.splice(i,1)}function m(t,i,e,n){const s=Object.assign({},t);!function(t,i){t.filter&&(t.filter=t.filter.map(t=>t.bind(i))),t.map&&(t.map=t.map.map(t=>t.bind(i)))}(s,this);const o=this.platform;if(!o.has(e))throw new Error(`Service ${e} does not exist`);return o.get(e)[n](function(t,i){return e=>{t[i]=e}}(this,i),s)}var d=function(t,i,e,n){var s,o=arguments.length,c=o<3?i:null===n?n=Object.getOwnPropertyDescriptor(i,e):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,i,e,n);else for(var r=t.length-1;r>=0;r--)(s=t[r])&&(c=(o<3?s(c):o>3?s(i,e,c):s(i,e))||c);return o>3&&c&&Object.defineProperty(i,e,c),c};const v=class{constructor(i){t(this,i),this.document={},this.session={},this.config={},this.testing=!0,this.testing3="test",this.includePerson=!0,this.includeCoworker=!0,this.cloneDocument=!0,this.isOpen=!1,this.allowedExtensions=Object.freeze(["PDF","DOC","DOCX"]),this.setCloneDocument=t=>{t.stopPropagation(),this.cloneDocument=t.detail},this.openDialog=()=>{this.isOpen=!0},this.closeDialog=()=>{this.isOpen=!1}}goToScrive(t,i){window.open(`${this.config.limepkg_scrive.scriveHost}/public/?limeDocId=${t}&lang=${this.session.language}&usePerson=${this.includePerson}&useCoworker=${this.includeCoworker}&cloneDocument=${this.cloneDocument}&scriveDocId=${i}`)}files(){var t;const i=(null===(t=this.document)||void 0===t?void 0:t._files)||{};return Object.keys(i).map(t=>i[t])}isSignable(t){return this.allowedExtensions.includes((t.extension||"").toUpperCase())}render(){if(console.log("---------",this),"document"!==this.context.limetype)return;const t=this.files().filter(this.isSignable,this);if(0===t.length||t.length>1)return;const e=this.platform.get(n.Translate),s=e.get("limepkg_scrive.primary_action"),o=e.get("limepkg_scrive.clone_document"),c=e.get("limepkg_scrive.clone_hint"),r=e.get("limepkg_scrive.clone_info"),l=e.get("limepkg_scrive.ok");return i("section",null,i("limel-button",{id:"scrive_esign_button",label:s,outlined:!0,icon:"signature",onClick:()=>{var t;return this.goToScrive(this.context.id,null===(t=this.document)||void 0===t?void 0:t.scrive_document_id)}}),i("hr",null),i("p",null,i("h1",null,"hello world")),i("hr",null),i("p",null,i("limel-flex-container",{justify:"start"},i("limel-checkbox",{label:o,checked:this.cloneDocument,onChange:this.setCloneDocument}),i("limel-icon-button",{icon:"question_mark",label:c,onClick:this.openDialog}))),i("limel-dialog",{open:this.isOpen,onClose:this.closeDialog},i("p",null,r),i("limel-button",{label:l,onClick:this.closeDialog,slot:"button"})))}get element(){return e(this)}static get style(){return".container{margin-left:1.25rem;margin-right:1.25rem}#scrive_esign_button{isolation:isolate;position:relative}#scrive_esign_button:after{content:\"\";display:block;width:1.5rem;height:1.5rem;position:absolute;z-index:1;top:0;left:.25rem;bottom:0;margin:auto;background-image:url(\"data:image/svg+xml; utf8, <svg xmlns=\'http://www.w3.org/2000/svg\' viewBox=\'0 0 128.9 116.04\'><defs><style>.cls-1{fill:none;}.cls-2{fill:%2327282d;}</style></defs><g id=\'Layer_2\' data-name=\'Layer 2\'><g id=\'S_Mark_Dark\' data-name=\'S Mark Dark\'><g id=\'S_Black\' data-name=\'S Black\'><rect class=\'cls-1\' width=\'128.9\' height=\'116.04\'/><path class=\'cls-2\' d=\'M65.51,65.48a29.87,29.87,0,0,1,7.76,2,7.3,7.3,0,0,1,3.62,3,8.64,8.64,0,0,1,1,4.35A10.34,10.34,0,0,1,76,80.71a12.35,12.35,0,0,1-4.64,3.53c-4.65,2.1-11.05,2.69-16.06,2.73A40.35,40.35,0,0,1,44,85.53,20.24,20.24,0,0,1,36.8,82,13.63,13.63,0,0,1,33,77.1,13.1,13.1,0,0,1,31.86,72H17.67A28.57,28.57,0,0,0,20.6,83a22,22,0,0,0,6.22,7.55,31.48,31.48,0,0,0,8.63,4.6,48.07,48.07,0,0,0,9.91,2.31,75.66,75.66,0,0,0,10.35.63c10.94,0,25-2.14,32.12-11.44A22.22,22.22,0,0,0,92.07,73.2a18,18,0,0,0-1.61-7.8A19.6,19.6,0,0,0,86,59.48a22.44,22.44,0,0,0-6.43-4,29.84,29.84,0,0,0-7.69-2.1C63.47,52.2,44.59,50.46,39.22,48A7.21,7.21,0,0,1,35.56,45a7.69,7.69,0,0,1-1-4.3,8.74,8.74,0,0,1,1.72-5.52,12.69,12.69,0,0,1,4.6-3.53,26.67,26.67,0,0,1,6.37-1.85,43.93,43.93,0,0,1,6.88-.55,34.38,34.38,0,0,1,12.25,2,17.4,17.4,0,0,1,7.35,5,11.88,11.88,0,0,1,2.67,7H90.64A27.58,27.58,0,0,0,87.9,33.17a24.4,24.4,0,0,0-6.73-8,31.92,31.92,0,0,0-11-5.19,60.15,60.15,0,0,0-15.84-1.92A52.27,52.27,0,0,0,36.22,21a25.4,25.4,0,0,0-11.67,8.24,20.92,20.92,0,0,0-4.17,13A18.17,18.17,0,0,0,26.49,56,22.45,22.45,0,0,0,32.92,60a29.63,29.63,0,0,0,7.61,2.06C48.91,63.23,57.21,64.37,65.51,65.48Z\'/><path class=\'cls-2\' d=\'M111.23,89.19a8.84,8.84,0,1,1-8.84-8.88A8.87,8.87,0,0,1,111.23,89.19Z\'/></g></g></g></svg>\");background-color:var(--lime-elevated-surface-background-color);background-size:contain;background-repeat:no-repeat;background-position:50%}"}};var p;d([function(t={}){const i={name:n.LimeobjectsState};return t.map=[r,...t.map||[]],u(t,i)}()],v.prototype,"document",void 0),d([function(t={}){const i={name:n.ApplicationState};return t.map=[l,...t.map||[]],u(t,i)}()],v.prototype,"session",void 0),d([(p={},u(p,{name:n.ConfigsState}))],v.prototype,"config",void 0);export{v as lwc_limepkg_scrive};