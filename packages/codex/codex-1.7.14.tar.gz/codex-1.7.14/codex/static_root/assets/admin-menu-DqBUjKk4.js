import{_ as f,B as S,D as F,ae as T,a3 as L,s as _,q as a,v as s,x as u,H as r,a as i,w as c,b as I,F as h,z as g,y as k,A as m,E as A,T as y,bA as M,G as x,cL as B,by as w,a0 as J}from"./main-Dl2Lrwga.js";import{C as O}from"./change-password-dialog-DQ_0TaFN.js";import{useAdminStore as C}from"./admin-rFfBszpt.js";import{d as b}from"./VSelectionControl-CjjwyQ-Y.js";import{a as v}from"./VDivider-tFagM0PC.js";import{n as U}from"./forwardRefs-DkWUbz_i.js";import{v as N,a as P,C as V}from"./VDialog-BScRe1ug.js";import{T as R}from"./index-DHunaD9D.js";import"./VForm-B__yH-Y4.js";const Q="Create Covers",E="Purge Covers",z="Find Orphan",G="Adopt Folders",W="Covers Created",q="Covers Deleted",H="Covers Link",X="Covers Moved",j="Query Missing Covers",K="Covers Modified",Y="Dirs Deleted",Z="Dirs Moved",$="Dirs Modified",ee="Files Created",te="Files Deleted",ne="Failed Imports",se="Files Moved",oe="Files Modified",ae="Group Update",ie="Link M2M Fields",re="Query M2M Fields",le="Create Fks",de="Query Missing Fks",ce="Aggregate Tags",me="Cleanup Bookmarks",ue="Cleanup Covers",Ce="Codex Restart",pe="Codex Stop",Ie="Codex Update",ke="Db Backup",_e="Db Optimize",he="Fts Integrity Check",be="Fts Rebuild",fe="Integrity Check",Se="Integrity Fk",Fe="Codex Latest Version",ve="Cleanup Sessions",De="Cleanup Fk",Te="Search Index Create",Le="Search Index Remove",ge="Search Index Optimize",Ae="Search Index Update",ye="Search Index Clear",Me="Poll",xe={CCC:Q,CCD:E,CFO:z,IAF:G,ICC:W,ICD:q,ICL:H,ICM:X,ICQ:j,ICU:K,IDD:Y,IDM:Z,IDU:$,IFC:ee,IFD:te,IFI:ne,IFM:se,IFU:oe,IGU:ae,IMC:ie,IMQ:re,ITC:le,ITQ:de,ITR:ce,JCB:me,JCD:ue,JCR:Ce,JCS:pe,JCU:Ie,JDB:ke,JDO:_e,JFC:he,JFR:be,JIC:fe,JIF:Se,JLV:Fe,JSD:ve,JTD:De,SIC:Te,SID:Le,SIO:ge,SIU:Ae,SIX:ye,WPO:Me},Be={name:"AdminStatusList",components:{CloseButton:O},data(){return{mdiCloseCircleOutline:L}},computed:{...F(C,{librarianStatuses:e=>e.librarianStatuses,show:e=>e.librarianStatuses.length>0})},created(){this.load()},methods:{...S(C,["loadTable","librarianTask"]),showComplete:e=>Number.isInteger(e.complete),indeterminate:e=>e.active&&(!e.total||!Number.isInteger(e.complete)),progress(e){return!e.total||globalThis.indeterminate?0:100*+e.complete/+e.total},load(){this.loadTable("LibrarianStatus")},clear(){this.librarianTask("librarian_clear_status","")},title(e){return xe[e.statusType]},nf(e){return Number.isInteger(e)?T.format(e):"?"}}},we={key:0},Je={nav:"",class:"statusItem"},Oe={class:"statusItemTitle"},Ue={key:0,class:"statusItemSubtitle"},Ne={key:1,class:"statusItemSubtitle"},Pe={key:0};function Ve(e,o,l,D,p,t){const d=_("CloseButton");return s(),a(h,null,[e.show?(s(),u(v,{key:0})):r("",!0),i(P,{onClick:t.load},{default:c(()=>[i(b,null,{default:c(()=>[e.show?(s(),a("div",we,[i(d,{id:"clearButton",title:"Clear Librarian Statuses",size:"small",onClick:t.clear},null,8,["onClick"]),o[0]||(o[0]=I("h4",null,"Librarian Tasks",-1)),(s(!0),a(h,null,g(e.librarianStatuses,n=>(s(),u(b,{key:n.statusType},{default:c(()=>[I("div",Je,[I("div",Oe,[k(m(t.title(n))+" ",1),n.subtitle?(s(),a("div",Ue,m(n.subtitle),1)):r("",!0),t.showComplete(n)||Number.isInteger(n.total)?(s(),a("div",Ne,[t.showComplete(n)?(s(),a("span",Pe,m(t.nf(n.complete))+" / ",1)):r("",!0),k(" "+m(t.nf(n.total)),1)])):r("",!0)]),i(U,{indeterminate:t.indeterminate(n),"model-value":t.progress(n),bottom:""},null,8,["indeterminate","model-value"])])]),_:2},1024))),128))])):(s(),u(N,{key:1,id:"noTasksRunning"},{default:c(()=>o[1]||(o[1]=[k(" No librarian tasks running ")])),_:1,__:[1]}))]),_:1})]),_:1},8,["onClick"])],64)}const Re=f(Be,[["render",Ve],["__scopeId","data-v-daacefdf"]]),Qe={name:"AdminMenu",components:{AdminStatusList:Re,CodexListItem:V},data(){return{mdiOpenInNew:J,mdiDatabaseClockOutline:w,mdiCrownOutline:B}},computed:{...A(x,["isUserAdmin"]),...F(C,["unseenFailedImports"]),failedImportsIcon(){return this.unseenFailedImports?M:void 0},showAdminPanelLink(){var e,o,l;return!((l=(o=(e=this.$router.currentRoute)==null?void 0:e.value)==null?void 0:o.name)!=null&&l.startsWith("admin"))}},methods:{...S(C,["clearFailedImports","librarianTask"]),onPoll(){this.librarianTask("poll")}}},Ee={key:0};function ze(e,o,l,D,p,t){const d=_("CodexListItem"),n=_("AdminStatusList");return e.isUserAdmin?(s(),a("div",Ee,[i(v),y(i(d,{title:"Poll All Libraries","prepend-icon":p.mdiDatabaseClockOutline,onClick:t.onPoll},null,8,["prepend-icon","onClick"]),[[R,{openDelay:2e3,text:"for updated comics"}]]),t.showAdminPanelLink?(s(),u(d,{key:0,class:"adminPanelLink",to:{name:"admin"},"prepend-icon":p.mdiCrownOutline,title:"Admin Panel","append-icon":t.failedImportsIcon},null,8,["prepend-icon","append-icon"])):r("",!0),i(n)])):r("",!0)}const $e=f(Qe,[["render",ze]]);export{$e as default};
