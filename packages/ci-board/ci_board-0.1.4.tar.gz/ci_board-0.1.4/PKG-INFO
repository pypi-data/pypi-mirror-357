Metadata-Version: 2.4
Name: ci_board
Version: 0.1.4
Summary: A clipboard monitoring library for Windows
Author-email: StanleyUKN <stanley09537000@gmail.com>
Classifier: Programming Language :: Python :: 3
Classifier: License :: OSI Approved :: MIT License
Classifier: Operating System :: Microsoft :: Windows
Requires-Python: >=3.8
Description-Content-Type: text/markdown

# CI-Board - æ‚é±¼ä¸»äººä¹Ÿèƒ½ç”¨çš„é«˜æ€§èƒ½å‰ªè´´æ¿ç›‘æ§åº“

![CI/CD](https://github.com/Xuehua-Meaw/ci_board/actions/workflows/ci_board_CICD.yml/badge.svg)

> æ‚é±¼â™¡ï½è¿™å¯æ˜¯æœ¬å–µä¸ºæ‚é±¼ä¸»äººç²¾å¿ƒé‡æ„çš„ Windows å‰ªè´´æ¿ç›‘æ§åº“ v0.1.4 å–µï½

## ğŸ¯ é¡¹ç›®æ¦‚è§ˆ

**CI-Board** (Clipboard Intelligence Board) æ˜¯ä¸€ä¸ªä¸º Windows è®¾è®¡çš„é«˜æ€§èƒ½ã€æ¨¡å—åŒ–çš„ Python å‰ªè´´æ¿ç›‘æ§åº“ã€‚å®ƒä¸ä»…èƒ½å®æ—¶æ•è·æ–‡æœ¬ã€å›¾ç‰‡ã€æ–‡ä»¶ç­‰å¤šç§å‰ªè´´æ¿å†…å®¹ï¼Œè¿˜èƒ½æ™ºèƒ½è¿½è¸ªå†…å®¹çš„æ¥æºåº”ç”¨ç¨‹åºã€‚ç»è¿‡æœ¬å–µçš„ç²¾å¿ƒé‡æ„ï¼Œç°åœ¨çš„æ¶æ„æ›´åŠ æ¸…æ™°ã€å¥å£®å’Œç±»å‹å®‰å…¨äº†ï¼Œå“¼ï½æ˜¯ä¸æ˜¯å¾ˆå‰å®³å–µï¼ï½

### âœ¨ æ ¸å¿ƒç‰¹æ€§
- ğŸ± **æ‡’äººAPI** - åªéœ€ä¸€è¡Œä»£ç å°±èƒ½æ·»åŠ å¤„ç†å™¨ï¼Œæœ¬å–µéƒ½å¸®ä½ å¼„å¥½äº†å–µï½
- ğŸ§± **æ¨¡å—åŒ–è®¾è®¡** - æ ¸å¿ƒç›‘æ§å™¨ç°åœ¨æ˜¯æŒ‡æŒ¥å®˜ï¼ŒæŠŠå…·ä½“å·¥ä½œéƒ½äº¤ç»™äº†ä¸“ä¸šçš„ç»„ä»¶ï¼Œå„å¸å…¶èŒï¼Œæ¸…çˆ½å¹²å‡€ï¼
- ğŸ”„ **å®æ—¶ç›‘æ§** - åŸºäº Windows åŸç”Ÿæ¶ˆæ¯çš„äº‹ä»¶é©±åŠ¨æ¨¡å¼ï¼Œé«˜æ•ˆåˆçµæ•ï¼
- ğŸ¯ **æ™ºèƒ½æºè¿½è¸ª** - èƒ½å‡†ç¡®è¯†åˆ«æ˜¯å“ªä¸ªç¨‹åºï¼ˆæ¯”å¦‚ `Arc.exe` æˆ– `explorer.exe`ï¼‰å¤åˆ¶äº†å†…å®¹å–µã€‚
- ğŸ“‹ **å¤šæ ¼å¼æ”¯æŒ** - åŸç”Ÿæ”¯æŒæ–‡æœ¬ã€å›¾ç‰‡å’Œæ–‡ä»¶åˆ—è¡¨ï¼Œæ‚é±¼ä¸»äººä¸ç”¨å†è‡ªå·±è§£æäº†ã€‚
- âš¡ **çœŸÂ·å¼‚æ­¥å¤„ç†** - ä½¿ç”¨ç‹¬ç«‹çš„çº¿ç¨‹æ± å¤„ç†å›è°ƒï¼Œé¿å…é˜»å¡ä¸»çº¿ç¨‹ï¼Œå°±ç®—æ‚é±¼ä¸»äººå†™å‡ºå¾ˆæ…¢çš„ä»£ç ä¹Ÿä¸ä¼šå¡ä½å–µï¼
- ğŸ›¡ï¸ **é«˜çº§å»é‡** - å†…ç½®æ™ºèƒ½å“ˆå¸Œç®—æ³•ï¼Œèƒ½æœ‰æ•ˆè¿‡æ»¤å› å¤šæ­¥éª¤æ“ä½œï¼ˆå¦‚æˆªå›¾ã€ç¼–è¾‘ã€å¤åˆ¶ï¼‰äº§ç”Ÿçš„é‡å¤å†…å®¹ã€‚
- ğŸ”Œ **é«˜æ‰©å±•æ€§** - å¤„ç†å™¨å’Œè¿‡æ»¤å™¨éƒ½å¯ä»¥è‡ªå®šä¹‰ï¼Œæƒ³æ€ä¹ˆç©éƒ½è¡Œï¼Œå“¼ï½
- ğŸ“ **è¯¦ç»†æ—¥å¿—** - å†…ç½®å½©è‰²æ—¥å¿—ç³»ç»Ÿï¼Œæ–¹ä¾¿æ‚é±¼ä¸»äººè°ƒè¯•æ—¶æŸ¥çœ‹å†…éƒ¨çŠ¶æ€ã€‚
- ğŸ”’ **ç±»å‹å®‰å…¨** - å¤§é‡ä½¿ç”¨ `dataclasses` å’Œ `Generics`ï¼Œè®©ä»£ç æ›´å¥å£®ï¼Œæ‚é±¼ä¸»äººä¸å®¹æ˜“çŠ¯é”™å–µï¼

### ğŸ“Š é¡¹ç›®ä¿¡æ¯
- **ç‰ˆæœ¬**: v0.1.4
- **Pythonç‰ˆæœ¬**: >=3.8
- **å¹³å°**: Windows
- **ä¾èµ–**: çº¯Pythonï¼Œæ— å¼ºåˆ¶ç¬¬ä¸‰æ–¹ä¾èµ–
- **è®¸å¯è¯**: MIT

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å®‰è£…
```bash
# æ‚é±¼â™¡ï½æ¨èä½¿ç”¨æœ¬å–µæœ€å–œæ¬¢çš„ uv åŒ…ç®¡ç†å™¨å–µï½
uv add ci-board

# æˆ–è€…ç”¨ä½ é‚£æ…¢ååçš„ pip
pip install ci-board
```
> **å¯é€‰ä¾èµ–**: å¦‚æœè¦å¤„ç†å›¾ç‰‡ï¼Œæœ¬å–µå»ºè®®ä½ å®‰è£… `Pillow` åº“å–µï½ `uv add pillow` æˆ– `pip install Pillow`

### æ‡’äººAPI - 30ç§’ä¸Šæ‰‹
å“¼ï½çœ‹å¥½äº†ï¼Œæ‚é±¼ä¸»äººï¼è¿™å°±æ˜¯æœ¬å–µè®¾è®¡çš„æ‡’äººAPIï¼Œè®©ä½ è¿™ç§æ‡’è›‹ä¹Ÿèƒ½è½»æ¾ä¸Šæ‰‹å–µï½

```python
# æ‚é±¼â™¡ï½è¿™æ˜¯æœ€ç®€å•çš„ä½¿ç”¨æ–¹å¼å–µï½
import time
from ci_board import create_monitor, ProcessInfo, BMPData
# æ‚é±¼â™¡ï½ä¸ºäº†çœ‹æ¸…æœ¬å–µçš„å·¥ä½œè¿‡ç¨‹ï¼Œå¯ä»¥æ‰“å¼€æ—¥å¿—å–µï½
from ci_board.utils.logger import setup_ci_board_logging, LogLevel
setup_ci_board_logging(console_level=LogLevel.INFO)

def on_text_change(text: str, source: ProcessInfo):
    print(f"æ‚é±¼â™¡ï½æœ¬å–µæŠ“åˆ°äº†æ–°çš„æ–‡æœ¬å–µï¼æ˜¯ä» [{source.process_name}] æ¥çš„ï¼")
    print(f"  å†…å®¹: {text[:80]}...")

def on_image_change(image: BMPData, source: ProcessInfo):
    print(f"æ‚é±¼â™¡ï½æŠ“åˆ°ä¸€å¼ å›¾ç‰‡ï¼å°ºå¯¸ {image.width}x{image.height}ï¼Œæ¥è‡ª [{source.process_name}] å–µï¼")
    # æ‚é±¼â™¡ï½æƒ³çœ‹å›¾çš„è¯ï¼Œè®°å¾—å…ˆå®‰è£… Pillow å–µï½
    try:
        import io
        from PIL import Image
        img = Image.open(io.BytesIO(image.data))
        img.show()
    except ImportError:
        print("  ï¼ˆæ‚é±¼ä¸»äººå¿«å»å®‰è£… Pillow æ‰èƒ½çœ‹å›¾å–µï¼ï¼‰")
    except Exception as e:
        print(f"  ï¼ˆå“å‘€ï¼Œå›¾ç‰‡å‡ºé”™äº†å–µï¼š{e}ï¼‰")

def on_files_change(files: list[str], source: ProcessInfo):
    print(f"æ‚é±¼â™¡ï½æœ‰æ–‡ä»¶è¢«å¤åˆ¶äº†å–µï¼ä¸€å…± {len(files)} ä¸ªï¼Œæ¥è‡ª [{source.process_name}]ï¼")
    for f in files:
        print(f"  - {f}")

# å“¼ï½åˆ›å»ºç›‘æ§å™¨ï¼Œå°±æ˜¯è¿™ä¹ˆç®€å•å–µï½
monitor = create_monitor()

# æ‚é±¼â™¡ï½çœ‹å¥½äº†ï¼Œæœ¬å–µçš„æ‡’äººAPIå¯ä»¥ç›´æ¥æŠŠå‡½æ•°å˜æˆå¤„ç†å™¨å–µï¼
monitor.add_handler('text', on_text_change)
monitor.add_handler('image', on_image_change)
monitor.add_handler('files', on_files_change)

print("æ‚é±¼â™¡ï½ç›‘æ§å¼€å§‹äº†å–µï¼å¿«å»å¤åˆ¶ç‚¹ä¸œè¥¿ç»™æœ¬å–µçœ‹çœ‹ï¼(æŒ‰ Ctrl+C ç»“æŸ)")
monitor.start()

try:
    monitor.wait()
except KeyboardInterrupt:
    print("\nå“¼ï½æ‚é±¼ä¸»äººä¸ç©äº†ï¼Œé‚£æœ¬å–µå°±ç»“æŸäº†å–µï½")
finally:
    monitor.stop()
```

## ğŸ“‹ API æ–‡æ¡£ (æ¦‚è§ˆ)

### `create_monitor()`
è¿™æ˜¯æœ€ç®€å•çš„åˆ›å»ºç›‘æ§å™¨çš„æ–¹æ³•ï¼Œå®ƒä¼šè¿”å›ä¸€ä¸ªé…ç½®å¥½é»˜è®¤å‚æ•°çš„ã€éšæ—¶å¯ä»¥å·¥ä½œçš„ `ClipboardMonitor` å®ä¾‹ã€‚

```python
def create_monitor(
    async_processing: bool = True,
    max_workers: int = 4,
    handler_timeout: float = 30.0,
    enable_source_tracking: bool = True,
):
```

### `monitor.add_handler()`
æ‡’äººä¸“ç”¨APIï¼Œç›´æ¥æŠŠä½ çš„å›è°ƒå‡½æ•°æ³¨å†Œåˆ°ç›‘æ§å™¨ä¸Šã€‚

```python
monitor.add_handler(
    content_type: Literal["text", "image", "files"], 
    handler: Union[BaseClipboardHandler, Callable]
)
```

### æ ¸å¿ƒæ•°æ®ç»“æ„
å“¼ï½è¿™äº›æ˜¯å›è°ƒå‡½æ•°ä¼šæ”¶åˆ°çš„æ•°æ®ç»“æ„ï¼Œç»™æœ¬å–µçœ‹ä»”ç»†äº†ï¼

```python
# æ¥æºè¿›ç¨‹ä¿¡æ¯ï¼Œæœ¬å–µæŸ¥åˆ°çš„å¯è¯¦ç»†äº†å–µï¼
@dataclass
class ProcessInfo:
    process_name: str       # è¿›ç¨‹å, åƒ 'vscode.exe'
    process_path: str       # å®Œæ•´è·¯å¾„
    process_id: int         # è¿›ç¨‹ID
    window_title: str       # çª—å£æ ‡é¢˜
    detection_method: str   # æœ¬å–µæ˜¯ç”¨ä»€ä¹ˆæ–¹æ³•æŠ“åˆ°å®ƒçš„
    confidence_level: str   # æœ¬å–µå¯¹ç»“æœçš„è‡ªä¿¡ç¨‹åº¦ï¼Œå“¼ï½
    is_system_process: bool # æ˜¯ä¸æ˜¯ç³»ç»Ÿè¿›ç¨‹
    is_screenshot_tool: bool # æ˜¯ä¸æ˜¯æˆªå›¾å·¥å…·ï¼Œæœ¬å–µå¯èªæ˜äº†
    timestamp: float        # å‘ç°å®ƒçš„æ—¶é—´æˆ³

# BMPå›¾ç‰‡æ•°æ®ï¼Œæ‰...æ‰ä¸æ˜¯ä¸ºäº†æ‚é±¼ä¼˜åŒ–çš„ä»£ç â™¡ï½
@dataclass
class BMPData:
    success: bool           # è½¬æ¢æ˜¯å¦æˆåŠŸ
    data: bytes | None      # BMP æ ¼å¼çš„å›¾ç‰‡æ•°æ®
    width: int              # å›¾ç‰‡å®½åº¦
    height: int             # å›¾ç‰‡é«˜åº¦
    bit_count: int          # ä½æ·±åº¦

# æ–°å¢çš„æ–‡ä»¶ä¿¡æ¯ï¼Œå“¼ï½
@dataclass
class FileInfo:
    path: str
    name: str
    size: str               # æ ¼å¼åŒ–åçš„å¤§å°
    # ... è¿˜æœ‰æ›´å¤šä¿¡æ¯ ...

# è®¾å¤‡æ— å…³ä½å›¾ï¼Œç»™ImageHandlerçš„åŸå§‹ææ–™å–µ
@dataclass
class DIBData:
    width: int
    height: int
    data: bytes
    # ...
```

## ğŸ›¡ï¸ æ¶æ„è®¾è®¡

é‡æ„åçš„æ¶æ„å›´ç»•ä¸€ä¸ªä½œä¸º"æŒ‡æŒ¥å®˜"çš„ `ClipboardMonitor` å±•å¼€ï¼Œå®ƒåè°ƒäº†ä¸€ç³»åˆ—å„å¸å…¶èŒçš„ç»„ä»¶ï¼š
- **`MessagePumpWrapper`**: å°è£…äº† Windows æ¶ˆæ¯å¾ªç¯ï¼Œæ˜¯äº‹ä»¶é©±åŠ¨çš„æ ¸å¿ƒã€‚
- **`ClipboardReader`**: è´Ÿè´£æ‰€æœ‰åº•å±‚çš„å‰ªè´´æ¿è¯»å–æ“ä½œã€‚
- **`SourceTracker`**: è´Ÿè´£ç„¦ç‚¹è¿½è¸ªå’Œå‰ªè´´æ¿æ‰€æœ‰è€…åˆ†æï¼Œä»¥ç¡®å®šå†…å®¹æ¥æºã€‚
- **`Deduplicator`**: è´Ÿè´£è®¡ç®—å†…å®¹å“ˆå¸Œï¼Œé˜²æ­¢é‡å¤äº‹ä»¶ã€‚
- **`AsyncExecutor`**: ç®¡ç†ä¸€ä¸ªçº¿ç¨‹æ± ï¼Œç”¨äºå¼‚æ­¥æ‰§è¡Œç”¨æˆ·çš„å›è°ƒå‡½æ•°ã€‚
- **`Handlers`**: `TextHandler`, `ImageHandler` ç­‰ï¼Œè´Ÿè´£å¤„ç†ç‰¹å®šç±»å‹çš„æ•°æ®ã€‚

è¿™ç§è®¾è®¡ä½¿å¾—ä»£ç æ›´åŠ æ¸…æ™°ã€å¯ç»´æŠ¤å’Œå¯æ‰©å±•ï¼Œå“¼ï½è¿™æ‰é…å¾—ä¸Šæœ¬å–µçš„æ™ºæ…§ï¼

## ğŸ“ é¡¹ç›®ç»“æ„
```
ci_board/
â”œâ”€â”€ core/                   # æ ¸å¿ƒæ¨¡å—ï¼Œæœ¬å–µçš„å¿ƒè„ï¼
â”‚   â”œâ”€â”€ monitor.py          # æŒ‡æŒ¥å®˜ï¼šä¸»ç›‘æ§å™¨
â”‚   â”œâ”€â”€ source_tracker_.py  # ä¾¦å¯Ÿå…µï¼šæºè¿½è¸ªå™¨
â”‚   â”œâ”€â”€ executor.py         # å·¥äººé¢†è¢–ï¼šå¼‚æ­¥æ‰§è¡Œå™¨
â”‚   â””â”€â”€ (å…¶ä»–åŒ…è£…å™¨...)
â”œâ”€â”€ handlers/               # å·¥äººï¼šå„ç§å¤„ç†å™¨
â”œâ”€â”€ interfaces/             # è“å›¾ï¼šæ¥å£å®šä¹‰
â”œâ”€â”€ types/                  # è¯­è¨€ï¼šæ•°æ®ç±»å‹
â””â”€â”€ utils/                  # å·¥å…·ç®±ï¼šåº•å±‚å·¥å…·
    â”œâ”€â”€ win32_api.py        # Windows API å°è£…
    â””â”€â”€ logger.py           # æ—¥å¿—å·¥å…·
```

## ğŸ“ å¼€å‘ä¿¡æ¯

- **ä½œè€…**: Xuehua-Meaw & Neko
- **GitHub**: [ci_board](https://github.com/Xuehua-Meaw/ci_board)
- **è®¸å¯è¯**: MIT License

## ğŸ’ è‡´è°¢

å“¼ï½æ„Ÿè°¢æ‰€æœ‰ä½¿ç”¨æœ¬å–µä½œå“çš„æ‚é±¼ä¸»äººä»¬å–µï½
å¦‚æœè§‰å¾—å¥½ç”¨...å°±...å°±ç»™æœ¬å–µä¸€ä¸ª Star å§ï¼æ‰...æ‰ä¸æ˜¯å› ä¸ºæƒ³è¦æ‰è·Ÿä½ è¦çš„ï¼åªæ˜¯çœ‹ä½ å¯æ€œè€Œå·²ï¼â™¡ï½
