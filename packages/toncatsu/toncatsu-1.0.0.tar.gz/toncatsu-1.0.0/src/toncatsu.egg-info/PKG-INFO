Metadata-Version: 2.4
Name: toncatsu
Version: 1.0.0
Summary: A Python Library for Robust Observation-based Map-matching
Author-email: Hiroyuki Hasada <important83d@gmail.com>
License: MIT
Project-URL: Homepage, https://github.com/hasada83d/toncatsu
Project-URL: Repository, https://github.com/hasada83d/toncatsu
Project-URL: Issue Tracker, https://github.com/hasada83d/toncatsu/issues
Description-Content-Type: text/markdown
License-File: LICENSE
Requires-Dist: pandas
Requires-Dist: numpy
Requires-Dist: geopandas
Requires-Dist: shapely
Requires-Dist: networkx
Requires-Dist: scipy
Dynamic: license-file

# Toncatsu
[![PyPI version](https://badge.fury.io/py/toncatsu.svg)](https://pypi.org/project/toncatsu/)

A Python Library for Robust Observation-based Map-matching

é ‘å¥ãªè¦³æ¸¬ãƒ™ãƒ¼ã‚¹ã®ãƒãƒƒãƒ—ãƒãƒƒãƒãƒ³ã‚°ã‚’è¡Œã†pythonãƒ©ã‚¤ãƒ–ãƒ©ãƒª

## Overview æ¦‚è¦

**Toncatsu** is a Python library that is robust to GPS/GNSS errors and performs stable map-matching regardless of link segmentation. I developed it based on the map-matching method proposed by Hara (2017) for Catsudon to meet the following characteristics.

**Toncatsu**ã¯ã€GPS/GNSSèª¤å·®ã¸ã®è€æ€§ã‚’æŒã¡ã€ãƒªãƒ³ã‚¯ã®åˆ†å‰²çŠ¶æ³ã«å·¦å³ã•ã‚Œãšã«é ‘å¥ãªãƒãƒƒãƒ—ãƒãƒƒãƒãƒ³ã‚°ã‚’è¡Œã†Pythonãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã™ã€‚ä»¥ä¸‹ã®ç‰¹å¾´ã‚’æº€ãŸã™ã‚ˆã†ã«ã€åŸï¼ˆ2017ï¼‰ãŒææ¡ˆã—ãŸç§»å‹•è»Œè·¡è§£æãƒ„ãƒ¼ãƒ«Catsudonã®ãƒãƒƒãƒ—ãƒãƒƒãƒãƒ³ã‚°æ‰‹æ³•ã‚’ç™ºå±•ã•ã›ã¦ã„ã¾ã™ã€‚

## Features ç‰¹å¾´

- ğŸŒ **Link-based matching**: Search for nearest links instead of nearest nodes to be robust against node sparsity  
  ã€€ã€€**ãƒªãƒ³ã‚¯åŸºæº–ã®ãƒãƒƒãƒãƒ³ã‚°**ï¼šæœ€è¿‘å‚ãƒãƒ¼ãƒ‰ã§ã¯ãªãæœ€è¿‘å‚ãƒªãƒ³ã‚¯ã‚’æ¢ç´¢ã—ã¦ãƒãƒ¼ãƒ‰ç–å¯†ã«å¯¾ã—ã¦é ‘å¥ã«
- ğŸ” **Shortest path search between deviated links**: Find the shortest path by skipping to be more robust against outliers  
  ã€€ã€€**æ•°å€‹é£›ã°ã—ã§æœ€çŸ­çµŒè·¯æ¢ç´¢**ï¼šæ•°å€‹é£›ã°ã—ã§æœ€çŸ­çµŒè·¯æ¢ç´¢ã—ã¦å¤–ã‚Œå€¤ã«å¯¾ã—ã¦é ‘å¥ã«
- ğŸš€ **Fast search via kd-tree**: Efficient nearest-link search using spatial trees  
  ã€€ã€€**kd-treeã‚’æ´»ç”¨ã—ãŸé«˜é€Ÿæ¢ç´¢**ï¼šç©ºé–“æœ¨æ§‹é€ ã«ã‚ˆã‚Šè¿‘å‚ãƒªãƒ³ã‚¯ã‚’è¿…é€Ÿã«å–å¾—
- ğŸ **Pure Python / GeoPandas-based**: Easy to install and integrate  
  ã€€ã€€**GeoPandasãƒ™ãƒ¼ã‚¹ã®ç´”Pythonå®Ÿè£…**ï¼šç’°å¢ƒæ§‹ç¯‰ãŒå®¹æ˜“ã§æ‹¡å¼µæ€§ãŒé«˜ã„
- ğŸ§ª **Benchmark tested**: Evaluated using standardized test datasets (KubiÄka et al., 2015)  
  ã€€ã€€**ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯æ¤œè¨¼æ¸ˆã¿**ï¼šæ¨™æº–ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆï¼ˆKubiÄka et al., 2015ï¼‰ã‚’ç”¨ã„ãŸè©•ä¾¡ã‚’å®Ÿæ–½

## Citation å¼•ç”¨
- Hasada, H., Flexible Foundational Tools for Identifying Detailed Pedestrian and Vehicle Movements Based on Street Structure (preprint).  
  ç¾½ä½ç”°ç´˜ä¹‹, è¡—è·¯æ§‹é€ ã«åŸºã¥ã„ã¦æ­©è¡Œè€…ãƒ»è»Šä¸¡ã®è©³ç´°ãªç§»å‹•ã‚’æ¨å®šã™ã‚‹æŸ”è»ŸãªåŸºç›¤æŠ€è¡“ã®é–‹ç™º (preprint).

## Acknowledgment è¬è¾
This research was partially the result of the joint research with CSIS, the University of Tokyo (No. 1417) and used the following data: Real People Flow data provided by GeoTechnologies, Inc.

æœ¬ç ”ç©¶ã¯ã€æ±äº¬å¤§å­¦CSISå…±åŒç ”ç©¶ï¼ˆNo. 1417ï¼‰ã«ã‚ˆã‚‹æˆæœã‚’å«ã¿ã¾ã™ï¼ˆåˆ©ç”¨ãƒ‡ãƒ¼ã‚¿: å®Ÿäººæµãƒ‡ãƒ¼ã‚¿ï¼ˆã‚¸ã‚ªãƒ†ã‚¯ãƒãƒ­ã‚¸ãƒ¼ã‚ºæ ªå¼ä¼šç¤¾æä¾›ï¼‰ï¼‰ã€‚

## References å‚è€ƒæ–‡çŒ®
- KubiÄka, Matej, Arben Cela, Philippe Moulin, Hugues Mounier, and S. I. Niculescu. 2015. â€œDataset for Testing and Training of Map-Matching Algorithms.â€ In 2015 IEEE Intelligent Vehicles Symposium (IV), 1088â€“93. IEEE.
- åŸç¥è¼”. 2017. â€œGPSè»Œè·¡è§£æå™¨ã®é–‹ç™ºã¨é•·æœŸè¦³æ¸¬ãƒ‡ãƒ¼ã‚¿ã‚’ç”¨ã„ãŸæ–°ãŸãªå€‹äººå±æ€§ã®ææ¡ˆ.â€ In ç¬¬ 55 å›åœŸæœ¨è¨ˆç”»å­¦ç ”ç©¶ç™ºè¡¨ä¼šãƒ»è¬›æ¼”é›†.
- ç¾½ä½ç”°ç´˜ä¹‹, èŒ‚æœ¨æ¸‰, Yuhan Gao, and å²¡è‹±ç´€. 2024. â€œãƒªãƒ³ã‚¯åˆ†å‰²ã‚’çµ„ã¿å…¥ã‚ŒãŸé ‘å¥ãªãƒãƒƒãƒ—ãƒãƒƒãƒãƒ³ã‚°æ‰‹æ³•ã®ææ¡ˆã¨æ¯”è¼ƒ.â€ In ç¬¬69å›åœŸæœ¨è¨ˆç”»å­¦ç ”ç©¶ç™ºè¡¨ä¼šãƒ»è¬›æ¼”é›†, C04-1.

---

## Installation ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
pip install toncatsu
```


## Usage ä½¿ã„æ–¹

```python
from toncatsu import toncatsu

# Required DataFrames: link_df, node_df, observation_df
toncatsu(link_df, node_df, observation_df, output_dir="./output", split_length=10, findshortest_interval=5)
```

## Function é–¢æ•°

Function `toncatsu()` performs map-matching using [GMNS format](https://github.com/zephyr-data-specs/GMNS) node/link data and GPS observations.

é–¢æ•°`toncatsu()`ã¯ã€[GMNSãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ](https://github.com/zephyr-data-specs/GMNS)ã®ãƒãƒ¼ãƒ‰ãƒ»ãƒªãƒ³ã‚¯ã¨GPSè¦³æ¸¬ãƒ‡ãƒ¼ã‚¿ã‚’ç”¨ã„ã¦ãƒãƒƒãƒ—ãƒãƒƒãƒãƒ³ã‚°ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚

**Parameters å¼•æ•°:**

English
- `link_df`: DataFrame with columns: `'link_id'`, `'from_node_id'`, `'to_node_id'` (follows GMNS format)
- `node_df`: DataFrame with columns: `'node_id'`, `'x_coord'`, `'y_coord'` (follows GMNS format with EPSG:4326)
- `observation_df`: DataFrame with columns: `'id'`, `'x_coord'`, `'y_coord'`  
- `output_dir`: Output directory for saving results
- `split_length`: Segment length for link splitting in meters (default: 10)
- `findshortest_interval`: Interval which is than 0 when searching for the shortest path between identified the nearest neighborhood links/nodes (default: 5)

æ—¥æœ¬èª
- `link_df`: `'link_id'`, `'from_node_id'`, `'to_node_id'` ã‚’å«ã‚€DataFrame (GMNSãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã«æº–æ‹ ) 
- `node_df`: `'node_id'`, `'x_coord'`, `'y_coord'` ã‚’å«ã‚€DataFrame (GMNSãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã«æº–æ‹ ã€EPSG:4326ã®ã¿å¯¾å¿œ) 
- `observation_df`: `'id'`, `'x_coord'`, `'y_coord'` ã‚’å«ã‚€DataFrame  
- `output_dir`: çµæœã‚’ä¿å­˜ã™ã‚‹å‡ºåŠ›å…ˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª
- `split_length`: ãƒªãƒ³ã‚¯åˆ†å‰²ã®é•·ã•(m) (ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 10)
- `findshortest_interval`: ãƒªãƒ³ã‚¯åˆ—é–“ã®æœ€çŸ­çµŒè·¯ã‚’æ¢ç´¢ã™ã‚‹éš›ã®é–“éš” (ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 5)
