import{g as Se,p as Je,h as Qe,aj as Ze,B as b,H as xe,I as et,ak as tt,N as at,aP as lt,aL as it,Q as J,R as c,S as n,D as ne,a0 as f,aX as E,a4 as oe,br as _e,x as C,c as U,bJ as K,as as Y,U as m,a9 as p,Z as w,V as ot,bI as Be,bB as se,ao as S,ab as v,am as j,aa as st,a5 as T,an as L,W as R,aq as nt,b6 as W,bK as rt,b7 as ut,bL as $e,bC as Ae,bF as Ce,bM as re,bN as Te,aI as mt,aH as dt,a7 as ct,bg as pt,bt as ft,bu as X,X as vt,a2 as B,ar as yt,bx as ht,d as bt,b as le,w as G,o as kt,P as ye,bO as wt,aV as z,Y as gt,bn as It,G as he,$ as be,bq as ie,bE as St,bp as ke}from"./index-C8Wvo59W.js";import{M as Fe}from"./MediaItemThumb-DDMb_9k9.js";import{L as _t}from"./ListItem-BDnoqXe8.js";import{B as Ve}from"./Button-C6-W0Jei.js";import{V as De}from"./VCheckbox-aZKtlmJa.js";import{a as q}from"./VBtn-DmOE8ObX.js";import{_ as ue}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as Bt,P as $t}from"./PanelviewItemCompact-sXEe4fxv.js";import{V as At}from"./VSpacer-CRNj-rDk.js";import{C as Ct}from"./Container-D43lS1qQ.js";import{T as Tt}from"./Toolbar-Bk_KlFQ2.js";import{V as Ft}from"./VTextField-h2jTOaQT.js";import{a as Vt,V as Dt}from"./VInfiniteScroll-DzhHULOU.js";import{V as we,a as ge}from"./VRow-DV7BqAoZ.js";import{V as Ot}from"./VVirtualScroll-ZleTOGra.js";import{V as Ie}from"./VAlert-DjHMaeFy.js";const Oe=Symbol.for("vuetify:v-item-group"),Lt=Je({...at(),...tt({selectedClass:"v-item--selected"}),...et(),...xe()},"VItemGroup"),Le=Se()({name:"VItemGroup",props:Lt(),emits:{"update:modelValue":$=>!0},setup($,l){let{slots:h}=l;const{themeClasses:g}=Qe($),{isSelected:i,select:k,next:A,prev:F,selected:a}=Ze($,Oe);return()=>b($.tag,{class:["v-item-group",g.value,$.class],style:$.style},{default:()=>{var _;return[(_=h.default)==null?void 0:_.call(h,{isSelected:i,select:k,next:A,prev:F,selected:a.value})]}})}}),P=Se()({name:"VItem",props:lt(),emits:{"group:selected":$=>!0},setup($,l){let{slots:h}=l;const{isSelected:g,select:i,toggle:k,selectedClass:A,value:F,disabled:a}=it($,Oe);return()=>{var _;return(_=h.default)==null?void 0:_.call(h,{isSelected:g.value,selectedClass:A.value,select:i,toggle:k,value:F.value,disabled:a.value})}}}),Pe=J({__name:"FavoriteButton",props:{item:{}},setup($){const l=$;return(h,g)=>{var i;return n(),c(Ve,ne(l,{variant:"list",icon:(i=h.item)!=null&&i.favorite?"mdi-heart":"mdi-heart-outline",title:h.$t("tooltip.favorite"),onClick:[g[0]||(g[0]=k=>f(oe).toggleFavorite(h.item)),g[1]||(g[1]=E(()=>{},["prevent"])),g[2]||(g[2]=E(()=>{},["stop"]))]}),null,16,["icon","title"])}}}),Pt={key:0,class:"media-thumb listitem-media-thumb"},Mt={key:1,class:"media-thumb listitem-media-thumb"},Et={key:0},Rt={key:1},Kt={key:0},Nt={key:0,class:"line-clamp-1"},Yt={key:1},Xt={key:0},zt={key:1},Ht={key:2},Gt={key:3},Ut={key:4},jt={key:5},Wt={key:6},qt={key:7},Jt={key:4},Qt={key:5},Zt={class:"text-caption",style:{"padding-right":"10px","padding-left":"10px"}},xt=J({__name:"ListviewItem",props:{item:{},showTrackNumber:{type:Boolean,default:!0},showDiscNumber:{type:Boolean,default:!0},showPosition:{type:Boolean,default:!0},showProvider:{type:Boolean,default:!0},showAlbum:{type:Boolean,default:!0},showMenu:{type:Boolean,default:!0},showFavorite:{type:Boolean,default:!1},showDuration:{type:Boolean,default:!0},isSelected:{type:Boolean},isDisabled:{type:Boolean,default:!1},isAvailable:{type:Boolean,default:!0},showCheckboxes:{type:Boolean,default:!1},showDetails:{type:Boolean},parentItem:{default:void 0}},emits:["select"],setup($,{emit:l}){const{t:h}=_e(),g=C(!1),i=$,k=U(()=>{if(!("provider_mappings"in i.item))return"";for(const e of i.item.provider_mappings)if(e.audio_format&&e.audio_format.content_type!=null&&[K.DSF,K.FLAC,K.AIFF,K.WAV].includes(e.audio_format.content_type)&&(e.audio_format.sample_rate>48e3||e.audio_format.bit_depth>16))return`${e.audio_format.sample_rate/1e3}kHz ${e.audio_format.bit_depth} bits`;return""}),A=l,F=function(e){const y="clientX"in e?e.clientX:e.touches[0].clientX,I="clientY"in e?e.clientY:e.touches[0].clientY;re(i.item,y,I,i.parentItem)},a=function(e){i.showCheckboxes||Te(i.item,e.clientX,e.clientY,i.parentItem)},_=function(e){i.showCheckboxes||Ce(i.item,e.clientX,e.clientY,i.parentItem)};return(e,y)=>(n(),c(_t,{link:"","show-menu-btn":e.showMenu,class:Y({unavailable:!e.isAvailable}),onClick:E(a,["stop"]),onMenu:E(F,["stop"])},{prepend:m(()=>[e.showCheckboxes?(n(),w("div",Pt,[b(De,{"model-value":e.isSelected,onClick:y[0]||(y[0]=E(()=>{},["stop"])),"onUpdate:modelValue":y[1]||(y[1]=I=>{I!=null&&A("select",e.item,I)})},null,8,["model-value"])])):(n(),w("div",Mt,[b(Fe,{size:"50",item:e.isAvailable?e.item:void 0,class:Y({dimmed:g.value})},null,8,["item","class"])])),!e.showCheckboxes&&e.item.is_playable?(n(),c(q,{key:2,class:Y({hidden:!g.value}),icon:"mdi-play",color:"primary",fab:"",size:"small",style:{position:"absolute",left:"12px",bottom:"12px"},onClick:E(_,["stop"]),onMouseenter:y[2]||(y[2]=I=>g.value=!0),onMouseleave:y[3]||(y[3]=I=>g.value=!1)},null,8,["class"])):p("",!0)]),title:m(()=>[e.item.media_type==f(T).FOLDER?(n(),w("span",Et,[R("span",null,v(f($e)(e.item,f(h))),1)])):(n(),w("span",Rt,[S(v(e.item.name)+" ",1),"version"in e.item&&e.item.version?(n(),w("span",Kt,"("+v(e.item.version)+")",1)):p("",!0)])),e.item&&e.item.metadata?(n(),c(f(se),{key:2,location:"bottom"},{activator:m(({props:I})=>[f(Ae)(e.item.metadata.explicit||!1)?(n(),c(L,ne({key:0},I,{icon:"mdi-alpha-e-box",width:"35"}),null,16)):p("",!0)]),default:m(()=>[R("span",null,v(e.$t("tooltip.explicit")),1)]),_:1})):p("",!0)]),subtitle:m(()=>{var I;return[e.item.media_type==f(T).TRACK&&"provider_mappings"in e.item?(n(),w("div",Nt,[b(Le,null,{default:m(()=>["artists"in e.item?(n(),c(P,{key:0},{default:m(()=>[S(v(f(W)(e.item.artists,2)),1)]),_:1})):p("",!0),e.showAlbum&&"album"in e.item&&e.item.album?(n(),c(P,{key:1},{default:m(()=>[S(" • "+v(e.item.album.name),1)]),_:1})):p("",!0),e.showDiscNumber&&"disc_number"in e.item&&e.item.disc_number?(n(),c(P,{key:2},{default:m(()=>[b(L,{style:{"margin-left":"5px"},icon:"md:album"}),S(" "+v(e.item.disc_number),1)]),_:1})):p("",!0),e.showTrackNumber&&"track_number"in e.item&&e.item.track_number?(n(),c(P,{key:3},{default:m(()=>[b(L,{style:{"margin-left":"5px"},icon:"mdi-music-circle-outline"}),S(" "+v(e.item.track_number),1)]),_:1})):e.showPosition&&"position"in e.item&&e.item.position?(n(),c(P,{key:4},{default:m(()=>[b(L,{style:{"margin-left":"5px"},icon:"mdi-music-circle-outline"}),S(" "+v(e.item.position),1)]),_:1})):p("",!0)]),_:1})])):e.item.media_type==f(T).ALBUM&&"year"in e.item?(n(),w("div",Yt,[e.item.album_type!=f(rt).UNKNOWN?(n(),w("span",Xt,v(e.$t("album_type."+e.item.album_type))+" • ",1)):p("",!0),R("span",null,v(f(W)(e.item.artists)),1),e.item.year?(n(),w("span",zt," • "+v(e.item.year),1)):p("",!0)])):"artists"in e.item&&e.item.artists?(n(),w("div",Ht,v(f(W)(e.item.artists)),1)):"owner"in e.item&&e.item.owner?(n(),w("div",Gt,v(e.item.owner),1)):"authors"in e.item&&e.item.authors?(n(),w("div",Ut,v(e.item.authors.join(" / ")),1)):"publisher"in e.item&&e.item.publisher?(n(),w("div",jt,v(e.item.publisher),1)):"metadata"in e.item&&((I=e.item.metadata)!=null&&I.description)&&[f(T).RADIO,f(T).PLAYLIST,f(T).FOLDER].includes(e.item.media_type)?(n(),w("div",Wt,v(f(ut)(e.item.metadata.description,150)),1)):"media_type"in e.item&&!e.item.provider_mappings?(n(),w("div",qt,v(e.$t(e.item.media_type)),1)):p("",!0)]}),append:m(()=>[k.value?(n(),c(ot,{key:0,src:f(Be),width:"30",class:Y(e.$vuetify.theme.current.dark?"hiresicondark":"hiresicon")},{default:m(()=>[b(f(se),{activator:"parent",location:"bottom"},{default:m(()=>[S(v(k.value),1)]),_:1})]),_:1},8,["src","class"])):p("",!0),f(j)("bp2")&&e.showProvider?(n(),c(st,{key:1,domain:e.item.media_type==f(T).PLAYLIST?e.item.provider_mappings[0].provider_domain:e.item.provider,size:24},null,8,["domain"])):p("",!0),"fully_played"in e.item&&e.item.fully_played?(n(),c(L,{key:2,title:e.$t("item_fully_played")},{default:m(()=>y[4]||(y[4]=[S("mdi-check")])),_:1,__:[4]},8,["title"])):"resume_position_ms"in e.item&&e.item.resume_position_ms?(n(),c(L,{key:3,title:e.$t("item_in_progress")},{default:m(()=>y[5]||(y[5]=[S("mdi-clock-fast")])),_:1,__:[5]},8,["title"])):p("",!0),f(j)("bp3")&&"favorite"in e.item&&e.showFavorite&&!e.$vuetify.display.mobile?(n(),w("div",Jt,[b(Pe,{item:e.item},null,8,["item"])])):p("",!0),e.showDuration&&"duration"in e.item&&e.item.duration&&f(j)("bp0")?(n(),w("div",Qt,[R("div",null,[R("span",Zt,v(f(nt)(e.item.duration)),1)])])):p("",!0)]),_:1},8,["show-menu-btn","class"]))}}),ea=ue(xt,[["__scopeId","data-v-fde2a7b4"]]),ta={key:0},aa={key:1},la={key:2},ia=["src"],oa={key:0},sa=J({__name:"PanelviewItem",props:{item:{},size:{default:200},isSelected:{type:Boolean},showCheckboxes:{type:Boolean,default:!1},showMediaType:{type:Boolean,default:!1},showActions:{type:Boolean,default:!1},showTrackNumber:{type:Boolean,default:!1},isAvailable:{type:Boolean,default:!0},parentItem:{default:void 0}},emits:["select"],setup($,{emit:l}){const h=$,g=U(()=>{for(const a of h.item.provider_mappings)if(a.audio_format&&a.audio_format.content_type!=null&&[K.DSF,K.FLAC,K.AIFF,K.WAV].includes(a.audio_format.content_type)&&(a.audio_format.sample_rate>48e3||a.audio_format.bit_depth>16))return`${a.audio_format.sample_rate/1e3}kHz ${a.audio_format.bit_depth} bits`;return""}),i=l,k=function(a){if(h.showCheckboxes)return;const _="clientX"in a?a.clientX:a.touches[0].clientX,e="clientY"in a?a.clientY:a.touches[0].clientY;re(h.item,_,e,h.parentItem)},A=function(a){if(h.showCheckboxes){i("select",h.item,!h.isSelected);return}Te(h.item,a.clientX,a.clientY,h.parentItem)},F=function(a){h.showCheckboxes||Ce(h.item,a.clientX,a.clientY,h.parentItem)};return(a,_)=>{const e=mt("hold");return n(),c(Bt,null,{default:m(({isHovering:y,props:I})=>[dt((n(),c(ct,ne(I,{tile:"",hover:"",class:["panel-item",{unavailable:!a.isAvailable}],onClick:A,onContextmenu:E(k,["right","prevent"])}),{default:m(()=>[a.showCheckboxes?(n(),c(pt,{key:0,"model-value":a.showCheckboxes,contained:"",scrim:a.isSelected?a.$vuetify.theme.current.dark?"rgba(0,0,0,.75)":"rgba(255,255,255,.75)":"#ffffff00"},{default:m(()=>[b(De,{class:"panel-item-checkbox",ripple:!1,"model-value":a.isSelected},null,8,["model-value"])]),_:1},8,["model-value","scrim"])):p("",!0),b(Fe,{item:a.isAvailable?a.item:void 0,style:{height:"auto"}},null,8,["item"]),b(vt,{variant:"text",slim:"",tile:"",density:"compact",class:"panel-item-details"},{default:m(()=>[b(ft,null,{default:m(()=>[a.item.media_type==f(T).FOLDER?(n(),w("span",ta,[R("span",null,v(f($e)(a.item,a.$t)),1)])):(n(),w("span",aa,v(a.item.name),1)),"version"in a.item&&a.item.version?(n(),w("span",la," - "+v(a.item.version),1)):p("",!0)]),_:1}),"artists"in a.item&&a.item.artists?(n(),c(X,{key:0,class:"line-clamp-1"},{default:m(()=>[S(v(f(W)(a.item.artists,1)),1)]),_:1})):p("",!0),"authors"in a.item&&a.item.authors?(n(),c(X,{key:1,class:"line-clamp-1"},{default:m(()=>[S(v(a.item.authors.join(" / ")),1)]),_:1})):"publisher"in a.item&&a.item.publisher?(n(),c(X,{key:2,class:"line-clamp-1"},{default:m(()=>[S(v(a.item.publisher),1)]),_:1})):"owner"in a.item&&a.item.owner?(n(),c(X,{key:3,class:"line-clamp-1"},{default:m(()=>[S(v(a.item.owner),1)]),_:1})):a.showMediaType?(n(),c(X,{key:4,class:"line-clamp-1"},{default:m(()=>[S(v(a.$t(a.item.media_type)),1)]),_:1})):(n(),c(X,{key:5,class:"line-clamp-1"}))]),_:1}),(y||f(B).isTouchscreen)&&a.isAvailable&&a.item.is_playable?(n(),c(q,{key:1,icon:"mdi-play",color:"primary",fab:"",style:yt(`position: absolute; right: 15px; bottom: ${a.showActions?90:35}px; opacity: 0.8`),onClick:E(F,["stop"])},null,8,["style"])):p("",!0),a.showActions?(n(),c(ht,{key:2,class:"panel-item-actions"},{default:m(()=>[b(Le,{style:{padding:"0"}},{default:m(()=>[f(Ae)(a.item.metadata.explicit||!1)?(n(),c(P,{key:0},{default:m(()=>[b(L,{size:"30",icon:"mdi-alpha-e-box"})]),_:1})):p("",!0),g.value?(n(),c(P,{key:1},{default:m(()=>[b(L,{class:Y(a.$vuetify.theme.current.dark?"hiresicon":"hiresiconinverted")},{default:m(()=>[R("img",{src:f(Be),width:"30"},null,8,ia),b(se,{activator:"parent",location:"bottom"},{default:m(()=>[S(v(g.value),1)]),_:1})]),_:1},8,["class"])]),_:1})):p("",!0),a.showTrackNumber&&"track_number"in a.item&&a.item.track_number?(n(),c(P,{key:2},{default:m(()=>[b(L,{size:"small",icon:"mdi-music-circle-outline"}),a.item.disc_number?(n(),w("span",oa,v(a.item.disc_number)+"/",1)):p("",!0),S(v(a.item.track_number),1)]),_:1})):"position"in a.item&&a.item.position?(n(),c(P,{key:3},{default:m(()=>[b(L,{size:"small",icon:"mdi-music-circle-outline"}),S(" "+v(a.item.position),1)]),_:1})):p("",!0),f(j)("bp3")?(n(),c(P,{key:4},{default:m(()=>[b(Pe,{item:a.item},null,8,["item"])]),_:1})):p("",!0)]),_:1}),b(At),y||a.$vuetify.display.mobile?(n(),c(Ve,{key:0,variant:"list",icon:"mdi-dots-vertical",style:{"padding-right":"0","margin-right":"-5px"},onClick:E(k,["stop"])})):p("",!0)]),_:2},1024)):p("",!0)]),_:2},1040,["class"])),[[e,k]])]),_:1})}}}),na=ue(sa,[["__scopeId","data-v-11f312dc"]]),ra={key:0},ua={key:2},ma=J({__name:"ItemsListing",props:{itemtype:{},sortKeys:{default:()=>["name","sort_name"]},showTrackNumber:{type:Boolean,default:!0},showProvider:{type:Boolean,default:Object.keys(oe.providers).length>1},showAlbum:{type:Boolean,default:!0},showFavoritesOnlyFilter:{type:Boolean,default:!0},showDuration:{type:Boolean,default:!0},parentItem:{default:void 0},showAlbumArtistsOnlyFilter:{type:Boolean},showSearchButton:{type:Boolean,default:void 0},showRefreshButton:{type:Boolean,default:void 0},showSelectButton:{type:Boolean,default:void 0},showAlbumTypeFilter:{type:Boolean,default:void 0},updateAvailable:{type:Boolean},title:{default:void 0},hideOnEmpty:{type:Boolean,default:!1},showLibraryOnlyFilter:{type:Boolean,default:!1},allowCollapse:{type:Boolean,default:!1},allowKeyHooks:{type:Boolean,default:!1},extraMenuItems:{default:void 0},loadPagedData:{type:Function,default:void 0},loadItems:{type:Function,default:void 0},limit:{default:50},total:{default:void 0},infiniteScroll:{type:Boolean,default:!0},path:{default:void 0},icon:{default:void 0},restoreState:{type:Boolean,default:!1}},setup($){const l=$,h=St(),{t:g}=_e(),i=C({offset:0,limit:50,sortBy:"name",search:"",libraryOnly:!1}),k=C("list"),A=C(!1),F=C(!1),a=C([]),_=C([]),e=C(!1),y=C([]),I=C(!1),O=C(!1),N=C(!0),M=C(!1),H=C(!1),Q=C(!1),me=function(){i.value.search="",A.value=!1},Z=function(){ye(()=>{var t;(t=document.getElementById("searchInput"))==null||t.focus()})},Me=function(){A.value?me():(A.value=!0,Z())},x=function(){N.value=!N.value;const t=`${l.path}.${l.itemtype}`;localStorage.setItem(`expand.${t}`,N.value.toString())},ee=function(t){k.value=t;const s=`${l.path}.${l.itemtype}`;localStorage.setItem(`viewMode.${s}`,t)},Ee=function(){i.value.favoritesOnly=!i.value.favoritesOnly;const t=i.value.favoritesOnly?"true":"false",s=`${l.path}.${l.itemtype}`;localStorage.setItem(`favoriteFilter.${s}`,t),D(void 0,void 0,!0)},Re=function(){i.value.libraryOnly=!i.value.libraryOnly;const t=i.value.libraryOnly?"true":"false",s=`${l.path}.${l.itemtype}`;localStorage.setItem(`libraryFilter.${s}`,t),D(!0,void 0,!0)},Ke=function(){i.value.albumArtistsFilter=!i.value.albumArtistsFilter;const t=i.value.albumArtistsFilter?"true":"false",s=`${l.path}.${l.itemtype}`;localStorage.setItem(`albumArtistsFilter.${s}`,t),D(void 0,void 0,!0)},te=function(t){return y.value.includes(t)},ae=function(t,s){if(s)y.value.includes(t)||y.value.push(t);else for(let o=0;o<y.value.length;o++)y.value[o]===t&&y.value.splice(o,1)},Ne=function(){O.value&&(y.value=[]),O.value=!O.value},Ye=function(){D(!0,!0)},Xe=function(){i.value.search="",A.value=!1,D(void 0,void 0,!0)},ze=function(t){t!==void 0&&(i.value.sortBy=t);const s=`${l.path}.${l.itemtype}`;localStorage.setItem(`sortBy.${s}`,i.value.sortBy),D(void 0,void 0,!0)},He=function(t){var o,d;(o=i.value.albumType)!=null&&o.includes(t)?i.value.albumType=(d=i.value.albumType)==null?void 0:d.filter(r=>r!==t):(i.value.albumType=i.value.albumType||[],i.value.albumType.push(t));const s=`${l.path}.${l.itemtype}`;localStorage.setItem(`albumType.${s}`,i.value.albumType.join(",")),D(void 0,void 0,!0)},Ge=function(){B.globalSearchTerm=i.value.search,l.itemtype=="artists"?B.globalSearchType=T.ARTIST:l.itemtype=="albums"?B.globalSearchType=T.ALBUM:l.itemtype=="tracks"?B.globalSearchType=T.TRACK:l.itemtype=="playlists"?B.globalSearchType=T.PLAYLIST:l.itemtype=="audiobooks"?B.globalSearchType=T.AUDIOBOOK:l.itemtype=="podcasts"?B.globalSearchType=T.PODCAST:l.itemtype=="radios"&&(B.globalSearchType=T.RADIO),h.push({name:"search"})},de=async function({done:t}){if(M.value){t("empty");return}await D(void 0,void 0,void 0,i.value.offset+l.limit),t("ok")},Ue=async function(){for(;!M.value;)await de({done:function(){}})},ce=U(()=>{var t=!1;return i.value.search&&i.value.search.length!==0&&(t=!0),t}),pe=U(()=>A.value&&N.value);bt(()=>{pe.value||(F.value=!1)});const je=U(()=>{var s,o;if(l.allowCollapse===!0&&!N.value)return[{label:"tooltip.collapse_expand",icon:"mdi-chevron-down",action:x,overflowAllowed:!1}];const t=[];return l.showSelectButton!==!1&&(O.value&&t.push({label:"tooltip.select_all",icon:"mdi-select-all",action:ve}),t.push({label:"tooltip.select_items",icon:O.value?"mdi-checkbox-multiple-outline":"mdi-checkbox-multiple-blank-outline",action:Ne,active:O.value})),l.showLibraryOnlyFilter===!0&&t.push({label:"tooltip.filter_library",icon:"mdi-bookshelf",action:Re,active:i.value.libraryOnly}),l.showFavoritesOnlyFilter===!0&&t.push({label:"tooltip.filter_favorites",icon:i.value.favoritesOnly?"mdi-heart":"mdi-heart-outline",action:Ee,active:i.value.favoritesOnly}),l.showAlbumArtistsOnlyFilter===!0&&t.push({label:"tooltip.album_artist_filter",icon:i.value.albumArtistsFilter?"mdi-account-music":"mdi-account-music-outline",action:Ke,active:i.value.albumArtistsFilter}),l.showAlbumTypeFilter&&t.push({label:"tooltip.album_type",icon:"mdi-album",disabled:e.value,subItems:["album","single","ep","compilation","unknown"].map(d=>{var r;return{label:`album_type.${d}`,selected:(r=i.value.albumType)==null?void 0:r.includes(d),action:()=>{He(d)}}})}),(l.showRefreshButton!==!1||I.value)&&t.push({label:I.value?"tooltip.refresh_new_content":"tooltip.refresh",icon:"mdi-refresh",action:Ye,active:I.value,disabled:e.value}),(s=l.sortKeys)!=null&&s.length&&t.push({label:"tooltip.sort_options",icon:"mdi-sort",disabled:l.sortKeys.length<=1||e.value,subItems:l.sortKeys.map(d=>({label:`sort.${d}`,selected:i.value.sortBy==d,action:()=>{ze(d)}}))}),l.showSearchButton!==!1&&t.push({label:ce.value?"tooltip.search_filter_active":"tooltip.search",icon:"mdi-magnify",action:Me,active:ce.value,disabled:e.value}),t.push({label:"tooltip.toggle_view_mode",icon:k.value=="list"?"mdi-view-list":"mdi-grid",subItems:[{label:"view.list",icon:"mdi-view-list",selected:k.value=="list",action:()=>{ee("list")}},{label:"view.panel",icon:"mdi-grid",selected:k.value=="panel",action:()=>{ee("panel")}},{label:"view.panel_compact",icon:"mdi-grid",selected:k.value=="panel_compact",action:()=>{ee("panel_compact")}}]}),(o=l.extraMenuItems)!=null&&o.length&&t.push(...l.extraMenuItems),l.allowCollapse===!0&&t.push({label:"tooltip.collapse_expand",icon:"mdi-chevron-up",action:x}),t}),D=async function(t=!1,s=!1,o=!1,d=0){if(!e.value){if(e.value=!0,o&&l.loadPagedData!=null&&(t=!0),(t||s)&&(d=0,M.value&&(Q.value=!0),M.value=!1,H.value=!1,I.value=!1),i.value.offset=d,i.value.limit=l.limit,i.value.refresh=s,l.loadPagedData!=null){const r=await l.loadPagedData(i.value);i.value.offset?a.value.push(...r):a.value=r,Math.abs(r.length-l.limit)>10&&(M.value=!0)}else if(l.loadItems!=null){(!H.value||s)&&(_.value=await l.loadItems(i.value),H.value=!0);const r=qe(_.value,i.value);i.value.offset?a.value.push(...r):a.value=r,M.value=r.length<l.limit}i.value.refresh=!1,e.value=!1,Q.value=!1}},We=async function(){const t=`${l.path}.${l.itemtype}`,s=localStorage.getItem(`viewMode.${t}`);s&&s!=="null"?k.value=s:l.itemtype=="artists"||l.itemtype=="albums"?k.value="panel":k.value="list";const o=localStorage.getItem(`sortBy.${t}`);if(o&&o!=="null"&&l.sortKeys.includes(o)?i.value.sortBy=o:i.value.sortBy=l.sortKeys[0],l.showFavoritesOnlyFilter!==!1){const d=localStorage.getItem(`favoriteFilter.${t}`);d&&d=="true"&&(i.value.favoritesOnly=!0)}if(l.showLibraryOnlyFilter!==!1){const d=localStorage.getItem(`libraryFilter.${t}`);d&&d=="true"&&(i.value.libraryOnly=!0)}if(l.showAlbumArtistsOnlyFilter!==!1){const d=localStorage.getItem(`albumArtistsFilter.${t}`);d&&(i.value.albumArtistsFilter=d=="true")}if(l.allowCollapse!==!1){const d=localStorage.getItem(`expand.${t}`);d&&(N.value=d=="true")}if(l.showAlbumTypeFilter===!0){const d=localStorage.getItem(`albumType.${t}`);d&&(i.value.albumType=d.split(","))}if(l.restoreState){let d=`search.${t}`;l.parentItem&&(d+=l.parentItem.item_id);const r=localStorage.getItem(d);r&&r!=="null"&&(i.value.search=r)}},fe=function(t){B.dialogActive||e.value||(t.key==="Escape"&&me(),!F.value&&(t.key==="a"&&(t.ctrlKey||t.metaKey)?(t.preventDefault(),ve()):!F.value&&t.key=="Backspace"?Z():!F.value&&t.key.length==1&&(A.value=!0,Z())))};l.allowKeyHooks&&(document.addEventListener("keydown",fe),le(()=>{document.removeEventListener("keydown",fe)})),l.restoreState&&le(()=>{const t=l.path||l.itemtype,s=document.querySelector("#cont");B.prevState={path:t,scrollPos:(s==null?void 0:s.scrollTop)||0,pagedItems:a.value,allItems:_.value,allItemsReceived:M.value,initialDataReceived:H.value,params:i.value}}),G(()=>i.value.search,t=>{t&&(A.value=!0),D(void 0,void 0,!0);let s=`search.${l.path}.${l.itemtype}`;l.parentItem&&(s+=l.parentItem.item_id),localStorage.setItem(s,i.value.search)}),G(()=>l.path,t=>{e.value!=!0&&(a.value=[],_.value=[],D(!0))}),G(()=>l.parentItem,()=>{e.value!=!0&&(_.value=[],I.value=!0)},{deep:!0}),G(()=>l.limit,t=>{i.value.limit=t}),G(()=>l.updateAvailable,t=>{e.value||(I.value=t)},{immediate:!0}),kt(async()=>{var o;We();const t=l.path||l.itemtype;l.restoreState&&((o=B.prevState)==null?void 0:o.path)==t?(i.value=B.prevState.params,a.value=B.prevState.pagedItems,_.value=B.prevState.allItems,M.value=B.prevState.allItemsReceived,H.value=B.prevState.initialDataReceived,ye(()=>{const d=document.getElementById("cont");d&&wt(d,B.prevState.scrollPos,50)}),e.value=!1):D(!0);const s=oe.subscribe_multi([z.MEDIA_ITEM_UPDATED,z.MEDIA_ITEM_DELETED,z.MEDIA_ITEM_PLAYED],d=>{if(d.event==z.MEDIA_ITEM_DELETED)a.value=a.value.filter(r=>r.uri!=d.object_id);else if(d.event==z.MEDIA_ITEM_UPDATED){const r=a.value.findIndex(u=>u.uri==d.object_id);r>=0&&(a.value[r]=d.data)}else if(d.event==z.MEDIA_ITEM_PLAYED){const r=a.value.findIndex(u=>u.uri==d.object_id);r>=0&&("fully_played"in a.value[r]&&(a.value[r].fully_played=d.data.fully_played),"resume_position_ms"in a.value[r]&&(a.value[r].resume_position_ms=d.data.seconds_played*1e3))}});le(s)});const V=function(t,s=!1){return t?"translation_key"in t&&t.translation_key&&t.name?g(t.translation_key,[t.name]):"translation_key"in t&&t.translation_key?g(t.translation_key):s&&"sort_name"in t&&t.sort_name?t.sort_name:t.name:""},qe=function(t,s){var d;let o=[];if(s.search){const r=s.search.toLowerCase();for(const u of t)(u.name.toLowerCase().includes(r)||"album"in u&&((d=u.album)!=null&&d.name.toLowerCase().includes(r))||"artists"in u&&u.artists&&u.artists.length&&u.artists[0].name.toLowerCase().includes(r))&&o.push(u)}else o=[...t];return s.sortBy=="name"&&o.sort((r,u)=>V(r).localeCompare(V(u),void 0,{numeric:!0})),s.sortBy=="sort_name"&&o.sort((r,u)=>V(r,!0).localeCompare(V(u,!0),void 0,{numeric:!0})),s.sortBy=="name_desc"&&o.sort((r,u)=>V(u).localeCompare(V(r),void 0,{numeric:!0})),s.sortBy=="sort_name_desc"&&o.sort((r,u)=>V(u,!0).localeCompare(V(r,!0),void 0,{numeric:!0})),s.sortBy=="album"&&o.sort((r,u)=>V(r.album).localeCompare(V(u.album),void 0,{numeric:!0})),s.sortBy=="artist"&&o.sort((r,u)=>V(r.artists[0]).localeCompare(V(u.artists[0]))),s.sortBy=="track_number"&&(o.sort((r,u)=>(r.track_number||0)-(u.track_number||0)),o.sort((r,u)=>(r.disc_number||0)-(u.disc_number||0))),s.sortBy=="position"&&o.sort((r,u)=>(r.position||0)-(u.position||0)),s.sortBy=="position_desc"&&o.sort((r,u)=>(u.position||0)-(r.position||0)),s.sortBy=="year"&&o.sort((r,u)=>(r.year||0)-(u.year||0)),s.sortBy=="year_desc"&&o.sort((r,u)=>(u.year||0)-(r.year||0)),s.sortBy=="recent"&&o.sort((r,u)=>(u.timestamp_added||0)-(r.timestamp_added||0)),s.sortBy=="duration"&&o.sort((r,u)=>(r.duration||0)-(u.duration||0)),s.sortBy=="duration_desc"&&o.sort((r,u)=>(u.duration||0)-(r.duration||0)),s.sortBy=="provider"&&o.sort((r,u)=>r.provider.localeCompare(u.provider)),s.favoritesOnly&&(o=o.filter(r=>r.favorite)),s.albumType&&s.albumType.length>0&&(o=o.filter(r=>{var u;return(u=s.albumType)==null?void 0:u.includes(r.album_type)})),o.slice(s.offset,s.offset+s.limit)},ve=async function(){let t=!0;(l.total||_.value.length)>250&&(t=await new Promise(o=>{confirm(g("select_all_confirmation"))?o(!0):o(!1)})),t&&(await Ue(),y.value=a.value,O.value=!0)};return(t,s)=>t.hideOnEmpty&&a.value.length==0?p("",!0):(n(),w("section",ra,[b(Tt,{icon:t.icon,title:t.title,count:i.value.search?a.value.length:t.total||_.value.length,color:"transparent","menu-items":je.value,onTitleClicked:x},null,8,["icon","title","count","menu-items"]),b(gt),pe.value?(n(),c(Ft,{key:0,id:"searchInput",modelValue:i.value.search,"onUpdate:modelValue":s[0]||(s[0]=o=>i.value.search=o),clearable:"","prepend-inner-icon":"mdi-magnify",label:t.$t("search"),"hide-details":"",variant:"filled",style:{width:"auto","margin-top":"10px"},onFocus:s[1]||(s[1]=o=>F.value=!0),onBlur:s[2]||(s[2]=o=>F.value=!1),"onClick:clear":Xe},null,8,["modelValue","label"])):p("",!0),N.value?(n(),c(Ct,{key:1,variant:k.value=="list"?"default":"panel",style:{overflow:"hidden"}},{default:m(()=>[e.value?(n(),c(It,{key:0,color:"accent",height:"4",indeterminate:"",rounded:""})):p("",!0),!Q.value&&!(a.value.length==0&&M.value)?(n(),c(Vt,{key:1,onLoad:de,mode:t.infiniteScroll?"intersect":"manual","load-more-text":t.$t("load_more_items"),"empty-text":"",style:{overflow:"hidden"}},{default:m(()=>[k.value=="panel"?(n(),c(we,{key:0},{default:m(()=>[(n(!0),w(he,null,be(a.value,o=>(n(),c(ge,{key:o.uri,cols:"12",class:Y(`col-${f(ke)(t.$vuetify.display.width)}`)},{default:m(()=>[b(na,{item:o,"is-selected":te(o),"show-checkboxes":O.value,"show-actions":["tracks","albums","albumtracks"].includes(t.itemtype),"show-track-number":t.showTrackNumber,"is-available":f(ie)(o),"parent-item":t.parentItem,onSelect:ae},null,8,["item","is-selected","show-checkboxes","show-actions","show-track-number","is-available","parent-item"])]),_:2},1032,["class"]))),128))]),_:1})):p("",!0),k.value=="panel_compact"?(n(),c(we,{key:1},{default:m(()=>[(n(!0),w(he,null,be(a.value,o=>(n(),c(ge,{key:o.uri,cols:"12",class:Y(`col-${f(ke)(t.$vuetify.display.width)}`)},{default:m(()=>[b($t,{item:o,"is-selected":te(o),"show-checkboxes":O.value,"is-available":f(ie)(o),"parent-item":t.parentItem,onSelect:ae},null,8,["item","is-selected","show-checkboxes","is-available","parent-item"])]),_:2},1032,["class"]))),128))]),_:1})):p("",!0),k.value=="list"?(n(),c(Ot,{key:2,"item-height":70,height:"100%",items:a.value,style:{height:"100%",overflow:"hidden"}},{default:m(({item:o})=>[b(ea,{item:o,"show-track-number":t.showTrackNumber,"show-disc-number":t.showTrackNumber,"show-duration":t.showDuration,"show-favorite":t.showFavoritesOnlyFilter,"show-menu":o.is_playable,"show-provider":t.showProvider,"show-album":t.showAlbum,"show-checkboxes":O.value,"is-selected":te(o),"is-available":f(ie)(o),"show-details":t.itemtype.includes("versions"),"parent-item":t.parentItem,onSelect:ae},null,8,["item","show-track-number","show-disc-number","show-duration","show-favorite","show-menu","show-provider","show-album","show-checkboxes","is-selected","is-available","show-details","parent-item"])]),_:1},8,["items"])):p("",!0)]),_:1},8,["mode","load-more-text"])):p("",!0),!e.value&&a.value.length==0?(n(),w("div",ua,[!e.value&&a.value.length==0&&(i.value.search||i.value.favoritesOnly)?(n(),c(Ie,{key:0,title:t.$t("no_content_filter")},{default:m(()=>[i.value.search?(n(),c(q,{key:0,style:{"margin-top":"15px"},onClick:Ge},{default:m(()=>[S(v(t.$t("try_global_search")),1)]),_:1})):p("",!0)]),_:1},8,["title"])):!e.value&&a.value.length==0?(n(),c(Ie,{key:1},{default:m(()=>[S(v(t.$t("no_content")),1)]),_:1})):p("",!0)])):p("",!0),b(Dt,{"model-value":y.value.length>1,timeout:-1,style:{"margin-bottom":"120px"}},{actions:m(()=>[b(q,{color:"primary",variant:"text",onClick:s[3]||(s[3]=o=>f(re)(y.value,o.clientX,o.clientY,t.parentItem))},{default:m(()=>[S(v(t.$t("actions")),1)]),_:1})]),default:m(()=>[R("span",null,v(t.$t("items_selected",[y.value.length])),1)]),_:1},8,["model-value"])]),_:1},8,["variant"])):p("",!0)]))}}),Aa=ue(ma,[["__scopeId","data-v-652434cf"]]);export{Aa as I};
