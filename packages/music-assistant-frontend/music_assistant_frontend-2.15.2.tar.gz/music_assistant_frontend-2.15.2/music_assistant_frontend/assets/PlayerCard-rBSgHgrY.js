import{x as E,c as z,R as b,S as t,at as oe,$ as le,U as p,au as se,D as ie,aX as V,ba as k,a4 as d,ay as L,b8 as R,aw as A,a2 as T,a8 as te,b3 as x,Q as ae,a1 as ne,a9 as h,Z as v,X as B,ar as P,a0 as n,B as g,an as S,W as q,ab as f,b2 as N,ao as U,Y as re,G as de,b7 as ue,ax as $,a7 as pe,as as me,am as I,a5 as ye,b6 as ve,b0 as ce,bf as _e,aY as fe,V as he,a3 as be}from"./index-C8Wvo59W.js";import{M as ge}from"./MediaItemThumb-DDMb_9k9.js";import{B as M}from"./Button-C6-W0Jei.js";import{_ as O}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as we}from"./VSlider-BbdIm9Mu.js";import{V as Ce}from"./VCheckbox-aZKtlmJa.js";const ke={props:{width:String,height:String,style:String,allowWheel:Boolean},emits:["update:model-value"],setup(s,a){const u=E(!0),i=z(()=>({class:"player-volume",hideDetails:!0,trackSize:2,thumbSize:u.value?0:10,step:2,elevation:0,style:`width: ${s.width}; height:${s.height}; display: inline-grid; ${s.style}`})),C=z(()=>({...i.value,...a}));return{isThumbHidden:u,playerVolumeProps:C,onWheel:({deltaY:y})=>{if(!s.allowWheel)return;const m=C.value.step,l=a.attrs["model-value"],r=y<0?m:-m;a.emit("update:model-value",l+r)}}}};function Se(s,a,u,i,C,e){return t(),b(we,ie(i.playerVolumeProps,{onTouchstart:a[0]||(a[0]=y=>i.isThumbHidden=!1),onTouchend:a[1]||(a[1]=y=>i.isThumbHidden=!0),onMouseenter:a[2]||(a[2]=y=>i.isThumbHidden=!1),onMouseleave:a[3]||(a[3]=y=>i.isThumbHidden=!0),onWheel:V(i.onWheel,["prevent"]),onEnd:a[4]||(a[4]=y=>s.$emit("update:model-value",y))}),oe({_:2},[le(s.$slots,(y,m)=>({name:m,fn:p(()=>[se(s.$slots,m,{},void 0,!0)])}))]),1040,["onWheel"])}const ee=O(ke,[["render",Se],["__scopeId","data-v-af51e13c"]]),Ve=(s,a)=>{const u=[];(s==null?void 0:s.power_control)!=k&&u.push({label:s.powered?"power_off_player":"power_on_player",labelArgs:[],action:()=>{d.playerCommandPowerToggle(s.player_id)},icon:"mdi-power"}),((s==null?void 0:s.state)=="playing"||(s==null?void 0:s.state)=="paused")&&u.push({label:"stop_playback",labelArgs:[],action:()=>{d.playerCommandStop(s.player_id)},icon:"mdi-stop"});const i=Object.values(d.players).filter(e=>e.player_id!=s.player_id&&e.available&&e.enabled&&(e.can_group_with.includes(s.provider)||e.can_group_with.includes(s.player_id))&&e.supported_features.includes(L.SET_MEMBERS)&&!e.synced_to);s.supported_features.includes(L.SET_MEMBERS)&&!s.synced_to&&s.type==R.PLAYER&&s.group_childs.length==0&&i.length>0&&u.push({label:"sync_player_with",labelArgs:[],icon:"mdi-link-variant",subItems:i.map(e=>({label:e.display_name,labelArgs:[],action:()=>{d.playerCommandGroup(s.player_id,e.player_id)}})).sort((e,y)=>{var m;return e.label.toUpperCase()>((m=y.label)==null?void 0:m.toUpperCase())?1:-1})}),a&&u.push({label:a.shuffle_enabled?"shuffle_disable":"shuffle_enable",labelArgs:[],action:()=>{d.queueCommandShuffleToggle(a.queue_id)},icon:a.shuffle_enabled?"mdi-shuffle-disabled":"mdi-shuffle"}),a&&u.push({label:"select_repeat_mode",labelArgs:[],subItems:[{label:"repeat_mode.off",labelArgs:[],action:()=>{d.queueCommandRepeat(a.queue_id,A.OFF)},selected:a.repeat_mode==A.OFF},{label:"repeat_mode.all",labelArgs:[],action:()=>{d.queueCommandRepeat(a.queue_id,A.ALL)},selected:a.repeat_mode==A.ALL},{label:"repeat_mode.one",labelArgs:[],action:()=>{d.queueCommandRepeat(a.queue_id,A.ONE)},selected:a.repeat_mode==A.ONE}],icon:"mdi-repeat"}),a!=null&&a.items&&u.push({label:"transfer_queue",icon:"mdi-swap-horizontal",subItems:Object.values(d.players).filter(e=>e.player_id!=a.queue_id&&e.player_id!=s.player_id&&e.available&&e.enabled&&!e.synced_to).map(e=>({label:e.display_name,labelArgs:[],action:()=>{d.queueCommandTransfer(a.queue_id,e.player_id),T.activePlayerId=e.player_id}})).sort((e,y)=>{var m;return e.label.toUpperCase()>((m=y.label)==null?void 0:m.toUpperCase())?1:-1})}),a!=null&&a.items&&u.push({label:"queue_clear",labelArgs:[],action:()=>{d.queueCommandClear(a.queue_id)},icon:"mdi-cancel"});const C=s.source_list.filter(e=>!e.passive||e.id==s.active_source);return s.active_source!=s.player_id&&C.push({id:s.player_id,name:te("music_assistant_source"),passive:!1,can_play_pause:!0,can_seek:!0,can_next_previous:!0}),!s.synced_to&&C.length>0&&u.push({label:"select_source",labelArgs:[],icon:"mdi-import",subItems:C.map(e=>({label:e.name,labelArgs:[],disabled:e.id==s.active_source,selected:e.id==s.active_source,action:()=>{d.playerCommandGroupSelectSource(s.player_id,e.id)}})).sort((e,y)=>{var m;return e.label.toUpperCase()>((m=y.label)==null?void 0:m.toUpperCase())?1:-1})}),a&&"dont_stop_the_music_enabled"in a&&u.push({label:a.dont_stop_the_music_enabled?"dont_stop_the_music_disable":"dont_stop_the_music_enable",labelArgs:[],action:()=>{d.queueCommandDontStopTheMusicToggle(a.queue_id)},icon:"mdi-all-inclusive"}),u.push({label:"open_player_settings",labelArgs:[],action:()=>{T.showFullscreenPlayer=!1,T.showPlayersMenu=!1,x.push(`/settings/editplayer/${s.player_id}`)},icon:"mdi-cog-outline"}),s.type!==R.GROUP&&u.push({label:"open_dsp_settings",labelArgs:[],action:()=>{T.showFullscreenPlayer=!1,T.showPlayersMenu=!1,x.push(`/settings/editplayer/${s.player_id}/dsp`)},icon:"mdi-equalizer"}),u},Te={key:1,class:"text-caption volumecaption"},Ae={key:0,class:"text-caption volumecaption"},Me=ae({__name:"VolumeControl",props:{player:{},showSyncControls:{type:Boolean},showSubPlayers:{type:Boolean},showHeadingRow:{type:Boolean},showVolumeControl:{type:Boolean},allowWheel:{type:Boolean}},setup(s){const a=s,u=E([]),i=E([]),C=E(void 0),e=z(()=>a.player.group_childs.length>0),y=function(l){var o,_;const r=[];for(const c of l.group_childs){const w=(o=d)==null?void 0:o.players[c];w&&w.volume_control!=k&&w&&w.available&&!r.includes(w)&&r.push(w)}if(a.showSyncControls&&l.supported_features.includes(L.SET_MEMBERS))for(const c of Object.values((_=d)==null?void 0:_.players))c.player_id!=l.player_id&&(!l.can_group_with.includes(c.player_id)&&!l.can_group_with.includes(c.provider)||c.available&&(c.active_group&&c.active_group!=l.player_id||c.active_source&&c.state==$.PLAYING&&![l.player_id,c.player_id].includes(c.active_source)||r.includes(c)||r.push(c)));return r.sort((c,w)=>c.display_name.toUpperCase()>w.display_name.toUpperCase()?1:-1),r},m=async function(l,r){const o=a.player.player_id;r?(i.value.includes(l)&&(i.value=i.value.filter(_=>_!=l)),u.value.includes(l)||u.value.push(l),d.players[o].group_childs.push(l)):(u.value.includes(l)&&(u.value=u.value.filter(_=>_!=l)),i.value.includes(l)||i.value.push(l),d.players[o].group_childs=d.players[o].group_childs.filter(_=>_!=l)),C.value!=null&&clearTimeout(C.value),C.value=setTimeout(async()=>{i.value.length>0&&d.playerCommandUnGroupMany(i.value).catch(async()=>{d.players[o]=await d.getPlayer(o)}).finally(()=>{i.value=[]}),u.value.length>0&&d.playerCommandGroupMany(o,u.value).catch(async()=>{d.players[o]=await d.getPlayer(o)}).finally(()=>{u.value=[]})},1e3)};return(l,r)=>(t(),b(ne,{style:{overflow:"hidden",padding:"0"},lines:"two"},{default:p(()=>[l.showHeadingRow?(t(),b(B,{key:0,class:"volumesliderrow heading",link:!1,style:P(l.player.powered==!1?"opacity: 0.6":"opacity: 1")},{prepend:p(()=>[g(S,{size:25,icon:l.player.icon,style:{"margin-left":"6px",opacity:"0.6"}},null,8,["icon"])]),default:p(()=>[q("h5",null,f(n(N)(l.player,27)),1)]),append:p(()=>[l.player.power_control!=n(k)?(t(),b(M,{key:0,class:"powerbtn",variant:"icon",onClick:r[0]||(r[0]=V(o=>n(d).playerCommandPowerToggle(l.player.player_id),["stop"]))},{default:p(()=>[g(S,{size:25,icon:"mdi-power"})]),_:1})):h("",!0)]),_:1},8,["style"])):h("",!0),l.showVolumeControl&&(l.player.volume_control!=n(k)||l.player.group_childs.length)?(t(),b(B,{key:1,class:"volumesliderrow",link:!1,style:P(l.player.powered==!1?"opacity: 0.35":"opacity: 0.75")},{prepend:p(()=>[g(M,{icon:"",style:{height:"25px"},disabled:l.player.type==n(R).GROUP||l.player.group_childs.length>0||l.player.mute_control==n(k),onClick:r[1]||(r[1]=V(o=>n(d).playerCommandMuteToggle(l.player.player_id),["stop"]))},{default:p(()=>[g(S,{size:25,icon:l.player.volume_muted?"mdi-volume-mute":"mdi-volume-medium"},null,8,["icon"])]),_:1},8,["disabled"])]),default:p(()=>[l.player.volume_control!=n(k)||l.player.group_childs.length?(t(),b(ee,{key:0,color:"secondary",width:"100%","is-powered":l.player.powered!=!1,disabled:!l.player.available,"model-value":Math.round(l.player.group_childs.length?l.player.group_volume:l.player.volume_level||0),onClick:r[2]||(r[2]=V(()=>{},["stop"])),"onUpdate:modelValue":r[3]||(r[3]=o=>l.player.group_childs.length>0?n(d).playerCommandGroupVolume(l.player.player_id,o):n(d).playerCommandVolumeSet(l.player.player_id,o))},null,8,["is-powered","disabled","model-value"])):h("",!0)]),append:p(()=>[e.value&&!l.showSubPlayers?(t(),b(S,{key:0,class:"expandbtn"},{default:p(()=>r[7]||(r[7]=[U(" mdi-chevron-down ")])),_:1,__:[7]})):(t(),v("div",Te,f(Math.round(l.player.group_childs.length?l.player.group_volume:l.player.volume_level||0)),1))]),_:1},8,["style"])):h("",!0),l.showSubPlayers&&(l.player.group_childs.length>0||l.showSyncControls)&&y(l.player).length>0?(t(),v("div",{key:2,onClick:r[6]||(r[6]=V(()=>{},["stop"]))},[g(re,{style:{"margin-top":"10px","margin-bottom":"15px"}}),(t(!0),v(de,null,le(y(l.player),o=>(t(),v("div",{key:o.player_id},[g(B,{class:"volumesliderrow",link:!1,style:P(o.powered!=!1||l.showSyncControls?"opacity: 0.75":"opacity: 0.4"),onClick:r[4]||(r[4]=V(()=>{},["stop"]))},{prepend:p(()=>[g(S,{size:30,icon:o.icon,style:{"margin-left":"6px",opacity:"0.6"}},null,8,["icon"])]),default:p(()=>[q("h6",null,f(n(ue)(o.display_name,27)),1)]),append:p(()=>[l.showSyncControls?(t(),b(Ce,{key:0,ripple:!1,disabled:o.player_id==l.player.player_id,"model-value":l.player.group_childs.includes(o.player_id)||o.player_id==l.player.player_id,size:"22",class:"checkbox","onUpdate:modelValue":_=>m(o.player_id,_)},null,8,["disabled","model-value","onUpdate:modelValue"])):h("",!0)]),_:2},1032,["style"]),o.volume_control!=n(k)?(t(),b(B,{key:0,class:"volumesliderrow",link:!1,style:P(o.powered==!1?"opacity: 0.4":"opacity: 0.75"),onClick:r[5]||(r[5]=V(()=>{},["stop"]))},{prepend:p(()=>[g(M,{icon:"",disabled:!o.available||o.mute_control==n(k),style:{height:"25px"},onClick:_=>n(d).playerCommandMuteToggle(o.player_id)},{default:p(()=>[g(S,{size:25,icon:o.volume_muted?"mdi-volume-mute":"mdi-volume-medium"},null,8,["icon"])]),_:2},1032,["disabled","onClick"])]),default:p(()=>[o.volume_control!=n(k)?(t(),b(ee,{key:0,color:"secondary",width:"100%","is-powered":o.powered!=!1,disabled:!o.available,"allow-wheel":l.allowWheel,"model-value":Math.round(o.volume_level||0),"onUpdate:modelValue":_=>n(d).playerCommandVolumeSet(o.player_id,_)},null,8,["is-powered","disabled","allow-wheel","model-value","onUpdate:modelValue"])):h("",!0)]),append:p(()=>[o.volume_control!=n(k)?(t(),v("div",Ae,f(o.volume_level),1)):h("",!0)]),_:2},1032,["style"])):h("",!0),r[8]||(r[8]=q("div",{style:{height:"14px"}},null,-1))]))),128))])):h("",!0)]),_:1}))}}),Be=O(Me,[["__scopeId","data-v-a2a4ac06"]]),$e={class:"player-media-thumb"},qe={key:1},ze={key:2,class:"icon-thumb"},Pe={key:0,style:{"margin-bottom":"3px"}},Ee={key:0},Ue={key:1},Re={key:1,style:{"margin-bottom":"3px"}},Ie={key:0,style:{"font-size":"0.85rem","font-weight":"500","white-space":"nowrap"}},Le={key:0},Ne={key:0},Oe={key:1},De={key:2},Ge={class:"v-list-item-subtitle",style:{"white-space":"nowrap"}},We={key:0},Ye={key:1},Fe={key:2},He={key:3},Xe={key:4},je={key:5},Ke={key:6},Ze=ae({__name:"PlayerCard",props:{player:{},showVolumeControl:{type:Boolean},showMenuButton:{type:Boolean},showSubPlayers:{type:Boolean},showSyncControls:{type:Boolean},allowPowerControl:{type:Boolean}},setup(s){const a=s,u=z(()=>{if(a.player&&a.player.active_source&&a.player.active_source in d.queues)return d.queues[a.player.active_source];if(a.player&&!a.player.active_source&&a.player.player_id in d.queues)return d.queues[a.player.player_id]}),i=z(()=>{if(u.value&&u.value.active)return u.value.current_item}),C=function(e){be.emit("contextmenu",{items:Ve(a.player,u.value),posX:e.clientX,posY:e.clientY})};return(e,y)=>(t(),b(pe,{flat:"",class:me(["panel-item",{"panel-item-selected":e.player.player_id==n(T).activePlayerId,"panel-item-idle":e.player.state==n($).IDLE,"panel-item-off":e.player.powered==!1}]),ripple:!1,disabled:!e.player.available},{default:p(()=>[g(B,{class:"panel-item-details",flat:"",ripple:!1},{prepend:p(()=>{var m,l,r,o;return[q("div",$e,[e.player.powered!=!1&&((m=i.value)!=null&&m.media_item)||(l=i.value)!=null&&l.image?(t(),b(ge,{key:0,class:"media-thumb",size:"55",item:((r=i.value)==null?void 0:r.media_item)||i.value,fallback:n(fe)},null,8,["item","fallback"])):e.player.powered!=!1&&!u.value&&((o=e.player.current_media)!=null&&o.image_url)?(t(),v("div",qe,[g(he,{class:"media-thumb",size:"55",src:e.player.current_media.image_url},null,8,["src"])])):(t(),v("div",ze,[g(S,{size:"35",icon:e.player.type==n(R).PLAYER&&e.player.group_childs.length?"mdi-speaker-multiple":e.player.icon,style:{display:"table-cell",opacity:"0.8"}},null,8,["icon"])]))])]}),title:p(()=>[n(_e).player_id===e.player.player_id?(t(),v("div",Pe,[e.player.display_name=="This Device"?(t(),v("span",Ee,f(e.$t("this_device")),1)):(t(),v("span",Ue,f(n(N)(e.player,27)),1)),g(S,{size:"20",class:"pl-2",icon:n(T).deviceType=="phone"?"mdi-cellphone":"mdi-monitor"},null,8,["icon"])])):(t(),v("div",Re,f(n(N)(e.player,27)),1))]),subtitle:p(()=>{var m,l,r,o,_,c,w;return[e.player.powered!=!1?(t(),v("div",Ie,[(m=i.value)!=null&&m.media_item?(t(),v("div",Le,[U(f((l=i.value)==null?void 0:l.media_item.name)+" ",1),"version"in((r=i.value)==null?void 0:r.media_item)&&((o=i.value)!=null&&o.media_item.version)?(t(),v("span",Ne,"("+f((_=i.value)==null?void 0:_.media_item.version)+")",1)):h("",!0)])):i.value?(t(),v("div",Oe,f((c=i.value)==null?void 0:c.name),1)):!u.value&&((w=e.player.current_media)!=null&&w.title)?(t(),v("div",De,f(e.player.current_media.title),1)):h("",!0)])):h("",!0)]}),default:p(()=>{var m,l,r,o,_,c,w,D,G,W,Y,F,H,X,j,K,Z,J,Q;return[q("div",Ge,[e.player.powered==!1?(t(),v("div",We,f(e.$t("off")),1)):(m=i.value)!=null&&m.media_item&&((r=(l=i.value)==null?void 0:l.media_item)==null?void 0:r.media_type)==n(ye).TRACK&&"album"in((o=i.value)==null?void 0:o.media_item)&&((_=i.value)!=null&&_.media_item.album)?(t(),v("div",Ye,f(n(ve)((c=i.value)==null?void 0:c.media_item.artists))+" • "+f((w=i.value)==null?void 0:w.media_item.album.name),1)):(D=i.value)!=null&&D.media_item&&"artists"in((G=i.value)==null?void 0:G.media_item)&&((W=i.value)==null?void 0:W.media_item.artists.length)>0?(t(),v("div",Fe,f((Y=i.value)==null?void 0:Y.media_item.artists[0].name),1)):(H=(F=i.value)==null?void 0:F.streamdetails)!=null&&H.stream_title?(t(),v("div",He,f((j=(X=i.value)==null?void 0:X.streamdetails)==null?void 0:j.stream_title),1)):(Z=(K=i.value)==null?void 0:K.media_item)!=null&&Z.metadata.description?(t(),v("div",Xe,f((J=i.value)==null?void 0:J.media_item.metadata.description),1)):!u.value&&e.player.active_source?(t(),v("div",je,f(e.$t("external_source_active",[n(ce)(e.player)])),1)):((Q=u.value)==null?void 0:Q.items)==0?(t(),v("div",Ke,f(e.$t("queue_empty")),1)):h("",!0)])]}),append:p(()=>{var m;return[e.player.state==n($).PAUSED||e.player.state==n($).PLAYING||(m=u.value)!=null&&m.items?(t(),b(M,{key:0,variant:"icon",class:"player-command-btn",onClick:y[0]||(y[0]=V(l=>{n(d).playerCommandPlayPause(e.player.player_id),n(T).activePlayerId=e.player.player_id},["stop"]))},{default:p(()=>[g(S,{size:n(I)({breakpoint:"phone"})?"30":"32",icon:e.player.state==n($).PLAYING?"mdi-pause":"mdi-play"},null,8,["size","icon"])]),_:1})):h("",!0),e.player.power_control!=n(k)&&e.allowPowerControl?(t(),b(M,{key:1,variant:"icon",class:"player-command-btn",onClick:y[1]||(y[1]=V(l=>{n(d).playerCommandPowerToggle(e.player.player_id),n(T).activePlayerId=e.player.player_id},["stop"]))},{default:p(()=>[g(S,{size:n(I)({breakpoint:"phone"})?"30":"32"},{default:p(()=>y[2]||(y[2]=[U("mdi-power")])),_:1,__:[2]},8,["size"])]),_:1})):h("",!0),e.showMenuButton?(t(),b(M,{key:2,variant:"icon",class:"player-command-btn",style:{"margin-right":"-5px"},onClick:V(C,["stop"])},{default:p(()=>[g(S,{size:n(I)({breakpoint:"phone"})?"30":"32"},{default:p(()=>y[3]||(y[3]=[U("mdi-dots-vertical")])),_:1,__:[3]},8,["size"])]),_:1})):h("",!0)]}),_:1}),e.showVolumeControl?(t(),b(Be,{key:0,player:e.player,"show-sync-controls":e.showSyncControls,"show-heading-row":!1,"show-sub-players":e.showSubPlayers,"show-volume-control":e.player.powered!=!1,"allow-wheel":!1},null,8,["player","show-sync-controls","show-sub-players","show-volume-control"])):h("",!0)]),_:1},8,["class","disabled"]))}}),ol=O(Ze,[["__scopeId","data-v-1b70aa95"]]);export{ee as P,Be as V,ol as a,Ve as g};
