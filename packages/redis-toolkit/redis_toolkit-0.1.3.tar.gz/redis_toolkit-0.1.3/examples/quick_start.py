#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Redis Toolkit å¿«é€Ÿé–‹å§‹ç¯„ä¾‹
5 åˆ†é˜å­¸æœƒæ ¸å¿ƒåŠŸèƒ½
"""

from redis_toolkit import RedisToolkit

# 1. å»ºç«‹å·¥å…·åŒ…å¯¦ä¾‹
print("1ï¸âƒ£ å»ºç«‹ RedisToolkit å¯¦ä¾‹")
toolkit = RedisToolkit()

# 2. å­˜å„²ä¸åŒé¡å‹çš„è³‡æ–™ï¼ˆè‡ªå‹•åºåˆ—åŒ–ï¼‰
print("\n2ï¸âƒ£ å­˜å„²å„ç¨®è³‡æ–™é¡å‹")
toolkit.setter("ä½¿ç”¨è€…", {"å§“å": "å°æ˜", "å¹´é½¡": 25, "VIP": True})
toolkit.setter("åˆ†æ•¸åˆ—è¡¨", [95, 87, 92, 88, 90])
toolkit.setter("å•Ÿç”¨åŠŸèƒ½", True)
toolkit.setter("éŸ³è¨Šè³‡æ–™", "æ¨¡æ“¬éŸ³è¨Šä½å…ƒçµ„è³‡æ–™...".encode("utf-8"))

print("âœ“ å·²å­˜å„²ï¼šå­—å…¸ã€åˆ—è¡¨ã€å¸ƒæ—å€¼ã€ä½å…ƒçµ„è³‡æ–™")

# 3. å–å¾—è³‡æ–™ï¼ˆè‡ªå‹•ååºåˆ—åŒ–ï¼‰
print("\n3ï¸âƒ£ å–å¾—è³‡æ–™")
ä½¿ç”¨è€… = toolkit.getter("ä½¿ç”¨è€…")
åˆ†æ•¸ = toolkit.getter("åˆ†æ•¸åˆ—è¡¨")
åŠŸèƒ½ = toolkit.getter("å•Ÿç”¨åŠŸèƒ½")

print(f"ä½¿ç”¨è€…è³‡æ–™: {ä½¿ç”¨è€…}")
print(f"åˆ†æ•¸åˆ—è¡¨: {åˆ†æ•¸}")
print(f"åŠŸèƒ½ç‹€æ…‹: {åŠŸèƒ½} (é¡å‹: {type(åŠŸèƒ½).__name__})")

# 4. æ‰¹æ¬¡æ“ä½œ
print("\n4ï¸âƒ£ æ‰¹æ¬¡æ“ä½œ")
batch_data = {
    "ç”¢å“_A": {"åç¨±": "æ™ºæ…§æ‰‹éŒ¶", "åƒ¹æ ¼": 2999},
    "ç”¢å“_B": {"åç¨±": "ç„¡ç·šè€³æ©Ÿ", "åƒ¹æ ¼": 1299},
    "ç”¢å“_C": {"åç¨±": "å……é›»å™¨", "åƒ¹æ ¼": 299}
}

toolkit.batch_set(batch_data)
products = toolkit.batch_get(["ç”¢å“_A", "ç”¢å“_B", "ç”¢å“_C"])
print(f"æ‰¹æ¬¡å–å¾—ç”¢å“: {len(products)} é …")

# 5. ä½¿ç”¨åŸç”Ÿ Redis åŠŸèƒ½
print("\n5ï¸âƒ£ ä½¿ç”¨åŸç”Ÿ Redis åŠŸèƒ½")
toolkit.client.lpush("è³¼ç‰©è»Š", "ç”¢å“_A", "ç”¢å“_B")
è³¼ç‰©è»Šé•·åº¦ = toolkit.client.llen("è³¼ç‰©è»Š")
print(f"è³¼ç‰©è»Šå•†å“æ•¸é‡: {è³¼ç‰©è»Šé•·åº¦}")

# 6. ç™¼å¸ƒè¨‚é–±ï¼ˆç°¡å–®ç¤ºä¾‹ï¼‰
print("\n6ï¸âƒ£ ç™¼å¸ƒè¨Šæ¯")
toolkit.publisher("ç”¨æˆ¶äº‹ä»¶", {
    "äº‹ä»¶": "è³¼è²·", 
    "ä½¿ç”¨è€…": "å°æ˜", 
    "å•†å“": ["ç”¢å“_A", "ç”¢å“_B"],
    "ç¸½é‡‘é¡": 4298
})
print("âœ“ å·²ç™¼å¸ƒç”¨æˆ¶äº‹ä»¶è¨Šæ¯")

# 7. æ¸…ç†
print("\n7ï¸âƒ£ æ¸…ç†è³‡æº")
toolkit.cleanup()
print("âœ“ è³‡æºæ¸…ç†å®Œæˆ")

print("\nğŸ‰ å¿«é€Ÿé–‹å§‹å®Œæˆï¼")
print("ğŸ’¡ ä½ å·²ç¶“å­¸æœƒäº† Redis Toolkit çš„æ‰€æœ‰æ ¸å¿ƒåŠŸèƒ½")