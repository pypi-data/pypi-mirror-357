"use strict";(self.webpackChunkhome_assistant_frontend=self.webpackChunkhome_assistant_frontend||[]).push([["55795"],{55815:function(t,e,a){a.d(e,{Eu:()=>r,hZ:()=>h,o9:()=>n});var i=a(28105),s=a(45657);const o=["#4269d0","#f4bd4a","#ff725c","#6cc5b0","#a463f2","#ff8ab7","#9c6b4e","#97bbf5","#01ab63","#9498a0","#094bad","#c99000","#d84f3e","#49a28f","#048732","#d96895","#8043ce","#7599d1","#7a4c31","#74787f","#6989f4","#ffd444","#ff957c","#8fe9d3","#62cc71","#ffadda","#c884ff","#badeff","#bf8b6d","#b6bac2","#927acc","#97ee3f","#bf3947","#9f5b00","#f48758","#8caed6","#f2b94f","#eff26e","#e43872","#d9b100","#9d7a00","#698cff","#d9d9d9","#00d27e","#d06800","#009f82","#c49200","#cbe8ff","#fecddf","#c27eb6","#8cd2ce","#c4b8d9","#f883b0","#a49100","#f48800","#27d0df","#a04a9b"];function r(t){return o[t%o.length]}function h(t,e){const a=e.getPropertyValue(`--graph-color-${t+1}`)||r(t);return(0,s.Rq)(a)}const n=(0,i.Z)((t=>o.map(((e,a)=>h(a,t)))),((t,e)=>t[0].getPropertyValue("--graph-color-1")===e[0].getPropertyValue("--graph-color-1")))},56665:function(t,e,a){a.a(t,(async function(t,i){try{a.d(e,{O:()=>T});a(39710),a(26847),a(2394),a(18574),a(81738),a(94814),a(22960),a(6989),a(1455),a(67886),a(65451),a(46015),a(38334),a(94880),a(75643),a(29761),a(56389),a(27530);var s=a(73742),o=a(59048),r=a(7616),h=a(20480),n=a(28105),d=a(55815),c=a(37528),l=a(74266),p=a(28598),u=a(27417),m=a(97050),y=a(7214),_=a(37008),f=t([_,p,l]);[_,p,l]=f.then?(await f)():f;let b,g,v,x,D,S=t=>t;const T={mean:"mean",min:"min",max:"max",sum:"sum",state:"sum",change:"sum"};class w extends o.oi{shouldUpdate(t){return t.size>1||!t.has("hass")}willUpdate(t){(t.has("statisticsData")||t.has("statTypes")||t.has("chartType")||t.has("hideLegend")||t.has("_hiddenStats"))&&this._generateData(),(!this.hasUpdated||t.has("unit")||t.has("period")||t.has("chartType")||t.has("minYAxis")||t.has("maxYAxis")||t.has("fitYData")||t.has("logarithmicScale")||t.has("hideLegend")||t.has("startTime")||t.has("endTime")||t.has("_legendData")||t.has("_chartData"))&&this._createOptions()}firstUpdated(){this._computedStyle=getComputedStyle(this)}render(){return(0,c.p)(this.hass,"history")?this.isLoadingData&&!this.statisticsData?(0,o.dy)(g||(g=S`<div class="info"> ${0} </div>`),this.hass.localize("ui.components.statistics_charts.loading_statistics")):this.statisticsData&&Object.keys(this.statisticsData).length?(0,o.dy)(x||(x=S` <ha-chart-base .hass="${0}" .data="${0}" .options="${0}" .height="${0}" style="${0}" @dataset-hidden="${0}" @dataset-unhidden="${0}" .expandLegend="${0}"></ha-chart-base> `),this.hass,this._chartData,this._chartOptions,this.height,(0,h.V)({height:this.height}),this._datasetHidden,this._datasetUnhidden,this.expandLegend):(0,o.dy)(v||(v=S`<div class="info"> ${0} </div>`),this.hass.localize("ui.components.statistics_charts.no_statistics_found")):(0,o.dy)(b||(b=S`<div class="info"> ${0} </div>`),this.hass.localize("ui.components.history_charts.history_disabled"))}_datasetHidden(t){this._hiddenStats.add(t.detail.name),this.requestUpdate("_hiddenStats")}_datasetUnhidden(t){this._hiddenStats.delete(t.detail.name),this.requestUpdate("_hiddenStats")}_createOptions(){var t,e;const a=null!==(t=this.daysToShow)&&void 0!==t?t:1;let i=this.minYAxis,s=this.maxYAxis;"number"==typeof i?this.fitYData&&(i=({min:t})=>Math.min(this._roundYAxis(t,Math.floor),this.minYAxis)):this.logarithmicScale&&(i=({min:t})=>{const e=t>0?.95*t:1.05*t;return this._roundYAxis(e,Math.floor)}),"number"==typeof s?this.fitYData&&(s=({max:t})=>Math.max(this._roundYAxis(t,Math.ceil),this.maxYAxis)):this.logarithmicScale&&(s=({max:t})=>{const e=t>0?1.05*t:.95*t;return this._roundYAxis(e,Math.ceil)});const o=null!==(e=this.endTime)&&void 0!==e?e:new Date;let r=this.startTime;r||(this._chartData.forEach((t=>{var e;if(!Array.isArray(t.data)||!t.data[0])return;const a=t.data[0],i=Array.isArray(a)?a[0]:null===(e=a.value)||void 0===e?void 0:e[0];i&&(!r||new Date(i)<r)&&(r=new Date(i))})),r||(r=new Date(o.getTime()-24*a*3600*1e3))),this._chartOptions={xAxis:[{id:"xAxis",type:"time",min:r,max:this.endTime},{id:"hiddenAxis",type:"time",show:!1}],yAxis:{type:this.logarithmicScale?"log":"value",name:this.unit,nameGap:2,nameTextStyle:{align:"left"},position:(0,m.HE)(this.hass)?"right":"left",scale:"bar"!==this.chartType||this.logarithmicScale||void 0!==i||void 0!==s,min:this._clampYAxis(i),max:this._clampYAxis(s),splitLine:{show:!0}},legend:{type:"custom",show:!this.hideLegend,data:this._legendData},grid:{top:15,left:1,right:1,bottom:0,containLabel:!0},tooltip:{trigger:"axis",appendTo:document.body,formatter:this._renderTooltip}}}async _generateData(){if(!this.statisticsData)return;const t=this.metadata||await this._getStatisticsMetaData(Object.keys(this.statisticsData));let e=0;const a=Object.entries(this.statisticsData),i=[],s=[],o=[];let r,h;if(0===a.length)return;r=this.endTime||new Date(Math.max(...a.map((([t,e])=>new Date(e[e.length-1].start).getTime())))),r>new Date&&(r=new Date);const n=this.names||{};a.forEach((([a,r])=>{const c=null==t?void 0:t[a];let l=n[a];void 0===l&&(l=(0,y.Kd)(this.hass,a,c)),this.unit||(void 0===h?h=(0,y.dO)(this.hass,a,c):null!==h&&h!==(0,y.dO)(this.hass,a,c)&&(h=null));let p,u=null;const m=[],_=[],f=(t,e,a)=>{a.length&&(t>e||(m.forEach(((e,i)=>{"line"===this.chartType&&p&&u&&p.getTime()!==t.getTime()&&(e.data.push(this._transformDataValue([p,...u[i]])),e.data.push([p,null])),e.data.push(this._transformDataValue([t,...a[i]]))})),u=a,p=e))},b=(0,d.hZ)(e,this._computedStyle||getComputedStyle(this));e++;const g=[],v=this.statTypes.includes("mean")&&(0,y.Nw)(r,"mean"),x=this.statTypes.includes("max")&&(0,y.Nw)(r,"max"),D=this.statTypes.includes("min")&&(0,y.Nw)(r,"min"),S=[v,x,D].filter(Boolean).length>1,T=x?"max":"mean",w=D?"min":"mean",C=S?[...this.statTypes].sort(((t,e)=>"min"===t||"max"===e?-1:"max"===t||"min"===e?1:0)):this.statTypes;let A=!1;C.forEach((t=>{if((0,y.Nw)(r,t)){const i=S&&(t===T||t===w);g.push(t);const s=i&&D&&x&&v?b+(this.hideLegend?"00":"7F"):b,r=i?b+"3F":b+"7F",h={id:`${a}-${t}`,type:this.chartType,smooth:"line"===this.chartType&&.4,smoothMonotone:"x",cursor:"default",data:[],name:l?`${l} (${this.hass.localize(`ui.components.statistics_charts.statistic_types.${t}`)})`:this.hass.localize(`ui.components.statistics_charts.statistic_types.${t}`),symbol:"none",sampling:"minmax",animationDurationUpdate:0,lineStyle:{width:1.5},itemStyle:"bar"===this.chartType?{borderRadius:[4,4,0,0],borderColor:s,borderWidth:1.5}:void 0,color:"bar"===this.chartType?r:s};if(i&&"line"===this.chartType&&(h.stack=`band-${a}`,h.stackStrategy="all",S&&t===T&&(h.areaStyle={color:b+"3F"})),!this.hideLegend){const a=v?"mean"===t:!1===A;var e;if(a)_.push({name:l,color:h.color,borderColor:null===(e=h.itemStyle)||void 0===e?void 0:e.borderColor});A=A||a}m.push(h),o.push(a)}}));let $=null,Y=null;r.forEach((t=>{const e=new Date(t.start);if($===e)return;$=e;const a=[];g.forEach((e=>{const i=[];if("sum"===e)null==Y?(i.push(0),Y=t.sum):i.push((t.sum||0)-Y);else if(e===T&&"line"===this.chartType&&S){const e=t[T]||0;i.push(Math.abs(e-(t[w]||0))),i.push(e)}else{var s;i.push(null!==(s=t[e])&&void 0!==s?s:null)}a.push(i)})),this._hiddenStats.has(l)||f(e,new Date(t.end),a)})),Array.prototype.push.apply(i,m),Array.prototype.push.apply(s,_)})),h&&(this.unit=h),s.forEach((({name:t,color:e,borderColor:a})=>{i.push({id:t+"-legend",name:t,color:e,itemStyle:{borderColor:a},type:this.chartType,data:[],xAxisIndex:1})})),this._chartData=i,s.length!==this._legendData.length&&(this._legendData=s.map((({name:t})=>t))),this._statisticIds=o}_transformDataValue(t){return"bar"===this.chartType&&t[1]&&t[1]<0?{value:t,itemStyle:{borderRadius:[0,0,4,4]}}:t}_clampYAxis(t){if(this.logarithmicScale){if("number"==typeof t)return Math.max(t,Number.EPSILON);if("function"==typeof t)return e=>Math.max(t(e),Number.EPSILON)}return t}_roundYAxis(t,e){return Math.abs(t)<1?t:e(t)}constructor(...t){super(...t),this.statTypes=["sum","min","mean","max"],this.chartType="line",this.fitYData=!1,this.hideLegend=!1,this.logarithmicScale=!1,this.isLoadingData=!1,this.clickForMoreInfo=!0,this._chartData=[],this._legendData=[],this._statisticIds=[],this._hiddenStats=new Set,this._renderTooltip=t=>{const e={},a=this.unit?`${(0,u.L)(this.unit,this.hass.locale)}${this.unit}`:"";return t.map(((t,i)=>{var s,o;if(e[t.seriesName])return"";e[t.seriesName]=!0;const r=this._statisticIds[t.seriesIndex],h=this.hass.states[r],n=this.hass.entities[r],d=String(null!==(s=t.value[2])&&void 0!==s?s:t.value[1]),c=null!==(o=(0,p.l4)(h,n))&&void 0!==o?o:{maximumFractionDigits:2},u=`${(0,p.uf)(d,this.hass.locale,c)}${a}`;return`${0===i?(0,l.E8)(new Date(t.value[0]),this.hass.locale,this.hass.config)+"<br>":""}${t.marker} ${t.seriesName}: ${u}`})).filter(Boolean).join("<br>")},this._getStatisticsMetaData=(0,n.Z)((async t=>{const e=await(0,y.Py)(this.hass,t),a={};return e.forEach((t=>{a[t.statistic_id]=t})),a}))}}w.styles=(0,o.iv)(D||(D=S`:host{display:block;min-height:60px}.info{text-align:center;line-height:60px;color:var(--secondary-text-color)}`)),(0,s.__decorate)([(0,r.Cb)({attribute:!1})],w.prototype,"hass",void 0),(0,s.__decorate)([(0,r.Cb)({attribute:!1})],w.prototype,"statisticsData",void 0),(0,s.__decorate)([(0,r.Cb)({attribute:!1})],w.prototype,"metadata",void 0),(0,s.__decorate)([(0,r.Cb)({attribute:!1})],w.prototype,"names",void 0),(0,s.__decorate)([(0,r.Cb)()],w.prototype,"unit",void 0),(0,s.__decorate)([(0,r.Cb)({attribute:!1})],w.prototype,"startTime",void 0),(0,s.__decorate)([(0,r.Cb)({attribute:!1})],w.prototype,"endTime",void 0),(0,s.__decorate)([(0,r.Cb)({attribute:!1,type:Array})],w.prototype,"statTypes",void 0),(0,s.__decorate)([(0,r.Cb)({attribute:!1})],w.prototype,"chartType",void 0),(0,s.__decorate)([(0,r.Cb)({attribute:!1,type:Number})],w.prototype,"minYAxis",void 0),(0,s.__decorate)([(0,r.Cb)({attribute:!1,type:Number})],w.prototype,"maxYAxis",void 0),(0,s.__decorate)([(0,r.Cb)({attribute:"fit-y-data",type:Boolean})],w.prototype,"fitYData",void 0),(0,s.__decorate)([(0,r.Cb)({attribute:"hide-legend",type:Boolean})],w.prototype,"hideLegend",void 0),(0,s.__decorate)([(0,r.Cb)({attribute:"logarithmic-scale",type:Boolean})],w.prototype,"logarithmicScale",void 0),(0,s.__decorate)([(0,r.Cb)({attribute:"is-loading-data",type:Boolean})],w.prototype,"isLoadingData",void 0),(0,s.__decorate)([(0,r.Cb)({attribute:"click-for-more-info",type:Boolean})],w.prototype,"clickForMoreInfo",void 0),(0,s.__decorate)([(0,r.Cb)()],w.prototype,"period",void 0),(0,s.__decorate)([(0,r.Cb)({attribute:"days-to-show",type:Number})],w.prototype,"daysToShow",void 0),(0,s.__decorate)([(0,r.Cb)({type:String})],w.prototype,"height",void 0),(0,s.__decorate)([(0,r.Cb)({attribute:"expand-legend",type:Boolean})],w.prototype,"expandLegend",void 0),(0,s.__decorate)([(0,r.SB)()],w.prototype,"_chartData",void 0),(0,s.__decorate)([(0,r.SB)()],w.prototype,"_legendData",void 0),(0,s.__decorate)([(0,r.SB)()],w.prototype,"_statisticIds",void 0),(0,s.__decorate)([(0,r.SB)()],w.prototype,"_chartOptions",void 0),(0,s.__decorate)([(0,r.SB)()],w.prototype,"_hiddenStats",void 0),w=(0,s.__decorate)([(0,r.Mo)("statistics-chart")],w),i()}catch(b){i(b)}}))}}]);
//# sourceMappingURL=55795.fcdbc3bb17ba3d73.js.map