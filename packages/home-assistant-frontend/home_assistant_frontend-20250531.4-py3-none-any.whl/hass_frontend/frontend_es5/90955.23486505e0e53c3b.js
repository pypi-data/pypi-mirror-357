"use strict";(self.webpackChunkhome_assistant_frontend=self.webpackChunkhome_assistant_frontend||[]).push([["90955"],{45332:function(e,i,t){function n(e){return null==e||Array.isArray(e)?e:[e]}t.d(i,{r:()=>n})},54731:function(e,i,t){t.d(i,{z:()=>n});t(39710),t(56389);const n=e=>(i,t)=>e.includes(i,t)},10142:function(e,i,t){t.d(i,{B$:()=>a,EQ:()=>y,Es:()=>l,Gd:()=>d,HF:()=>b,Ip:()=>w,J8:()=>q,Jd:()=>A,Kc:()=>h,Pl:()=>j,SC:()=>u,SQ:()=>p,T5:()=>Z,W9:()=>v,Xm:()=>E,Yc:()=>c,r4:()=>f,sq:()=>_});t(26847),t(2394),t(81738),t(22960),t(6989),t(87799),t(27530);var n=t(67050),s=t(45332),r=t(66095),o=t(64637);const a="single",c=10,d=e=>{if("condition"in e&&Array.isArray(e.condition))return{condition:"and",conditions:e.condition};for(const i of["and","or","not"])if(i in e)return{condition:i,conditions:e[i]};return e},l=(e,i)=>{e.callService("automation","trigger",{entity_id:i,skip_condition:!0})},u=(e,i)=>e.callApi("DELETE",`config/automation/config/${i}`);let g;const f=(e,i)=>e.callApi("GET",`config/automation/config/${i}`),p=(e,i)=>e.callWS({type:"automation/config",entity_id:i}),_=(e,i,t)=>e.callApi("POST",`config/automation/config/${i}`,t),y=e=>{e=m(e);for(const i of["triggers","conditions","actions"]){const t=e[i];t&&!Array.isArray(t)&&(e[i]=[t])}return e},m=e=>("trigger"in e&&("triggers"in e||(e.triggers=e.trigger),delete e.trigger),"condition"in e&&("conditions"in e||(e.conditions=e.condition),delete e.condition),"action"in e&&("actions"in e||(e.actions=e.action),delete e.action),e.triggers&&(e.triggers=v(e.triggers)),e.actions&&(e.actions=(0,r.eR)(e.actions)),e),v=e=>e?Array.isArray(e)?e.map(v):("triggers"in e&&e.triggers&&(e.triggers=v(e.triggers)),"platform"in e&&("trigger"in e||(e.trigger=e.platform),delete e.platform),e):e,h=e=>{if(!e)return[];const i=[];return(0,s.r)(e).forEach((e=>{"triggers"in e?e.triggers&&i.push(...h(e.triggers)):i.push(e)})),i},w=(e,i)=>{g=e;const t=i?`?${(0,o.ou)({expanded:"1"})}`:"";(0,n.c)(`/config/automation/edit/new${t}`)},b=e=>{w(Object.assign(Object.assign({},e),{},{id:void 0,alias:void 0}))},j=()=>{const e=g;return g=void 0,e},A=e=>{if(!e||"object"!=typeof e)return!1;const i=e;return"trigger"in i&&"string"==typeof i.trigger||"platform"in i&&"string"==typeof i.platform},Z=e=>{if(!e||"object"!=typeof e)return!1;return"condition"in e&&"string"==typeof e.condition},E=(e,i,t,n)=>e.connection.subscribeMessage(i,{type:"subscribe_trigger",trigger:t,variables:n}),q=(e,i,t)=>e.callWS({type:"test_condition",condition:i,variables:t})},66095:function(e,i,t){t.d(i,{EH:()=>d,FI:()=>j,Kx:()=>g,Pw:()=>A,TL:()=>f,ZN:()=>q,eM:()=>w,eR:()=>E,kC:()=>_,oE:()=>h,oR:()=>m,rg:()=>b,rq:()=>y,sf:()=>Z,vA:()=>l});t(26847),t(81738),t(6989),t(27530);var n=t(95632),s=t(54731),r=t(67050),o=t(10142),a=t(17433),c=t(64637);const d=["single","restart","queued","parallel"],l=(0,s.z)(["queued","parallel"]),u=(0,n.Ry)({alias:(0,n.jt)((0,n.Z_)()),continue_on_error:(0,n.jt)((0,n.O7)()),enabled:(0,n.jt)((0,n.O7)())}),g=(0,n.Ry)({entity_id:(0,n.jt)((0,n.G0)([(0,n.Z_)(),(0,n.IX)((0,n.Z_)())])),device_id:(0,n.jt)((0,n.G0)([(0,n.Z_)(),(0,n.IX)((0,n.Z_)())])),area_id:(0,n.jt)((0,n.G0)([(0,n.Z_)(),(0,n.IX)((0,n.Z_)())])),floor_id:(0,n.jt)((0,n.G0)([(0,n.Z_)(),(0,n.IX)((0,n.Z_)())])),label_id:(0,n.jt)((0,n.G0)([(0,n.Z_)(),(0,n.IX)((0,n.Z_)())]))}),f=(0,n.f0)(u,(0,n.Ry)({action:(0,n.jt)((0,n.Z_)()),service_template:(0,n.jt)((0,n.Z_)()),entity_id:(0,n.jt)((0,n.Z_)()),target:(0,n.jt)(g),data:(0,n.jt)((0,n.Ry)()),response_variable:(0,n.jt)((0,n.Z_)()),metadata:(0,n.jt)((0,n.Ry)())})),p=(0,n.f0)(u,(0,n.Ry)({action:(0,n.i0)("media_player.play_media"),target:(0,n.jt)((0,n.Ry)({entity_id:(0,n.jt)((0,n.Z_)())})),entity_id:(0,n.jt)((0,n.Z_)()),data:(0,n.Ry)({media_content_id:(0,n.Z_)(),media_content_type:(0,n.Z_)()}),metadata:(0,n.Ry)()})),_=(e,i,t)=>e.callService("script",i,t),y=e=>"off"===e.state||!!("on"===e.state&&l(e.attributes.mode)&&e.attributes.current<e.attributes.max),m=(e,i)=>e.callApi("DELETE",`config/script/config/${i}`);let v;const h=(e,i)=>e.callApi("GET",`config/script/config/${i}`),w=(e,i)=>e.callWS({type:"script/config",entity_id:i}),b=(e,i)=>{v=e;const t=i?`?${(0,c.ou)({expanded:"1"})}`:"";(0,r.c)(`/config/script/edit/new${t}`)},j=()=>{const e=v;return v=void 0,e},A=e=>"delay"in e?"delay":"wait_template"in e?"wait_template":["condition","and","or","not"].some((i=>i in e))?"check_condition":"event"in e?"fire_event":"device_id"in e?"device_action":"repeat"in e?"repeat":"choose"in e?"choose":"if"in e?"if":"wait_for_trigger"in e?"wait_for_trigger":"variables"in e?"variables":"stop"in e?"stop":"sequence"in e?"sequence":"parallel"in e?"parallel":"set_conversation_response"in e?"set_conversation_response":"action"in e||"service"in e?"metadata"in e&&(0,n.is)(e,p)?"play_media":"service":"unknown",Z=(e,i)=>{var t;const n=null===(t=e.services.script[(0,a.p)(i)])||void 0===t?void 0:t.fields;return void 0!==n&&Object.keys(n).length>0},E=e=>{if(!e)return e;if(Array.isArray(e))return e.map(E);if("service"in e&&("action"in e||(e.action=e.service),delete e.service),"scene"in e&&(e.action="scene.turn_on",e.target={entity_id:e.scene},delete e.scene),"sequence"in e)for(const t of e.sequence)E(t);const i=A(e);if("parallel"===i){E(e.parallel)}if("choose"===i){const i=e;if(Array.isArray(i.choose))for(const e of i.choose)E(e.sequence);else i.choose&&E(i.choose.sequence);i.default&&E(i.default)}if("repeat"===i){E(e.repeat.sequence)}if("if"===i){const i=e;E(i.then),i.else&&E(i.else)}if("wait_for_trigger"===i){const i=e;(0,o.W9)(i.wait_for_trigger)}return e},q=e=>{const i=e.sequence;return i&&!Array.isArray(i)&&(e.sequence=[i]),e.sequence&&(e.sequence=E(e.sequence)),e}},18019:function(e,i,t){t.r(i),t.d(i,{addExternalBarCodeListener:()=>d,attachExternalToApp:()=>c,handleExternalMessage:()=>l});t(26847),t(81738),t(22960),t(67886),t(65451),t(46015),t(38334),t(94880),t(75643),t(29761),t(27530);var n=t(39884),s=t(83054),r=t(67050),o=t(10142);const a=new Set,c=e=>{window.addEventListener("haptic",(i=>e.hass.auth.external.fireMessage({type:"haptic",payload:{hapticType:i.detail}}))),e.hass.auth.external.addCommandHandler((i=>l(e,i)))},d=e=>(a.add(e),()=>{a.delete(e)}),l=(e,i)=>{const t=e.hass.auth.external;if("restart"===i.command)e.hass.connection.reconnect(!0),t.fireMessage({id:i.id,type:"result",success:!0,result:null});else if("navigate"===i.command)(0,r.c)(i.payload.path,i.payload.options),t.fireMessage({id:i.id,type:"result",success:!0,result:null});else if("notifications/show"===i.command)(0,n.B)(e,"hass-show-notifications"),t.fireMessage({id:i.id,type:"result",success:!0,result:null});else if("sidebar/toggle"===i.command){var c;if(null!==(c=s.mainWindow.history.state)&&void 0!==c&&c.open)return t.fireMessage({id:i.id,type:"result",success:!1,error:{code:"not_allowed",message:"dialog open"}}),!0;(0,n.B)(e,"hass-toggle-menu"),t.fireMessage({id:i.id,type:"result",success:!0,result:null})}else if("sidebar/show"===i.command){var d;if(null!==(d=s.mainWindow.history.state)&&void 0!==d&&d.open)return t.fireMessage({id:i.id,type:"result",success:!1,error:{code:"not_allowed",message:"dialog open"}}),!0;(0,n.B)(e,"hass-toggle-menu",{open:!0}),t.fireMessage({id:i.id,type:"result",success:!0,result:null})}else if("automation/editor/show"===i.command){var l;(0,o.Ip)(null===(l=i.payload)||void 0===l?void 0:l.config),t.fireMessage({id:i.id,type:"result",success:!0,result:null})}else if("improv/discovered_device"===i.command)(0,n.B)(window,"improv-discovered-device",i.payload),t.fireMessage({id:i.id,type:"result",success:!0,result:null});else if("improv/device_setup_done"===i.command)(0,n.B)(window,"improv-device-setup-done"),t.fireMessage({id:i.id,type:"result",success:!0,result:null});else if("bar_code/scan_result"===i.command)a.forEach((e=>e(i))),t.fireMessage({id:i.id,type:"result",success:!0,result:null});else{if("bar_code/aborted"!==i.command)return!1;a.forEach((e=>e(i))),t.fireMessage({id:i.id,type:"result",success:!0,result:null})}return!0}}}]);
//# sourceMappingURL=90955.23486505e0e53c3b.js.map