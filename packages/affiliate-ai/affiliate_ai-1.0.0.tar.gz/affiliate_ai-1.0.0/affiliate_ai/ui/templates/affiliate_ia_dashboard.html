{% extends "base.html" %}
{% block content %}

{% if update_status %}
<div class="bloc">
    <h2>ğŸŸ¢ Statut de la derniÃ¨re mise Ã  jour</h2>
    <p>{% if "rollback" in update_status %}ğŸ”™ <strong>{{ update_status }}</strong>{% else %}{{ update_status }}{% endif %}</p>
</div>
{% endif %}

<h1>ğŸ”¥ PhoenixProject â€“ Tableau de bord IA</h1>

<ul>
    <li><a href="{{ url_for('docs.afficher_doc_reddit') }}">ğŸ“– Documentation Reddit</a></li>
    <li><a href="{{ url_for('preview_produit') }}">ğŸ”® Prochain produit Ã  publier</a></li>
    <li><a href="{{ url_for('afficher_stats') }}">ğŸ“Š Statistiques IA</a></li>
    <li><a href="{{ url_for('afficher_backups') }}">ğŸ’¾ Voir les sauvegardes</a></li>
    <li><a href="{{ url_for('formulaire_controle') }}">ğŸ§ª ContrÃ´le manuel IA</a></li>
</ul>

<div class="bloc">
    <h2>ğŸ’¸ Revenus estimÃ©s</h2>
    <p>Nombre de publications : {{ nb_posts }}</p>
    <p>Estimation actuelle : <strong>{{ revenu_estime }} â‚¬</strong></p>
</div>

<div class="bloc">
    <h2>ğŸ“† Planification IA</h2>
    <form action="/planifier" method="post">
        <label for="date">Choisir une date :</label>
        <input type="date" id="date" name="date" required>
        <button class="btn" type="submit">ğŸ•’ Planifier une publication</button>
    </form>
</div>

<div class="bloc">
    <h2>â›” ContrÃ´le IA</h2>
    <form method="post" action="{{ url_for('ia.toggle_ia') }}">
        <button type="submit" class="btn btn-danger">â¯ï¸ Pause / Reprise IA</button>
    </form>
</div>

<div class="bloc">
    <h2>ğŸ§ª ContrÃ´le manuel (CLI)</h2>
    <form method="post" action="/controle/cli">
        <label for="action">Action :</label><br>
        <select name="action" id="action" required>
            <option value="serve">Lancer le serveur Flask</option>
            <option value="run">Publication immÃ©diate</option>
            <option value="plan">Planifier une date (YYYY-MM-DD)</option>
        </select>
        <input type="text" name="date" placeholder="Ex: 2025-06-30 (pour planifier)">
        <br><br>
        <button type="submit" class="btn">ğŸš€ Lancer l'action</button>
    </form>
</div>

    .success { color: green; }
    <ul>
        {% for log in historique %}
            <li>[{{ log.timestamp }}] {{ log.action }} ({{ log.date }}) â€“ {{ log.statut }}</li>
        {% endfor %}
    </ul>
</div>


<div class="bloc">
    <h2>ğŸ”„ Mise Ã  jour systÃ¨me</h2>
    <form method="post" action="/update-project">
        <button type="submit" class="btn btn-warning">ğŸ” Lancer la mise Ã  jour</button>
    </form>
</div>

{% endblock %}
