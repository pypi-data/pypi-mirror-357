[tox]
envlist = {py38,py313,pypy3}{,-client,-server},py38-server610
isolated_build = true


[testenv]
commands =
    py.test --cov {envsitepackagesdir}/devpi_tokens {posargs}
deps =
    -r dev-requirements.txt
    server610: devpi-server<6.11
extras =
    !client: server
    !server: client


[pytest]
addopts =
    -r a
    --cov-report=term
    --cov-report=html
    -W once::DeprecationWarning
    -W ignore::DeprecationWarning:webob.acceptparse
    -W ignore::DeprecationWarning:docutils.io
    -W once::pytest.PytestDeprecationWarning
    -W once::ResourceWarning
    -W error:"The 'transaction' method":DeprecationWarning
testpaths = src/devpi_tokens
markers =
    nomocking: do not mock anything in fixtures
