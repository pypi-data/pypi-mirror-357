Metadata-Version: 2.1
Name: magicimg
Version: 1.0.7
Summary: ThÆ° viá»‡n xá»­ lÃ½ áº£nh thÃ´ng minh vá»›i há»— trá»£ GPU tá»± Ä‘á»™ng
Home-page: https://github.com/magicimg/magicimg
Author: MagicImg Team
Author-email: contact@magicimg.com
Classifier: Development Status :: 5 - Production/Stable
Classifier: Intended Audience :: Developers
Classifier: License :: OSI Approved :: MIT License
Classifier: Operating System :: OS Independent
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.7
Classifier: Programming Language :: Python :: 3.8
Classifier: Programming Language :: Python :: 3.9
Classifier: Topic :: Scientific/Engineering :: Image Processing
Classifier: Topic :: Software Development :: Libraries :: Python Modules
Requires-Python: >=3.7
Description-Content-Type: text/markdown
License-File: LICENSE
Requires-Dist: numpy>=1.19.0
Requires-Dist: opencv-python>=4.5.0
Requires-Dist: matplotlib>=3.3.0
Requires-Dist: pytesseract>=0.3.8
Requires-Dist: Pillow>=8.0.0
Requires-Dist: scikit-image>=0.18.0
Requires-Dist: tqdm>=4.62.0
Provides-Extra: dev
Requires-Dist: pytest>=6.2.0; extra == "dev"
Requires-Dist: pytest-cov>=2.12.0; extra == "dev"
Requires-Dist: black>=21.5b2; extra == "dev"
Requires-Dist: isort>=5.9.1; extra == "dev"
Requires-Dist: flake8>=3.9.2; extra == "dev"
Provides-Extra: gpu
Requires-Dist: torch>=1.9.0; extra == "gpu"
Requires-Dist: torchvision>=0.10.0; extra == "gpu"

# MagicImg - ThÆ° viá»‡n xá»­ lÃ½ áº£nh thÃ´ng minh

[![Version](https://img.shields.io/badge/version-1.0.6-blue.svg)](https://pypi.org/project/magicimg/)
[![Python](https://img.shields.io/badge/python-3.7%2B-blue.svg)](https://www.python.org/)
[![License](https://img.shields.io/badge/license-MIT-green.svg)](LICENSE)

MagicImg lÃ  thÆ° viá»‡n Python máº¡nh máº½ cho xá»­ lÃ½ vÃ  tiá»n xá»­ lÃ½ áº£nh, Ä‘Æ°á»£c tá»‘i Æ°u cho OCR vÃ  computer vision vá»›i há»— trá»£ GPU tá»± Ä‘á»™ng.

## ğŸš€ TÃ­nh nÄƒng má»›i trong v1.0.6

- âœ… **Sá»­a lá»—i API consistency**: Táº¥t cáº£ wrapper functions giá» Ä‘Ã¢y tráº£ vá» format nháº¥t quÃ¡n
- âœ… **Tá»‘i Æ°u type annotations**: Cáº£i thiá»‡n type hints cho táº¥t cáº£ functions
- âœ… **Enhanced error handling**: Xá»­ lÃ½ lá»—i tá»‘t hÆ¡n trong cÃ¡c API functions
- âœ… **Preserve color option**: TÃ¹y chá»n giá»¯ nguyÃªn mÃ u sáº¯c áº£nh gá»‘c
- âœ… **API stability**: KhÃ´ng cÃ²n lá»—i unpack ProcessingResult objects

## ğŸ“¦ CÃ i Ä‘áº·t

### CÃ i Ä‘áº·t cÆ¡ báº£n
```bash
pip install magicimg
```

### CÃ i Ä‘áº·t vá»›i GPU support
```bash
pip install magicimg[gpu]
# hoáº·c
pip install magicimg torch torchvision
```

### CÃ i Ä‘áº·t Tesseract OCR

#### Windows
```bash
# Sá»­ dá»¥ng winget
winget install UB-Mannheim.TesseractOCR

# ThÃªm vÃ o PATH
set PATH=%PATH%;C:\Program Files\Tesseract-OCR
```

#### Ubuntu/Debian
```bash
sudo apt-get update
sudo apt-get install tesseract-ocr tesseract-ocr-vie
```

#### macOS
```bash
brew install tesseract
```

## ğŸ¯ Sá»­ dá»¥ng nhanh

### Basic Usage
```python
import magicimg

# Xá»­ lÃ½ áº£nh cÆ¡ báº£n vá»›i preserve color
result = magicimg.process_image("input.jpg", "output.jpg", preserve_color=True)
print(f"Success: {result.success}")
print(f"Processing steps: {result.processing_steps}")

# Kiá»ƒm tra cháº¥t lÆ°á»£ng áº£nh
is_good, quality_info, enhanced = magicimg.check_image_quality("input.jpg")
print(f"Quality score: {quality_info['quality_score']}")

# TÄƒng cÆ°á»ng áº£nh
enhanced = magicimg.enhance_image("input.jpg", "enhanced.jpg")

# Preprocessing cho OCR (tá»‘i Æ°u cho text recognition)
result = magicimg.preprocess_for_ocr("input.jpg", "output.jpg", preserve_color=False)
```

### API Mode (cho Google, Anthropic, Local API)
```python
import magicimg

# Preprocessing cho Google Vision API
success, info, output_path = magicimg.preprocess_image_for_api(
    "input.jpg", 
    provider="google",
    output_dir="./output/",
    min_quality_score=0.3
)

print(f"Success: {success}")
print(f"Output: {output_path}")
print(f"Processing steps: {info['processing_steps']}")
```

## ğŸ“š API Reference

### Core Functions

#### `process_image(image_path, output_path=None, auto_rotate=True, preserve_color=True)`
Xá»­ lÃ½ áº£nh hoÃ n chá»‰nh vá»›i táº¥t cáº£ cÃ¡c bÆ°á»›c tá»‘i Æ°u.

**Parameters:**
- `image_path` (str | np.ndarray): ÄÆ°á»ng dáº«n áº£nh hoáº·c numpy array
- `output_path` (str, optional): ÄÆ°á»ng dáº«n lÆ°u káº¿t quáº£
- `auto_rotate` (bool): Tá»± Ä‘á»™ng xoay áº£nh (default: True)
- `preserve_color` (bool): Giá»¯ nguyÃªn mÃ u sáº¯c (default: True)

**Returns:**
- `ProcessingResult`: Object chá»©a káº¿t quáº£ xá»­ lÃ½

#### `check_image_quality(image_path)`
Kiá»ƒm tra cháº¥t lÆ°á»£ng áº£nh vÃ  Ä‘Ã¡nh giÃ¡ cÃ¡c metrics.

**Returns:**
- `tuple(bool, dict, np.ndarray)`: (is_good, quality_info_dict, enhanced_image)

#### `preprocess_image_for_api(image_path, provider="google")`
Tiá»n xá»­ lÃ½ áº£nh tá»‘i Æ°u cho cÃ¡c API nhÃ  cung cáº¥p.

**Parameters:**
- `provider`: "google", "anthropic", hoáº·c "local"

**Returns:**
- `tuple(bool, dict, str)`: (success, processing_info, output_path)

### Quality Enhancement Functions

#### `enhance_image(image_path, output_path=None)`
TÄƒng cÆ°á»ng cháº¥t lÆ°á»£ng áº£nh má»™t cÃ¡ch nháº¹ nhÃ ng.

#### `enhance_image_for_ocr(image_path, output_path=None)`
Tá»‘i Æ°u áº£nh Ä‘áº·c biá»‡t cho OCR (chuyá»ƒn binary).

### Orientation & Skew Functions

#### `detect_skew(image_path)`
PhÃ¡t hiá»‡n gÃ³c nghiÃªng cá»§a áº£nh.

#### `correct_skew(image_path, angle=None)`
Sá»­a gÃ³c nghiÃªng cá»§a áº£nh.

#### `rotate_image(image_path, angle)`
Xoay áº£nh theo gÃ³c cho trÆ°á»›c.

## âš™ï¸ Cáº¥u hÃ¬nh nÃ¢ng cao

### GPU Configuration
```python
from magicimg import ImageProcessor

# Cáº¥u hÃ¬nh GPU tÃ¹y chá»‰nh
config = {
    "use_gpu": True,
    "gpu_id": 0,
    "gpu_memory_limit": 0.7,
    "batch_size": 4,
    "optimize_for_gpu": True
}

processor = ImageProcessor(config=config)
result = processor.process_image("input.jpg")
```

### Quality Thresholds
```python
# Cáº¥u hÃ¬nh ngÆ°á»¡ng cháº¥t lÆ°á»£ng
config = {
    "min_blur_index": 100.0,      # TÄƒng yÃªu cáº§u Ä‘á»™ nÃ©t
    "min_brightness": 200.0,      # TÄƒng yÃªu cáº§u Ä‘á»™ sÃ¡ng
    "min_contrast": 60.0,         # TÄƒng yÃªu cáº§u Ä‘á»™ tÆ°Æ¡ng pháº£n
    "min_resolution": (1200, 1600) # TÄƒng Ä‘á»™ phÃ¢n giáº£i tá»‘i thiá»ƒu
}

processor = ImageProcessor(config=config)
```

### Processing Modes

#### High Quality Mode (cho áº£nh quan trá»ng)
```python
config = {
    "min_blur_index": 120.0,
    "min_brightness": 220.0,
    "min_contrast": 70.0,
    "min_resolution": (1500, 2000)
}
result = magicimg.process_image("input.jpg", config=config, preserve_color=True)
```

#### Fast Processing Mode (cho batch processing)
```python
config = {
    "min_blur_index": 60.0,
    "min_brightness": 160.0,
    "min_contrast": 40.0,
    "skip_rotation": True
}
result = magicimg.process_image("input.jpg", config=config)
```

#### OCR Optimization Mode
```python
result = magicimg.preprocess_for_ocr("input.jpg", preserve_color=False)
# preserve_color=False -> chuyá»ƒn binary cho OCR tá»‘i Æ°u
```

## ğŸ”§ Debugging & Troubleshooting

### Enable Debug Mode
```python
processor = ImageProcessor(debug_dir="./debug/")
result = processor.process_image("input.jpg")
# Debug images sáº½ Ä‘Æ°á»£c lÆ°u trong ./debug/
```

### Common Issues

#### 1. GPU khÃ´ng Ä‘Æ°á»£c phÃ¡t hiá»‡n
```bash
# Kiá»ƒm tra CUDA
python -c "import torch; print(torch.cuda.is_available())"

# Náº¿u False, cÃ i Ä‘áº·t PyTorch vá»›i CUDA
pip install torch torchvision --index-url https://download.pytorch.org/whl/cu118
```

#### 2. Tesseract error
```bash
# Windows: ThÃªm Tesseract vÃ o PATH
set PATH=%PATH%;C:\Program Files\Tesseract-OCR

# Linux: CÃ i Ä‘áº·t Tesseract
sudo apt-get install tesseract-ocr
```

#### 3. Memory errors vá»›i áº£nh lá»›n
```python
# Giáº£m batch_size
config = {"batch_size": 2, "gpu_memory_limit": 0.5}
processor = ImageProcessor(config=config)
```

### System Information
```python
import magicimg
magicimg.print_system_info()
# In thÃ´ng tin há»‡ thá»‘ng vÃ  dependencies
```

## ğŸ“Š Performance Tips

### 1. Batch Processing
```python
from magicimg import ImageProcessor

processor = ImageProcessor(config={"batch_size": 8})

# Xá»­ lÃ½ nhiá»u áº£nh cÃ¹ng lÃºc
image_paths = ["img1.jpg", "img2.jpg", "img3.jpg"]
for path in image_paths:
    result = processor.process_image(path)
    print(f"Processed {path}: {result.success}")
```

### 2. Memory Management
```python
# Sá»­ dá»¥ng context manager cho GPU
from magicimg.core import gpu_memory_manager

with gpu_memory_manager():
    result = magicimg.process_image("large_image.jpg")
```

### 3. Preserve Color vs OCR Mode
```python
# Cho áº£nh cáº§n giá»¯ cháº¥t lÆ°á»£ng cao
result = magicimg.process_image("photo.jpg", preserve_color=True)

# Cho text recognition
result = magicimg.preprocess_for_ocr("document.jpg", preserve_color=False)
```

## ğŸ§ª Testing

### Run API Consistency Tests
```bash
# Test táº¥t cáº£ API functions
python -c "
import magicimg
print('Testing basic APIs...')
result1 = magicimg.check_image_quality('input.jpg')
result2 = magicimg.process_image('input.jpg')
result3 = magicimg.preprocess_image_for_api('input.jpg')
print('All APIs working correctly!')
"
```

### Performance Benchmark
```python
import time
import magicimg

start = time.time()
result = magicimg.process_image("test.jpg")
end = time.time()

print(f"Processing time: {end-start:.2f}s")
print(f"Success: {result.success}")
```

## ğŸ“ Examples

### Complete Processing Pipeline
```python
import magicimg

def process_document(input_path, output_dir="./output/"):
    """Xá»­ lÃ½ document hoÃ n chá»‰nh"""
    
    # 1. Kiá»ƒm tra cháº¥t lÆ°á»£ng
    is_good, quality_info, enhanced = magicimg.check_image_quality(input_path)
    print(f"Quality score: {quality_info['quality_score']:.2f}")
    
    # 2. Xá»­ lÃ½ vá»›i preserve color
    result = magicimg.process_image(
        input_path, 
        output_path=f"{output_dir}/processed.jpg",
        preserve_color=True
    )
    
    # 3. Táº¡o version cho OCR
    ocr_result = magicimg.preprocess_for_ocr(
        input_path,
        output_path=f"{output_dir}/ocr_ready.jpg", 
        preserve_color=False
    )
    
    # 4. API processing
    api_success, api_info, api_path = magicimg.preprocess_image_for_api(
        input_path,
        provider="google",
        output_dir=output_dir
    )
    
    return {
        "quality": quality_info,
        "processed": result.success,
        "ocr_ready": ocr_result.success,
        "api_ready": api_success,
        "steps": result.processing_steps
    }

# Sá»­ dá»¥ng
results = process_document("document.jpg")
print(results)
```

## ğŸ†• Changelog v1.0.6

### Fixed
- âœ… Sá»­a lá»—i API consistency trong wrapper functions
- âœ… Sá»­a lá»—i unpack ProcessingResult objects  
- âœ… Cáº£i thiá»‡n type annotations cho táº¥t cáº£ functions
- âœ… Sá»­a lá»—i return type mismatch giá»¯a core vÃ  wrapper functions

### Improved
- ğŸš€ Tá»‘i Æ°u memory management cho GPU processing
- ğŸš€ Cáº£i thiá»‡n error handling trong táº¥t cáº£ API functions
- ğŸš€ ThÃªm preserve_color option cho flexibility
- ğŸš€ Enhanced debugging capabilities

### Added
- â• API consistency test suite
- â• Comprehensive error reporting
- â• Better documentation vá»›i examples

## ğŸ¤ Contributing

1. Fork repository
2. Táº¡o feature branch (`git checkout -b feature/AmazingFeature`)
3. Commit changes (`git commit -m 'Add some AmazingFeature'`)
4. Push to branch (`git push origin feature/AmazingFeature`)
5. Táº¡o Pull Request

## ğŸ“„ License

Distributed under the MIT License. See `LICENSE` for more information.

## ğŸ™‹â€â™‚ï¸ Support

- ğŸ“§ Email: shumi2011@gmail.com
- ğŸ› Issues: [GitHub Issues](https://github.com/magicimg/magicimg/issues)
- ğŸ“– Documentation: [Full Docs](https://magicimg.readthedocs.io/)

---

**Made with â¤ï¸ by MagicImg Team** 
